function getSessionCookies(e,t){var o=0;chrome.cookies.getAll({domain:e},function(e){_.each(e,function(e){e.session&&o++}),t("session : "+o+"; total : "+e.length)})}function importLogoMetadata(e,t){try{var o;o=t?e:local_decrypt(e);var n=JSON.parse(o);return PB.startpage.logoExceptions=_.map(n.exceptions,function(e){return{url:e[0],logo:e[1],title:e[2]}}),PB.startpage.logos=_.map(n.logos,function(e){return{url:e[0],title:e[1]}}),PB.startpage.accounts=n.accounts||[],!0}catch(a){return console.error(a.message,a.stack),PB.startpage.logos||(PB.startpage.logos=[]),!1}}function loadLogoMetadata(e,t){var o="ie"===PB.Browser.id;e||!Storage.getItem("meta")?(console.log("Requesting meta from server"),PB.Browser.getUrl(META_PATH+"meta.txt",function(e){if(null==e&&(e=""),o)try{e=local_decrypt(e);var n=importLogoMetadata(e,!0)}catch(a){var n=!1}else var n=importLogoMetadata(e);n&&Storage.setItem("meta",e),t()})):(importLogoMetadata(Storage.getItem("meta"),o),t())}function loadLogos(e){e()}function getVersion(e){PB.Browser.getUrl(META_PATH+"version.json",function(t){if(null==t)return e(null);try{var o=JSON.parse(t)}catch(n){return console.error(n),e(null)}e(o)})}function logoVersionCheck(){if(console.log("v",PB.startpage.getGlobalSetting("logo_version")),_.isUndefined(PB.startpage.getGlobalSetting("logo_version"))){console.log("[check] No cached meta");var e=!0}return PB.startpage.getGlobalSetting("logo_check_time")&&(new Date).getTime()-PB.startpage.getGlobalSetting("logo_check_time")<LOGO_CHECK_TIME?void console.log("[check] cache timestamp still valid"):(console.log("[check] cache timestamp expired"),void getVersion(function(t){if(null==t)return void console.log("[check] failed to get version.");var o=t.meta;e?PB.startpage.setGlobalSettings({logo_version:o,logo_check_time:(new Date).getTime()}):PB.startpage.getGlobalSetting("logo_version")===o?(PB.startpage.setGlobalSettings({logo_check_time:(new Date).getTime()}),console.log("[check] version: no new version available.")):(console.log("[check] version: new version available."),loadLogoMetadata(!0,function(){PB.startpage.setGlobalSettings({logo_version:o,logo_check_time:(new Date).getTime()})}))}))}function createFavorite(e,t){var o={title:t,url:e};return o}function is_accounts_disabled(){return!1}function is_account_site(e){return e=e.toLowerCase().replace(/\/$/,"").replace("http://","").replace("https://",""),_.find(PB.startpage.accounts,function(t){return-1!==t[1].indexOf(e)})}function filter_account_sites(e){return _.filter(e,function(e){return url=e.url.toLowerCase(),is_account_site(url)})}function paginate(e){var t=8,o=8;applyIndexes(e);for(var n=[],a=0;t>a&&e[a*o];a++){n.push(e.slice(a*o,(a+1)*o))}return n}function generateFavorites(){var e=PB.Browser.runTop7();PB.startpage.addFavoriteUrls(e);for(var t=PB.Browser.get_user_data().favorites,o=7,n=PB.Browser.top7.fallbacks,a=0;a<n.length&&t.length<o;a++){var r=n[a];PB.startpage.addFavorite(r)}PB.logos.checkAllLogos(PB.Browser.get_user_data().favorites)}function add_new_search_suggestions(e){for(var t,o=new RegExp(e,"gi"),n=PB.Meta.data,a=10,r=[],i=0;i<n.length&&r.length<=a;i++){var s=n[i];null!=s&&(o.test(s.title)||o.test(s.url))&&r.push(s)}return _.each(r,function(e){e.search_logo||(t=e.url.toLowerCase(),e.search_logo=t)}),r=_.uniq(r,!1,function(e){return e.search_logo})}function getRandomSites(e){return randomSites||(randomSites=_.sortBy(PB.startpage.logos,function(e){return $.sha1(e.url)})),randomSites.slice(0,e)}function add_new_initial_suggestions(e){var t=PB.logos.separateSitesWithLogos(PB.Browser.get_user_data().mostVisited).withLogo,o=["facebook.com"],n=PB.Browser.top7;PB.Browser.pickAndAddAllCandidates(o,n.fallbacks,PB.Browser.get_user_data().bookmarks),PB.Browser.pickAndAddCandidate(o,n.mail,t),PB.Browser.pickAndAddCandidate(o,["twitter.com","tweetdeck.com"],t),PB.Browser.pickAndAddCandidate(o,["youtube.com","netflix.com","hulu.com"],t),PB.Browser.pickAndAddCandidate(o,n.weather,t),PB.Browser.pickAndAddCandidate(o,["amazon.com","ebay.com"],t),PB.Browser.pickAndAddCandidate(o,n.banking,t),PB.Browser.pickAndAddCandidate(o,n.news,t),PB.Browser.pickAndAddCandidate(o,n.maps,t),o=o.concat(_.pluck(t,"url")),o=_.uniq(o),PB.Browser.addFallbacks(o,n.fallbacks,20),e&&PB.Browser.addFallbacks(o,PB.Browser.suggestions_more,100);var a,r=_.map(o,function(e){var t=PB.logos.check_exception_logo(e);return a=t?t:e,{url:e,logo:a}});return PB.Browser.applyIsFavorite(r),r=_.reject(r,function(e){return e.isFavorite}),e?r:_.first(r,11)}function preload_logo(e,t){var o=new Image;o.onerror=function(){t&&t(!1)},o.onload=function(){t&&t(!0)},o.src=logo_url(e)}function site_match(e,t){return t.test(e.url)||t.test(e.title)}function prioritize_whole_words(e,t){var o=new RegExp("^"+t,"i"),n=new RegExp("\\b"+t+"\\b","gi"),a=new RegExp("\\b"+t,"gi"),r=[],i=[],s=[],c=[];_.each(e,function(e){site_match(e,o)?r.push(e):site_match(e,a)?i.push(e):site_match(e,n)?s.push(e):c.push(e)});var l=r.concat(i,s,c);return l}function reorderByLogo(e){var t=PB.logos.separateSitesWithLogos(e);return t.withLogo.concat(t.withoutLogo)}function sync_event(){var e=PB.Browser.get_user_login();return PB.Browser.in_iframe()?void Storage.setItem("modified_in_iframe","true"):void(e&&sync_push_user_data())}function sync_pull_user_data(e){var t=PB.Browser.get_user_login();return t?Storage.getItem("modified_in_iframe")?void Storage.setItem("modified_in_iframe",""):void PB.startpage.pullStartpageBlob(function(t,o){if(!t)return e&&e(void 0),console.error("pullStartpageBlob failed");var n={};o&&(n=JSON.parse(o)),e&&e(n)}):(e&&e(),console.error("Trying to sync logged-out user"))}function sync_push_user_data(e){var t=PB.Browser.get_user_login();if(!t)return console.error("Trying to sync logged-out user");var o=PB.Browser.get_user_data(),n={favorites:_.map(o.favorites,function(e){return _pick(e,["url","title"])}),settings:o.settings},a=JSON.stringify(n);PB.startpage.pushStartpageBlob(a,function(t){console.log("pushStartpageBlob successful"),t||console.error("pushStartpageBlob failed"),e&&e()})}function _pick(e,t){var o={};return _.each(t,function(t){_.isUndefined(e[t])||(o[t]=e[t])}),o}function get_unique_assets(){return _.map(_.uniq(PB.Browser.get_bg_data().assets,!1,function(e){return e.domain}),function(e){return{title:e.name,url:e.url,domain:e.domain,id:e.id}})}function get_assets(){return PB.startpage.is_logged_in()?_.groupBy(PB.Browser.get_bg_data().assets,"domain"):{}}function top_assets(){var e=get_assets(),t=_.map(e,function(e,t){return{domain:t,count:e.length}});return console.log(t),_.sortBy(t,function(e){return-e.count})}function asset_exists(e){return get_assets()[e]}function get_assets_for_domain(e){"gmail.com"===e&&(e="google.com");var t=_.filter(get_assets()[e],function(e){return null==e.settings?!0:"1"!=e.settings.password_reprompt});return 0==t.length&&(t=null),t}function apply_asset_logins(e){return _.each(e,function(e){if(-1==e.url.indexOf("javascript:")){var t=PB.utils.removeSubdomain(PB.utils.getUrlHostname(e.url)),o=get_assets_for_domain(t);if(PB.utils.matchGoogleSkip(e.url))return;o&&(googleLoginOverride=matchGoogleServiceDomain(e.url),googleLoginOverride?e.loginUrl=googleLoginOverride:e.loginUrl=o[0].url,e.logins=_.map(o,function(e){return _pick(e,["login","id"])}))}}),e}function aes_decrypt(e){var t=Aes.Ctr.decrypt(e,K,128);return t}function local_decrypt(e){var t=Tea.decrypt(e,K);return t}function millisecondsToTimestamp(e){return Math.floor(e/1e3)}function getDateString(e){return e.getFullYear()+"-"+e.getMonth()+"-"+e.getDate()}function escapeRegExp(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function make_t(){return function(e){setTimeout(e,Math.floor(2e3*Math.random()))}}function wait_for_background_page(e){function t(){var o=chrome.extension.getBackgroundPage();o&&o.FA?(AB=get_bg().getAB(),null!=AB?(AB=JSON.parse(AB),e()):setTimeout(t,25)):setTimeout(t,25)}return PB.Browser.in_iframe()?e():void t()}function getUrl(e,t){$.ajax({url:e,dataType:"text",cache:!0,success:function(e){t(!0,e)},error:function(){t(!1)}})}"undefined"==typeof PB&&(PB={}),PB.ui={_common:{}},"undefined"==typeof PB&&(PB={}),PB.Config={LANGUAGE:"en_US",IS_WINDOWS:-1!=navigator.appVersion.indexOf("Win"),IS_MAC:-1!=navigator.appVersion.indexOf("Mac"),IS_UNIX:-1!=navigator.appVersion.indexOf("X11"),IS_LINUX:-1!=navigator.appVersion.indexOf("Linux"),IMPORT_MAX_PER_DOMAIN:2,IMPORT_MINIMUM_THRESHOLD:3,PREMIUM_PRICE:"$1",FREEMIUM_POPUP_1CLICK_FREQUENCY:10,FREEMIUM_HOME_OPEN_PERCENT:[.7,.9,1],FREEMIUM_HOME_OPEN_FREQUENCY:10,PAGE_LOAD_COUNT_BEFORE_NOTIFICATION:40,INTERVAL_ACTIVE_REFRESH:5,INTERVAL_COLLECTION_REFRESH:60,INTERVAL_POLL_FORM_CHANGE:.3,INTERVAL_POLL_FORM_SEARCH:1,INTERVAL_API_REFRESH:86400,INTERVAL_AUTOLOGOUT_PING:15,INTERVAL_PING_ATTEMPT:86400,EXPIRATION_AUTO_LOGIN_QUEUE:30,SESSION_EXPIRY:3e5,CHROME_CANARY:"epnpbkpfpmpbheinimppjadpcbkechhk",ATLAS_ENV:"PRODUCTION",ATLAS_API:{DEVELOPMENT:"http://localhost:8080/api",STAGING:"https://m-ni.tkassets.com/api",PRODUCTION:"https://m.tkassets.com/api"},LD_URL:"https://mlm.psswrdbx.com",URL_API:"https://api0.passwordbox.com/api/0",URL_LOCAL_HTTP_SERVER:"http://127.0.0.1:30761/",URL_WEB_APP_ROOT:"https://www.passwordbox.com/web",URL_GO_PREMIUM:"https://www.passwordbox.com/premium",URL_REFER:"https://www.passwordbox.com/referral",URL_WELCOME:"https://www.passwordbox.com/welcome",URL_TERMS:"https://www.passwordbox.com/terms",URL_HELPDESK:"https://help.passwordbox.com/",URL_CLOSE_ACCOUNT:"https://passwordbox.com/account/delete/new",URL_WELCOME_VIDEO:"https://www.passwordbox.com/videos/tour?standalone=1&new=1",URL_REWARDS_PAGE:"https://www.passwordbox.com/rewards",URLS_BLOG:{wallet:"https://blog.passwordbox.com/2013/11/06/get-organized-passwordbox-wallet/",checkout:"https://help.passwordbox.com/customer/portal/articles/1421543-what-is-1-tap-checkout-"},URL_RATE_CHROME_PART1:"https://chrome.google.com/webstore/detail/passwordbox-free-password/",URL_RATE_CHROME_PART2:"/reviews",HOSTS_API_DEFAULT:["api0.passwordbox.com","www.passwordbox.com","api1.passwordbox.com"],LOCAL_HTTP_SERVER_TIMEOUT:30,LOCAL_HTTP_SERVER_MAX_RETRY_COUNT:3,DURATION_TOPBAR_DEFAULT:15,DURATION_TAB_DEFAULT:3,DURATION_TAB_LOGIN:10,DURATION_TAB_SIGN_UP:10,DURATION_TAB_AUTO_SAVE:7,DURATION_TAB_AUTO_SAVE_EXAMPLE:7,MAX_FORM_INPUT_COUNT:4,PREFIX_LOCAL_USERDATA:"data_",DERIVATION_FIRST_ITERATION_COUNT:500,DERIVATION_SECOND_ITERATION_COUNT:9498,MP_DERIVATION_COUNT:1e4,REGISTER_RULES:{client_iterations:500,iterations:9498,algo:"sha256"},LANGUAGES:[{locale:"en_US",name:"English"},{locale:"es_ES",name:"Espa&ntilde;ol"},{locale:"fr_FR",name:"Fran&ccedil;ais"},{locale:"el_GR",name:"&#955;&#955;&#951;&#957;&#949;&#962;"},{locale:"it_IT",name:"Italiano"},{locale:"de_DE",name:"Deutsch"},{locale:"zh_CN",name:"&#20013;&#25991;(&#31616;&#20307;)"},{locale:"zh_TW",name:"&#20013;&#25991;(&#32321;&#39636;)"},{locale:"da_DK",name:"Dansk"},{locale:"fi_FI",name:"Suomi"},{locale:"ja_JP",name:"&#26085;&#26412;&#35486;"},{locale:"ko_KR",name:"&#54620;&#44397;&#50612;"},{locale:"nb_NO",name:"Norsk"},{locale:"id_ID",name:"Bahasa Indonesia"},{locale:"pt_BR",name:"Portugu&ecirc;s (Brasil)"},{locale:"pt_PT",name:"Portugu&ecirc;s (Portugal)"},{locale:"ru_RU",name:"P&#1091;&#1089;&#1089;&#1082;&#1080;&#1081;"},{locale:"sv_SE",name:"Svenska"},{locale:"tr_TR",name:"T&#252;rk&ccedil;e"},{locale:"hr_HR",name:"Hrvatska"},{locale:"nl_NL",name:"Nederlands"},{locale:"ro_RO",name:"Rom&acirc;n&#259;"},{locale:"sk_SK",name:"Slovenski jezik"}],WALLET_KINDS:[{value:"all",name:"wallet.allMyWallet"},{value:"cc",name:"wallet.creditCards",itemClass:"PBCreditCardItem",trackingName:"credit_card"},{value:"drivers",name:"wallet.driversLicenses",itemClass:"PBDriversLicenseItem",trackingName:"drivers_license"},{value:"identity",name:"wallet.identities",itemClass:"PBIdentityItem",trackingName:"address_book"},{value:"membership",name:"wallet.memberships",itemClass:"PBMembershipItem",trackingName:"membership"},{value:"passport",name:"wallet.passports",itemClass:"PBPassportItem",trackingName:"passport"},{value:"ssn",name:"wallet.ssns",itemClass:"PBSocialSecurityNumberItem",trackingName:"social_security_number"}],GENDERS:[{value:0,name:"wallet.male"},{value:1,name:"wallet.female"}],CREDITCARD_TYPES:[{value:0,name:"VISA"},{value:1,name:"Mastercard"},{value:2,name:"American Express"},{value:3,name:"Other"}],COUNTRIES:[{name:"Afghanistan",alternativeSpellings:"AF افغانستان",code:"93"},{name:"Åland Islands",alternativeSpellings:"AX Aaland Aland",relevancyBooster:"0.5",code:"358"},{name:"Albania",alternativeSpellings:"AL",code:"355"},{name:"Algeria",alternativeSpellings:"DZ الجزائر",code:"213"},{name:"American Samoa",alternativeSpellings:"AS",relevancyBooster:"0.5",code:"1684"},{name:"Andorra",alternativeSpellings:"AD",relevancyBooster:"0.5",code:"376"},{name:"Angola",alternativeSpellings:"AO",code:"244"},{name:"Anguilla",alternativeSpellings:"AI",relevancyBooster:"0.5",code:"1264"},{name:"Antarctica",alternativeSpellings:"AQ",relevancyBooster:"0.5"},{name:"Antigua And Barbuda",alternativeSpellings:"AG",relevancyBooster:"0.5"},{name:"Argentina",alternativeSpellings:"AR",code:"54"},{name:"Armenia",alternativeSpellings:"AM Հայաստան",code:"374"},{name:"Aruba",alternativeSpellings:"AW",relevancyBooster:"0.5",code:"297"},{name:"Australia",alternativeSpellings:"AU",relevancyBooster:"1.5",code:"61"},{name:"Austria",alternativeSpellings:"AT Österreich Osterreich Oesterreich ",code:"43"},{name:"Azerbaijan",alternativeSpellings:"AZ",code:"994"},{name:"Bahamas",alternativeSpellings:"BS",code:"1242"},{name:"Bahrain",alternativeSpellings:"BH البحرين",code:"973"},{name:"Bangladesh",alternativeSpellings:"BD বাংলাদেশ",relevancyBooster:"2",code:"880"},{name:"Barbados",alternativeSpellings:"BB",code:"1246"},{name:"Belgium",alternativeSpellings:"BE België Belgie Belgien Belgique",relevancyBooster:"1.5",code:"32"},{name:"Belize",alternativeSpellings:"BZ",code:"501"},{name:"Benin",alternativeSpellings:"BJ",code:"229"},{name:"Bermuda",alternativeSpellings:"BM",relevancyBooster:"0.5",code:"1441"},{name:"Bhutan",alternativeSpellings:"BT भूटान",code:"975"},{name:"Bolivia",alternativeSpellings:"BO",code:"591"},{name:"Bonaire, Sint Eustatius and Saba",alternativeSpellings:"BQ"},{name:"Bosnia and Herzegovina",alternativeSpellings:"BA Босна и Херцеговина",code:"387"},{name:"Botswana",alternativeSpellings:"BW",code:"267"},{name:"Bouvet Island",alternativeSpellings:"BV"},{name:"Brazil",alternativeSpellings:"BR Brasil",relevancyBooster:"2",code:"55"},{name:"British Indian Ocean Territory",alternativeSpellings:"IO",code:"246"},{name:"Brunei Darussalam",alternativeSpellings:"BN",code:"673"},{name:"Bulgaria",alternativeSpellings:"BG България",code:"359"},{name:"Burkina Faso",alternativeSpellings:"BF",code:"226"},{name:"Burundi",alternativeSpellings:"BI",code:"257"},{name:"Cambodia",alternativeSpellings:"KH កម្ពុជា",code:"855"},{name:"Cameroon",alternativeSpellings:"CM",code:"237"},{name:"Canada",alternativeSpellings:"CA",relevancyBooster:"2",code:"1"},{name:"Cape Verde",alternativeSpellings:"CV Cabo",code:"238"},{name:"Cayman Islands",alternativeSpellings:"KY",relevancyBooster:"0.5",code:"1345"},{name:"Central African Republic",alternativeSpellings:"CF",code:"236"},{name:"Chad",alternativeSpellings:"TD تشاد‎ Tchad",code:"235"},{name:"Chile",alternativeSpellings:"CL",code:"56"},{name:"China",relevancyBooster:"3.5",alternativeSpellings:"CN Zhongguo Zhonghua Peoples Republic 中国/中华",code:"86"},{name:"Christmas Island",alternativeSpellings:"CX",relevancyBooster:"0.5",code:"61"},{name:"Cocos (Keeling) Islands",alternativeSpellings:"CC",relevancyBooster:"0.5",code:"61"},{name:"Colombia",alternativeSpellings:"CO",code:"57"},{name:"Comoros",alternativeSpellings:"KM جزر القمر",code:"269"},{name:"Congo",alternativeSpellings:"CG"},{name:"Congo, the Democratic Republic of the",alternativeSpellings:"CD Congo-Brazzaville Repubilika ya Kongo"},{name:"Cook Islands",alternativeSpellings:"CK",relevancyBooster:"0.5",code:"682"},{name:"Costa Rica",alternativeSpellings:"CR",code:"506"},{name:"Côte d'Ivoire",alternativeSpellings:"CI Cote dIvoire",code:"225"},{name:"Croatia",alternativeSpellings:"HR Hrvatska",code:"385"},{name:"Curaçao",alternativeSpellings:"CW Curacao",code:"5999"},{name:"Cyprus",alternativeSpellings:"CY Κύπρος Kýpros Kıbrıs",code:"357"},{name:"Czech Republic",alternativeSpellings:"CZ Česká Ceska",code:"420"},{name:"Denmark",alternativeSpellings:"DK Danmark",relevancyBooster:"1.5",code:"45"},{name:"Djibouti",alternativeSpellings:"DJ جيبوتي‎ Jabuuti Gabuuti",code:"253"},{name:"Dominica",alternativeSpellings:"DM Dominique",relevancyBooster:"0.5",code:"1767"},{name:"Dominican Republic",alternativeSpellings:"DO",code:"1809,1829,1849"},{name:"Ecuador",alternativeSpellings:"EC",code:"593"},{name:"Egypt",alternativeSpellings:"EG",relevancyBooster:"1.5",code:"20"},{name:"El Salvador",alternativeSpellings:"SV",code:"503"},{name:"Equatorial Guinea",alternativeSpellings:"GQ",code:"240"},{name:"Eritrea",alternativeSpellings:"ER إرتريا ኤርትራ",code:"291"},{name:"Estonia",alternativeSpellings:"EE Eesti",code:"372"},{name:"Ethiopia",alternativeSpellings:"ET ኢትዮጵያ",code:"251"},{name:"Falkland Islands (Malvinas)",alternativeSpellings:"FK",relevancyBooster:"0.5",code:"500"},{name:"Faroe Islands",alternativeSpellings:"FO Føroyar Færøerne",relevancyBooster:"0.5",code:"298"},{name:"Fiji",alternativeSpellings:"FJ Viti फ़िजी",code:"679"},{name:"Finland",alternativeSpellings:"FI Suomi",code:"358"},{name:"France",alternativeSpellings:"FR République française",relevancyBooster:"2.5",code:"33"},{name:"French Guiana",alternativeSpellings:"GF",code:"594"},{name:"French Polynesia",alternativeSpellings:"PF Polynésie française",code:"689"},{name:"French Southern Territories",alternativeSpellings:"TF"},{name:"Gabon",alternativeSpellings:"GA République Gabonaise",code:"241"},{name:"Gambia",alternativeSpellings:"GM",code:"220"},{name:"Georgia",alternativeSpellings:"GE საქართველო",code:"995"},{name:"Germany",alternativeSpellings:"DE Bundesrepublik Deutschland",relevancyBooster:"3",code:"49"},{name:"Ghana",alternativeSpellings:"GH",code:"233"},{name:"Gibraltar",alternativeSpellings:"GI",relevancyBooster:"0.5",code:"350"},{name:"Greece",alternativeSpellings:"GR Ελλάδα",relevancyBooster:"1.5",code:"30"},{name:"Greenland",alternativeSpellings:"GL grønland",relevancyBooster:"0.5",code:"299"},{name:"Grenada",alternativeSpellings:"GD",code:"1473"},{name:"Guadeloupe",alternativeSpellings:"GP",code:"590"},{name:"Guam",alternativeSpellings:"GU",code:"1671"},{name:"Guatemala",alternativeSpellings:"GT",code:"502"},{name:"Guernsey",alternativeSpellings:"GG",relevancyBooster:"0.5",code:"44"},{name:"Guinea",alternativeSpellings:"GN",code:"224"},{name:"Guinea-Bissau",alternativeSpellings:"GW",code:"245"},{name:"Guyana",alternativeSpellings:"GY",code:"592"},{name:"Haiti",alternativeSpellings:"HT",code:"509"},{name:"Heard Island and McDonald Islands",alternativeSpellings:"HM"},{name:"Holy See (Vatican City State)",alternativeSpellings:"VA",relevancyBooster:"0.5"},{name:"Honduras",alternativeSpellings:"HN",code:"504"},{name:"Hong Kong",alternativeSpellings:"HK 香港",code:"852"},{name:"Hungary",alternativeSpellings:"HU Magyarország",code:"36"},{name:"Iceland",alternativeSpellings:"IS Island",code:"354"},{name:"India",alternativeSpellings:"IN भारत गणराज्य Hindustan",relevancyBooster:"3",code:"91"},{name:"Indonesia",alternativeSpellings:"ID",relevancyBooster:"2",code:"62"},{name:"Iraq",alternativeSpellings:"IQ العراق‎",code:"964"},{name:"Ireland",alternativeSpellings:"IE Éire",relevancyBooster:"1.2",code:"353"},{name:"Isle of Man",alternativeSpellings:"IM",relevancyBooster:"0.5",code:"44"},{name:"Israel",alternativeSpellings:"IL إسرائيل ישראל",code:"972"},{name:"Italy",alternativeSpellings:"IT Italia",relevancyBooster:"2",code:"39"},{name:"Jamaica",alternativeSpellings:"JM",code:"1876"},{name:"Japan",alternativeSpellings:"JP Nippon Nihon 日本",relevancyBooster:"2.5",code:"81"},{name:"Jersey",alternativeSpellings:"JE",relevancyBooster:"0.5",code:"44"},{name:"Jordan",alternativeSpellings:"JO الأردن",code:"962"},{name:"Kazakhstan",alternativeSpellings:"KZ Қазақстан Казахстан",code:"76,77"},{name:"Kenya",alternativeSpellings:"KE",code:"254"},{name:"Kiribati",alternativeSpellings:"KI",code:"686"},{name:"Korea, Republic of",alternativeSpellings:"KR South Korea",relevancyBooster:"1.5"},{name:"Kuwait",alternativeSpellings:"KW الكويت",code:"965"},{name:"Kyrgyzstan",alternativeSpellings:"KG Кыргызстан",code:"996"},{name:"Lao People's Democratic Republic",alternativeSpellings:"LA"},{name:"Latvia",alternativeSpellings:"LV Latvija",code:"371"},{name:"Lebanon",alternativeSpellings:"LB لبنان",code:"961"},{name:"Lesotho",alternativeSpellings:"LS",code:"266"},{name:"Liberia",alternativeSpellings:"LR",code:"231"},{name:"Libyan Arab Jamahiriya",alternativeSpellings:"LY ليبيا"},{name:"Liechtenstein",alternativeSpellings:"LI",code:"423"},{name:"Lithuania",alternativeSpellings:"LT Lietuva",code:"370"},{name:"Luxembourg",alternativeSpellings:"LU",code:"352"},{name:"Macao",alternativeSpellings:"MO",code:"853"},{name:"Macedonia, The Former Yugoslav Republic Of",alternativeSpellings:"MK Македонија"},{name:"Madagascar",alternativeSpellings:"MG Madagasikara",code:"261"},{name:"Malawi",alternativeSpellings:"MW",code:"265"},{name:"Malaysia",alternativeSpellings:"MY",code:"60"},{name:"Maldives",alternativeSpellings:"MV",code:"960"},{name:"Mali",alternativeSpellings:"ML",code:"223"},{name:"Malta",alternativeSpellings:"MT",code:"356"},{name:"Marshall Islands",alternativeSpellings:"MH",relevancyBooster:"0.5",code:"692"},{name:"Martinique",alternativeSpellings:"MQ",code:"596"},{name:"Mauritania",alternativeSpellings:"MR الموريتانية",code:"222"},{name:"Mauritius",alternativeSpellings:"MU",code:"230"},{name:"Mayotte",alternativeSpellings:"YT",code:"262"},{name:"Mexico",alternativeSpellings:"MX Mexicanos",relevancyBooster:"1.5",code:"52"},{name:"Micronesia, Federated States of",alternativeSpellings:"FM"},{name:"Moldova, Republic of",alternativeSpellings:"MD"},{name:"Monaco",alternativeSpellings:"MC",code:"377"},{name:"Mongolia",alternativeSpellings:"MN Mongγol ulus Монгол улс",code:"976"},{name:"Montenegro",alternativeSpellings:"ME",code:"382"},{name:"Montserrat",alternativeSpellings:"MS",relevancyBooster:"0.5",code:"1664"},{name:"Morocco",alternativeSpellings:"MA المغرب",code:"212"},{name:"Mozambique",alternativeSpellings:"MZ Moçambique",code:"258"},{name:"Myanmar",alternativeSpellings:"MM"},{name:"Namibia",alternativeSpellings:"NA Namibië",code:"264"},{name:"Nauru",alternativeSpellings:"NR Naoero",relevancyBooster:"0.5",code:"674"},{name:"Nepal",alternativeSpellings:"NP नेपाल",code:"977"},{name:"Netherlands",alternativeSpellings:"NL Holland Nederland",relevancyBooster:"1.5",code:"31"},{name:"New Caledonia",alternativeSpellings:"NC",relevancyBooster:"0.5",code:"687"},{name:"New Zealand",alternativeSpellings:"NZ Aotearoa",code:"64"},{name:"Nicaragua",alternativeSpellings:"NI",code:"505"},{name:"Niger",alternativeSpellings:"NE Nijar",code:"227"},{name:"Nigeria",alternativeSpellings:"NG Nijeriya Naíjíríà",relevancyBooster:"1.5",code:"234"},{name:"Niue",alternativeSpellings:"NU",relevancyBooster:"0.5",code:"683"},{name:"Norfolk Island",alternativeSpellings:"NF",relevancyBooster:"0.5",code:"672"},{name:"Northern Mariana Islands",alternativeSpellings:"MP",relevancyBooster:"0.5",code:"1670"},{name:"Norway",alternativeSpellings:"NO Norge Noreg",relevancyBooster:"1.5",code:"47"},{name:"Oman",alternativeSpellings:"OM عمان",code:"968"},{name:"Pakistan",alternativeSpellings:"PK پاکستان",relevancyBooster:"2",code:"92"},{name:"Palau",alternativeSpellings:"PW",relevancyBooster:"0.5",code:"680"},{name:"Palestinian Territory, Occupied",alternativeSpellings:"PS فلسطين"},{name:"Panama",alternativeSpellings:"PA",code:"507"},{name:"Papua New Guinea",alternativeSpellings:"PG",code:"675"},{name:"Paraguay",alternativeSpellings:"PY",code:"595"},{name:"Peru",alternativeSpellings:"PE",code:"51"},{name:"Philippines",alternativeSpellings:"PH Pilipinas",relevancyBooster:"1.5",code:"63"},{name:"Pitcairn",alternativeSpellings:"PN",relevancyBooster:"0.5",code:"64"},{name:"Poland",alternativeSpellings:"PL Polska",relevancyBooster:"1.25",code:"48"},{name:"Portugal",alternativeSpellings:"PT Portuguesa",relevancyBooster:"1.5",code:"351"},{name:"Puerto Rico",alternativeSpellings:"PR",code:"1787,1939"},{name:"Qatar",alternativeSpellings:"QA قطر",code:"974"},{name:"Réunion",alternativeSpellings:"RE Reunion",code:"262"},{name:"Romania",alternativeSpellings:"RO Rumania Roumania România",code:"40"},{name:"Russian Federation",alternativeSpellings:"RU Rossiya Российская Россия",relevancyBooster:"2.5",code:"7"},{name:"Rwanda",alternativeSpellings:"RW",code:"250"},{name:"Saint Barthélemy",alternativeSpellings:"BL St. Barthelemy",code:"590"},{name:"Saint Helena",alternativeSpellings:"SH St.",code:"290"},{name:"Saint Kitts and Nevis",alternativeSpellings:"KN St.",code:"1869"},{name:"Saint Lucia",alternativeSpellings:"LC St.",code:"1758"},{name:"Saint Martin (French Part)",alternativeSpellings:"MF St."},{name:"Saint Pierre and Miquelon",alternativeSpellings:"PM St.",code:"508"},{name:"Saint Vincent and the Grenadines",alternativeSpellings:"VC St.",code:"1784"},{name:"Samoa",alternativeSpellings:"WS",code:"685"},{name:"San Marino",alternativeSpellings:"SM",code:"378"},{name:"Sao Tome and Principe",alternativeSpellings:"ST"},{name:"Saudi Arabia",alternativeSpellings:"SA السعودية",code:"966"},{name:"Senegal",alternativeSpellings:"SN Sénégal",code:"221"},{name:"Serbia",alternativeSpellings:"RS Србија Srbija",code:"381"},{name:"Seychelles",alternativeSpellings:"SC",relevancyBooster:"0.5",code:"248"},{name:"Sierra Leone",alternativeSpellings:"SL",code:"232"},{name:"Singapore",alternativeSpellings:"SG Singapura  சிங்கப்பூர் குடியரசு 新加坡共和国",code:"65"},{name:"Sint Maarten (Dutch Part)",alternativeSpellings:"SX"},{name:"Slovakia",alternativeSpellings:"SK Slovenská Slovensko",code:"421"},{name:"Slovenia",alternativeSpellings:"SI Slovenija",code:"386"},{name:"Solomon Islands",alternativeSpellings:"SB",code:"677"},{name:"Somalia",alternativeSpellings:"SO الصومال",code:"252"},{name:"South Africa",alternativeSpellings:"ZA RSA Suid-Afrika",code:"27"},{name:"South Georgia and the South Sandwich Islands",alternativeSpellings:"GS"},{name:"South Sudan",alternativeSpellings:"SS",code:"211"},{name:"Spain",alternativeSpellings:"ES España",relevancyBooster:"2",code:"34"},{name:"Sri Lanka",alternativeSpellings:"LK ශ්‍රී ලංකා இலங்கை Ceylon",code:"94"},{name:"Suriname",alternativeSpellings:"SR शर्नम् Sarnam Sranangron",code:"597"},{name:"Svalbard and Jan Mayen",alternativeSpellings:"SJ",relevancyBooster:"0.5",code:"4779"},{name:"Swaziland",alternativeSpellings:"SZ weSwatini Swatini Ngwane",code:"268"},{name:"Sweden",alternativeSpellings:"SE Sverige",relevancyBooster:"1.5",code:"46"},{name:"Switzerland",alternativeSpellings:"CH Swiss Confederation Schweiz Suisse Svizzera Svizra",relevancyBooster:"1.5",code:"41"},{name:"Taiwan, Province of China",alternativeSpellings:"TW 台灣 臺灣",code:"886"},{name:"Tajikistan",alternativeSpellings:"TJ Тоҷикистон Toçikiston",code:"992"},{name:"Tanzania, United Republic of",alternativeSpellings:"TZ"},{name:"Thailand",alternativeSpellings:"TH ประเทศไทย Prathet Thai",code:"66"},{name:"Timor-Leste",alternativeSpellings:"TL",code:"670"},{name:"Togo",alternativeSpellings:"TG Togolese",code:"228"},{name:"Tokelau",alternativeSpellings:"TK",relevancyBooster:"0.5",code:"690"},{name:"Tonga",alternativeSpellings:"TO",code:"676"},{name:"Trinidad and Tobago",alternativeSpellings:"TT",code:"1868"},{name:"Tunisia",alternativeSpellings:"TN تونس",code:"216"},{name:"Turkey",alternativeSpellings:"TR Türkiye Turkiye",code:"90"},{name:"Turkmenistan",alternativeSpellings:"TM Türkmenistan",code:"993"},{name:"Turks and Caicos Islands",alternativeSpellings:"TC",relevancyBooster:"0.5",code:"1649"},{name:"Tuvalu",alternativeSpellings:"TV",relevancyBooster:"0.5",code:"688"},{name:"Uganda",alternativeSpellings:"UG",code:"256"},{name:"Ukraine",alternativeSpellings:"UA Ukrayina Україна",code:"380"},{name:"United Arab Emirates",alternativeSpellings:"AE UAE الإمارات",code:"971"},{name:"United Kingdom",alternativeSpellings:"GB Great Britain England UK Wales Scotland Northern Ireland",relevancyBooster:"2.5",code:"44"},{name:"United States",relevancyBooster:"3.5",alternativeSpellings:"US USA United States of America",code:"1"},{name:"United States Minor Outlying Islands",alternativeSpellings:"UM"},{name:"Uruguay",alternativeSpellings:"UY",code:"598"},{name:"Uzbekistan",alternativeSpellings:"UZ Ўзбекистон O'zbekstan O‘zbekiston",code:"998"},{name:"Vanuatu",alternativeSpellings:"VU",code:"678"},{name:"Venezuela",alternativeSpellings:"VE",code:"58"},{name:"Vietnam",alternativeSpellings:"VN Việt Nam",relevancyBooster:"1.5"},{name:"Virgin Islands, British",alternativeSpellings:"VG",relevancyBooster:"0.5"},{name:"Virgin Islands, U.S.",alternativeSpellings:"VI",relevancyBooster:"0.5"},{name:"Wallis and Futuna",alternativeSpellings:"WF",relevancyBooster:"0.5",code:"681"},{name:"Western Sahara",alternativeSpellings:"EH لصحراء الغربية",code:"212"},{name:"Yemen",alternativeSpellings:"YE اليمن",code:"967"},{name:"Zambia",alternativeSpellings:"ZM",code:"260"},{name:"Zimbabwe",alternativeSpellings:"ZW",code:"263"}],COLORS:[{id:1,name:"ORANGE",hex:"e3622b"},{id:2,name:"RED",hex:"ee2003"},{id:3,name:"YELLOW",hex:"d4c624"},{id:4,name:"GREEN",hex:"71cd38"},{id:5,name:"BLUE",hex:"125ea4"},{id:6,name:"GRAY",hex:"6e727a"}],PASSPORT_COLORS:[{id:1,name:"ORANGE",hex:"67280e"},{id:2,name:"RED",hex:"570c01"},{id:3,name:"YELLOW",hex:"514c0e"},{id:4,name:"GREEN",hex:"2e5616"},{id:5,name:"BLUE",hex:"030f1a"},{id:6,name:"GRAY",hex:"25272a"}],STATES:[{name:"Alabama",alternativeSpellings:"AL"},{name:"Alaska",alternativeSpellings:"AK"},{name:"American Samoa",alternativeSpellings:"AS"},{name:"Arizona",alternativeSpellings:"AZ"},{name:"Arkansas",alternativeSpellings:"AR"},{name:"California",alternativeSpellings:"CA"},{name:"Colorado",alternativeSpellings:"CO"},{name:"Connecticut",alternativeSpellings:"CT"},{name:"Delaware",alternativeSpellings:"DE"},{name:"District Of Columbia",alternativeSpellings:"DC"},{name:"Federated States Of Micronesia",alternativeSpellings:"FM"},{name:"Florida",alternativeSpellings:"FL"},{name:"Georgia",alternativeSpellings:"GA"},{name:"Guam",alternativeSpellings:"GU"},{name:"Hawaii",alternativeSpellings:"HI"},{name:"Idaho",alternativeSpellings:"ID"},{name:"Illinois",alternativeSpellings:"IL"},{name:"Indiana",alternativeSpellings:"IN"},{name:"Iowa",alternativeSpellings:"IA"},{name:"Kansas",alternativeSpellings:"KS"},{name:"Kentucky",alternativeSpellings:"KY"},{name:"Louisiana",alternativeSpellings:"LA"},{name:"Maine",alternativeSpellings:"ME"},{name:"Marshall Islands",alternativeSpellings:"MH"},{name:"Maryland",alternativeSpellings:"MD"},{name:"Massachusetts",alternativeSpellings:"MA"},{name:"Michigan",alternativeSpellings:"MI"},{name:"Minnesota",alternativeSpellings:"MN"},{name:"Mississippi",alternativeSpellings:"MS"},{name:"Missouri",alternativeSpellings:"MO"},{name:"Montana",alternativeSpellings:"MT"},{name:"Nebraska",alternativeSpellings:"NE"},{name:"Nevada",alternativeSpellings:"NV"},{name:"New Hampshire",alternativeSpellings:"NH"},{name:"New Jersey",alternativeSpellings:"NJ"},{name:"New Mexico",alternativeSpellings:"NM"},{name:"New York",alternativeSpellings:"NY"},{name:"North Carolina",alternativeSpellings:"NC"},{name:"North Dakota",alternativeSpellings:"ND"},{name:"Northern Mariana Islands",alternativeSpellings:"MP"},{name:"Ohio",alternativeSpellings:"OH"},{name:"Oklahoma",alternativeSpellings:"OK"},{name:"Oregon",alternativeSpellings:"OR"},{name:"Palau",alternativeSpellings:"PW"},{name:"Pennsylvania",alternativeSpellings:"PA"},{name:"Puerto Rico",alternativeSpellings:"PR"},{name:"Rhode Island",alternativeSpellings:"RI"},{name:"South Carolina",alternativeSpellings:"SC"},{name:"South Dakota",alternativeSpellings:"SD"},{name:"Tennessee",
alternativeSpellings:"TN"},{name:"Texas",alternativeSpellings:"TX"},{name:"Utah",alternativeSpellings:"UT"},{name:"Vermont",alternativeSpellings:"VT"},{name:"Virgin Islands",alternativeSpellings:"VI"},{name:"Virginia",alternativeSpellings:"VA"},{name:"Washington",alternativeSpellings:"WA"},{name:"West Virginia",alternativeSpellings:"WV"},{name:"Wisconsin",alternativeSpellings:"WI"},{name:"Wyoming",alternativeSpellings:"WY"}],PROVINCES:[{name:"Alberta",alternativeSpellings:"AB"},{name:"British Columbia",alternativeSpellings:"BC Colombie Britannique"},{name:"Manitoba",alternativeSpellings:"MB"},{name:"New Brunswick",alternativeSpellings:"NB Nouveau Brunswick"},{name:"Newfoundland and Labrador",alternativeSpellings:"NL Terre-Neuve et Labrador"},{name:"Nova Scotia",alternativeSpellings:"NS Nouvelle Écosse"},{name:"Ontario",alternativeSpellings:"ON"},{name:"Prince Edward Island",alternativeSpellings:"PE Île du Prince Édouard"},{name:"Quebec",alternativeSpellings:"QC Québec"},{name:"Saskatchewan",alternativeSpellings:"SK"},{name:"Northwest Territories",alternativeSpellings:"NT Territoires du Nord Ouest"},{name:"Nunavut",alternativeSpellings:"NU"},{name:"Yukon",alternativeSpellings:"YT"}]},PB.CallbackResponse=function(e,t,o){this.data=e,this.message=o||"OK",this.error=t},PB.CallbackResponse.createError=function(e,t){e||(e="error");var o=PB.CallbackResponse.errors;return new PB.CallbackResponse(t,e,o[e]||o.error)},PB.CallbackResponse.errors={error:"An error occured",invalid_input:"Passed input is invalid",invalid_params:"Passed parameters are invalid",invalid_json:"JSON string could not be parsed",invalid_response_json:"Response is expected to be JSON but received otherwise",error_http:"HTTP response returned an error",invalid_password:"Inputted password is invalid"},"undefined"!=typeof module&&module.exports&&(module.exports=PB.CallbackResponse),PB="undefined"!=typeof PB?PB:{},PB.Error=function(e){"object"!=typeof e&&(e={}),this.name=e.name||"Error",this.code=e.code,this.data=e.data,this.message=e.message||"An error occured",!this.message&&this.code&&PB.Error.messageDictionary[this.code]&&(this.message=PB.Error.messageDict[this.code])},PB.Error.prototype=new Error,PB.Error.prototype.constructor=PB.Error,PB.Error.messageDictionary={invalid_params:"Input parameter validation failed"},"undefined"!=typeof module&&module.exports&&(module.exports=PB.Error),PB="undefined"==typeof PB?{}:PB,PB.Utility={parseUrl:function(e){var t=document.createElement("a");t.href=e;var o={url:t.href,protocol:t.protocol,host:t.hostname,port:t.port,path:t.pathname,query:t.search,hash:t.hash};return o.toString=function(){return this.url},o},isSameDomain:function(e,t,o){if(!e)throw new Error("First argument is required.");if(!t)throw new Error("Second argument is required.");o||(o=1);for(var n=e.host||PB.Utility.parseUrl(e).host,a=t.host||PB.Utility.parseUrl(t).host,r=n.split("."),i=a.split("."),s=0;o>s;++s){var c=r.pop(),l=i.pop();if(c!=l)return!1}return!0},getObjectSize:function(e){var t=0;for(var o in e)e.hasOwnProperty(o)&&++t;return t},isFunction:function(e){return!!(e&&e.constructor&&e.call&&e.apply)},setClipboardText:function(e){var t=45e3;if(" "!=e&&(clearTimeout(PB.Utility.clearClipboardTimeout),PB.Utility.clearClipboardTimeout=setTimeout(function(){PB.Utility.setClipboardText(" ")},t)),"desktop-extension-firefox"==PB.config.target)PB.Utility.setClipboardFF(e);else{var o=$("#copy_textarea");if(!o.length)return;o.html(e),o.focus(),o.select(),document.execCommand("copy"),o.html("")}},generateUuid:function(e,t){for(t=e="";e++<36;t+=51*e&52?(15^e?8^Math.random()*(20^e?16:4):4).toString(16):"-");return t},generateWelcomeUrl:function(e,t){var o="https://www.passwordbox.com/welcome/?p="+e+"&source="+(t||"extension");return o},compareVersions:function(e,t){if(!t||!e)return!1;var o,n,a,r;try{o=t.split("."),n=e.split(".")}catch(i){return console.error("Error splitting version number",i),!1}for(var s=0,c=Math.min(o.length,n.length);c>s;){if(isNaN(a=parseInt(o[s])))return!1;if(isNaN(r=parseInt(n[s])))return!1;if(a!=r)return r-a;++s}return o.length==n.length?0:parseInt(o.length>n.length?o[s]:n[s])},getBrowser:function(){if("desktop-extension-firefox"==PB.config.target)return"firefox";var e,t=navigator.appName,o=navigator.userAgent,n=o.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i);return n&&null!=(e=o.match(/version\/([\.\d]+)/i))&&(n[2]=e[1]),n=n?[n[1],n[2]]:[t,navigator.appVersion,"-?"],n.join(" ")},getOS:function(){if("desktop-extension-firefox"==PB.config.target)return null;var e,t=navigator.userAgent;return(e=t.match(/(windows nt \d+(.\d+)*)/i))?e[1]:(e=t.match(/(mac os x \d+(.\d+)*)/i))?e[1]:-1!=t.indexOf("Linux")?"Linux":-1!=t.indexOf("X11")?"UNIX":null},isNumber:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},isInteger:function(e){var t=parseFloat(e);return!isNaN(t)&&t%1==0},isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},emptyFunc:function(){}},PB="undefined"!=typeof PB?PB:{},PB.validation=function(e,t){"use strict";function o(e,t,o,r){c&&(e=e.replace("{attribute}",c)),e=e.replace("{attribute}",t),e=e.replace("{value}",o),e=e.replace("{rule_value}",r),n[t]=e,a.push(e)}e&&"object"==typeof e||(e={}),"object"!=typeof t&&(t={});var n={},a=[];for(var r in t)if(t.hasOwnProperty(r)){var i=e[r],s=t[r],c=s.altName;if("undefined"!=typeof i){for(var l in s)if(s.hasOwnProperty(l)&&"message"!=l&&"required"!=l){var u=s[l];"pattern"==l&&(l="pattern_"+u);var d=PB.validation[l];if(d){var m=d(i,u);if(m===!1){if("default"in s){e[r]=s["default"];break}o(s.message||d.message||"",r,i,u);break}m!==!0&&(e[r]=m)}}}else"default"in s?e[r]=s["default"]:s.required&&o(PB.validation.required.message,r,i,u)}return Object.keys(n).length&&(e._errors=n,e._errorMessage=a.join("; ")),e},PB.validation["default"]=function(e,t){return!0},PB.validation.required=function(e,t){return t?void 0!==e:!0},PB.validation.required.message='"{attribute}" is required',PB.validation.type=function(e,t){return typeof e===t},PB.validation.type.message='"{attribute}" must be of type {rule_value}',PB.validation.instance=function(value,rule){var constr;try{constr=eval(rule)}catch(e){}return constr&&value instanceof constr},PB.validation.instance.message='"{attribute}" must be an instance of {rule_value}',PB.validation.match=function(e,t){return t.test&&t.test(e)},PB.validation.match.message='"{attribute}" must match {rule_value}',PB.validation.pattern_email=function(e){var t=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i;return t.test(e)},PB.validation.pattern_email.message='"{attribute}" must be a valid e-mail address',PB.validation.pattern_url=function(e){var t=/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i;return t.test(e)},PB.validation.pattern_url.message='"{attribute}" must be a valid URL',PB.validation.fn=function(e,t){return t(e)},PB.validation.fn.message='"{attribute}" failed custom validation function',PB.validation.minLength=function(e,t){return e&&e.length&&e.length>=t},PB.validation.minLength.message='"{attribute}"\'s length must be at least {rule_value}',PB.validation.maxLength=function(e,t){return e&&e.length&&e.length<=t},PB.validation.maxLength.message='"{attribute}"\'s length must be at most {rule_value}',PB.validation.lowercase=function(e,t){return"string"!=typeof e?!0:t?e.toLowerCase()==e:e.toLowerCase()},PB.validation.lowercase.message='"{attribute}" must be lowercase',PB.validation.isArray=function(e,t){var o="[object Array]"===Object.prototype.toString.call(e);return o||t?o:[]},PB.validation.isArray.message='"{attribute}" must be an array',"undefined"!=typeof module&&module.exports&&(module.exports=PB.validation),PB.validationRuleSet={emailAddress:{required:!0,type:"string",pattern:"email",lowercase:!1},masterPassword:{required:!0,type:"string",minLength:6}},PB.asset=function(){"use strict";var e={},t={validationRule:{url:{required:!0,pattern:"url"},name:{},username:{},password:{}}};return t.getCollection=function(){return FA.Background.assets},e.create=function(e,o){if(e=PB.validation(e,{data:{required:!0,isArray:!0}}),"function"!=typeof o&&(o=PB.Utility.emptyFunc),e._errors)return o(PB.CallbackResponse.createError("invalid_params",e._errors));for(var n,a=[],r={},i=e.data,s=0;s<i.length;++s){var c=i[s];if(c=PB.validation(c,t.validationRule),c._errors)r[s]=c._errors,n=!0;else try{var l=c.name||c.url,u=c.username,d=PB.crypto.AES.encrypt(c.password,FA.Background.fa_member.key),m=c.url;a.push({name:l,login:u,password_k:d,url:m})}catch(g){r[s]="Exception: "+g.message,n=!0,console.error("Exception: "+g.message,l,u,d,m);continue}}return!e.bypassError&&n?o(PB.CallbackResponse.createError("invalid_data",r)):a.length?void PB.API.request({path:"/assets/bulk",type:"POST",data:a},function(e){t.afterCreate(e,o)}):o(PB.CallbackResponse.createError("empty_data"))},t.afterCreate=function(e,o){if(e.error)return o(e);for(var n=[],a=e.data,r=a.successes||[],i=0;i<r.length;++i){var s=r[i],c=new(t.getCollection().model)(s);c.id=s.id,c&&(t.getCollection().add(c),n.push(c))}o(new PB.CallbackResponse(n))},(Object.freeze||Object)(e),e}(),"undefined"==typeof PB&&(PB={}),PB.config={target:"desktop-extension-chrome",oj:!0},null==localStorage.getItem("pb_user_activity")&&localStorage.setItem("pb_user_activity",JSON.stringify({})),PB.user_activity=new function(){var e=this;this.get_obj=function(){var e=localStorage.getItem("pb_user_activity");return e?JSON.parse(e):{}},this.save_obj=function(){try{localStorage.setItem("pb_user_activity",JSON.stringify(t))}catch(e){console.error("Error saving user activity tracker",e.message)}},this.get_user_obj=function(e){return t[e]||[]},this.list_users=function(){var e=[];for(key in t)"undefined"!=key&&"null"!=key&&e.push(key);return e},this.list_domains_for_user=function(t){var o=e.get_user_obj(t);return void 0==o?null:o},this.user_has_domain=function(t,o){var n=e.get_user_obj(t);return n.indexOf(o)>=0?!0:!1},this.list_users_for_domain=function(e){var o=[];return _.each(t,function(t,n){t.indexOf(e)>-1&&o.push(n)}),o},this.user_signed_up=function(e){return"undefined"==typeof t[e]?!1:!0},this.add_domain_for_user=function(o,n){return void 0==t[o]?!1:void(-1==t[o].indexOf(n)&&(t[o].push(n),e.save_obj()))},this.import_user_assets=function(o){t[o]=[],FA.Background.assets.each(function(e){var n=e.get("domain");t[o].indexOf(n)<0&&t[o].push(n)}),e.save_obj()},this.update_user=function(o){void 0!=o&&void 0==t[o]&&(t[o]=[],e.save_obj())},this.init=function(e){t=e||{}};var t=this.obj=this.get_obj()},PB.SessionData={},PB.SessionData.events={},"undefined"!=typeof module&&module.exports&&(module.exports=PB.SessionData),PB="undefined"!=typeof PB?PB:{},PB.settings={csLoadCount:{get:function(){return parseInt(localStorage.getItem("cs_load_count"))||0},increment:function(){var e=localStorage.getItem("cs_load_count")||0;e=++e%PB.Config.PAGE_LOAD_COUNT_BEFORE_NOTIFICATION,localStorage.setItem("cs_load_count",e)}},hideRegister:function(e){e(!!identityManager.identity.p)},reset:function(){this.rememberEmail.activate(),PB.Config.IS_LITE?this.rememberPassword.deactivate():this.rememberPassword.activate(),this.showPassword.deactivate(),this.defaultAutoLogin.activate()},rememberEmail:{activate:function(){PB.settings.cachedEmail.activate(),localStorage.setItem("rememberLastEmail",!0)},deactivate:function(){PB.settings.cachedEmail.deactivate(),localStorage.setItem("rememberLastEmail",""),PB.settings.rememberPassword.deactivate()},isActive:function(){return!!localStorage.getItem("rememberLastEmail")}},rememberPassword:{activate:function(e){localStorage.setItem("rProfile",!0),e&&(PB.settings.rememberEmail.activate(),FA.Background.setProfilePicture())},deactivate:function(){localStorage.setItem("rProfile",""),PB.settings.profile.reset()},isActive:function(){return!!localStorage.getItem("rProfile")}},showPassword:{activate:function(){localStorage.setItem("showPassword",!0)},deactivate:function(){localStorage.setItem("showPassword","")},isActive:function(){return!!localStorage.getItem("showPassword")}},autoCopy:{activate:function(e){localStorage.setItem("autoCopy",e)},deactivate:function(){localStorage.setItem("autoCopy",!1)},isActive:function(){return localStorage.getItem("autoCopy")?"false"==localStorage.getItem("autoCopy")?!1:localStorage.getItem("autoCopy"):"password"}},autoLock:{get_value:function(){return localStorage.getItem("autoLock")},activate:function(e){localStorage.setItem("autoLock",e)},deactivate:function(){localStorage.setItem("autoLock","")},ping:function(){localStorage.setItem("ping",(new Date).getTime())},isActive:function(){return!!localStorage.getItem("autoLock")},isLocked:function(){if(localStorage.getItem("autoLock")&&localStorage.getItem("ping")){var e=(new Date).getTime(),t=Math.floor((e-localStorage.getItem("ping"))/1e3/60);if(t>=localStorage.getItem("autoLock"))return localStorage.removeItem("ping"),!0}return localStorage.setItem("ping",(new Date).getTime()),!1}},defaultAutoLogin:{activate:function(){localStorage.setItem("settings_auto_login",!0)},deactivate:function(){localStorage.setItem("settings_auto_login","")},isActive:function(){return!!localStorage.getItem("settings_auto_login")}},skipIntro:{activate:function(){localStorage.setItem("first_visit_done",!0)},deactivate:function(){localStorage.setItem("first_visit_done","")},isActive:function(){return!!localStorage.getItem("first_visit_done")}},profile:{get:function(e){var t=e||{};return!t.nocache&&PB.settings.profile.get.cache?PB.settings.profile.get.cache:void PB.MemoryMap.get("profile",{success:function(e){PB.settings.profile.get.cache=e,t.success&&t.success(e)}})},set:function(e){PB.MemoryMap.set("profile",e),PB.settings.profile.get.cache=e},reset:function(){PB.MemoryMap.set("profile",""),PB.settings.profile.get.cache=""},isActive:function(e){var t=e||{};return t.nocache||"undefined"==typeof PB.settings.profile.get.cache?void PB.MemoryMap.get("profile",{success:function(e){PB.settings.profile.get.cache=e,t.success&&t.success(!!e)}}):(t.success&&t.success(!!PB.settings.profile.get.cache),!!PB.settings.profile.get.cache)}},key:{get:function(e){var t=e||{};return!t.nocache&&PB.settings.key.get.cache?PB.settings.key.get.cache:void PB.MemoryMap.get("key",{success:function(e){PB.settings.key.get.cache=e,t.success&&t.success(e)}})},set:function(e){PB.MemoryMap.set("key",e),PB.settings.key.get.cache=e},reset:function(){PB.MemoryMap.set("key",""),PB.settings.key.get.cache=""},isActive:function(e){var t=e||{};return t.nocache||"undefined"==typeof PB.settings.key.get.cache?void PB.MemoryMap.get("key",{success:function(e){PB.settings.key.get.cache=e,t.success&&t.success(!!e)}}):(t.success&&t.success(!!PB.settings.key.get.cache),!!PB.settings.key.get.cache)}},cachedEmail:{get:function(){return localStorage.getItem("lastEmail")},activate:function(){var e=FA.Background.fa_login||"";localStorage.setItem("lastEmail",e)},deactivate:function(){localStorage.setItem("lastEmail","")},isActive:function(){return!!localStorage.getItem("lastEmail")}},skipNotification:{activate:function(){localStorage.setItem("settings_skip_notification",!0)},deactivate:function(){localStorage.setItem("settings_skip_notification","")},isActive:function(){return!!localStorage.getItem("settings_skip_notification")}},csrfToken:{get:function(){return localStorage.removeItem("fa_csrf"),PB.SessionData.csrfToken},set:function(e){localStorage.removeItem("fa_csrf"),PB.SessionData.csrfToken=e},reset:function(){PB.SessionData.csrfToken=null},isActive:function(){return!!PB.SessionData.csrfToken}},is_connected:function(){if(!navigator.onLine)return!1;if(navigator.connection){var e=navigator.connection.type;return"none"==e||"unknown"==e?!1:!0}},uuid:{get:function(){return localStorage.getItem("uuid")},reset:function(){localStorage.setItem("uuid",PB.Utility.generateUuid())}},autoLoginTimeoutInterval:{get:function(){return parseInt(localStorage.getItem("auto_login_timeout_interval"))||0},set:function(e){$.ajax({url:"https://metrics.passwordbox.com/ping",data:{evt:"auto_login_timeout_interval_changed",mid:FA.Background.fa_member_id,v:e}}),console.log("auto_login_timeout_interval_changed",e),localStorage.setItem("auto_login_timeout_interval",e),PB.AutoLoginTimeout.reset_timer()},get_formatted:function(){var e=parseInt(localStorage.getItem("auto_login_timeout_interval"))||0,t=null;switch(e){case 60:t="1_minute";break;case 900:t="15_minutes";break;case 1800:t="30_minutes";break;case 3600:t="1_hour";break;case 0:default:t="never"}return t}},lastActiveTimestamp:{get:function(){return parseInt(localStorage.getItem("auto_logout_timestamp"))||Math.round(+new Date/1e3)},reset:function(){localStorage.setItem("auto_logout_timestamp",Math.round(+new Date/1e3))}},toggle_startpage:{get:function(){return localStorage.getItem("new_tab_customize")},set:function(e){localStorage.setItem("new_tab_customize",e)},get_url:function(){return localStorage.getItem("new_tab_custom_url")},set_url:function(e){localStorage.setItem("new_tab_custom_url",e)}},ExtensionFirstLoaded:{get:function(){return!!localStorage.getItem("extension_first_loaded")},set:function(){localStorage.setItem("extension_first_loaded",!0)},reset:function(){localStorage.setItem("extension_first_loaded","")}}},PB="undefined"==typeof PB?{}:PB,PB.crypto={settings:{aes_version:"CCM"},RSA:{generate:function(e){var t=new RSAKey;t.generate(parseInt(e),"3");var o=new Object;return o.n=t.n.toString(16),o.e=t.e.toString(16),o.d=t.d.toString(16),o.p=t.p.toString(16),o.q=t.q.toString(16),o.dmp1=t.dmp1.toString(16),o.dmq1=t.dmq1.toString(16),o.coeff=t.coeff.toString(16),o},makeKeys:function(e){var t={};t.n=e.n.toString(16),t.e=e.e.toString(16);var o={};o.n=e.n.toString(16),o.e=e.e.toString(16),o.d=e.d.toString(16),o.p=e.p.toString(16),o.q=e.q.toString(16),o.dmp1=e.dmp1.toString(16),o.dmq1=e.dmq1.toString(16),e.iqmp?o.coeff=e.iqmp.toString(16):e.coeff&&(o.coeff=e.coeff.toString(16));var n={jsonPublicKey:t,jsonPrivateKey:o};return n},encrypt:function(e,t){var o=new RSAKey;return o.setPublic(t.n,t.e),o.encrypt(e)},decrypt:function(e,t){var o=new RSAKey;return o.setPrivateEx(t.n,t.e,t.d,t.p,t.q,t.dmp1,t.dmq1,t.coeff),o.decrypt(e)}},AES:{encrypt:function(e,t,o){return"number"==typeof e&&(e=e.toString()),"CTR"==PB.crypto.settings.aes_version?PB.crypto.COMPAT.encryptVeness(e,t,256):"CCM"==PB.crypto.settings.aes_version?PB.crypto.COMPAT.encrypt(e,t,256):void 0},decrypt:function(e,t,o){return PB.crypto.COMPAT.decrypt(e,t,256)}},PBKDF2:{derive:function(e,t,o){return CryptoJS.PBKDF2(e,t,o)}},SALT:{generate:function(){if("desktop-extension-firefox"==PB.config.target)return CryptoJS.lib.WordArray.random(16).toString();var e=sjcl.random.randomWords(8),t=sjcl.codec.hex.fromBits(e);return t}},COMPAT:{encrypt:function(e,t,o){var n=sjcl.bitArray,a=sjcl.json,r=n.partial(16,4);params={mode:"ccm",ks:o?o:256},rp={},"string"==typeof t&&(t=sjcl.codec.hex.toBits(t)),n.bitLength(t)>256&&(t=n.clamp(t,256));var i=sjcl.encrypt(t,e,params,rp),s=a.decode(i);return sjcl.codec.base64.fromBits(n.concat([r],n.concat(s.iv,s.ct)))},decrypt:function(e,t,o){var n,a,r,i=sjcl.bitArray,s=sjcl.json,c={};n=sjcl.codec.base64.toBits(e);var l=i.extract(n,8,8);if(4>l)r={iv:i.clamp(n,64),compat:"veness"},ctxt=n.slice(2),mode="ctr";else{if(l>4)throw"invalid cipher format version";"string"==typeof t&&(t=sjcl.codec.hex.toBits(t)),i.bitLength(t)>256&&(t=i.clamp(t,256)),n=i.bitSlice(n,16),r={iv:i.clamp(n,128)},ctxt=n.slice(4),mode="ccm"}return a=s.encode({mode:mode,ks:o?o:256,ct:ctxt}),sjcl.decrypt(t,a,r,c)},version:function(e){return sjcl.bitArray.extract(sjcl.codec.base64.toBits(e),8,8)},encryptVeness:function(e,t,o){var n=sjcl.bitArray,a=sjcl.json,r=sjcl.random.randomWords(2,0);r[0]&=4278452223;var i={mode:"ctr",ks:o?o:256,compat:"veness",iv:r};rp={};var s=sjcl.encrypt(t,e,i,rp),c=a.decode(s);return sjcl.codec.base64.fromBits(n.concat(c.iv,c.ct))},decryptVeness:function(e,t,o){var n,a,r,i=sjcl.bitArray,s=sjcl.json,c={};return n=sjcl.codec.base64.toBits(e),r={iv:i.clamp(n,64),compat:"veness"},a=s.encode({mode:"ctr",ks:o?o:256,ct:n.slice(2)}),sjcl.decrypt(t,a,r,c)}}},PB.crypto.SHA1=function(e){var t,o,n,a,r,i,s,c,l,u=function(e,t){return e<<t|e>>>32-t},d=function(e){var t,o,n="";for(t=7;t>=0;t--)o=e>>>4*t&15,n+=o.toString(16);return n},m=function(e){e=e.replace(/\x0d\x0a/g,"\n");for(var t="",o=0;o<e.length;o++){var n=e.charCodeAt(o);128>n?t+=String.fromCharCode(n):n>127&&2048>n?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t},g=new Array(80),p=1732584193,f=4023233417,h=2562383102,_=271733878,v=3285377520;e=m(e);var b=e.length,y=new Array;for(o=0;b-3>o;o+=4)n=e.charCodeAt(o)<<24|e.charCodeAt(o+1)<<16|e.charCodeAt(o+2)<<8|e.charCodeAt(o+3),y.push(n);switch(b%4){case 0:o=2147483648;break;case 1:o=e.charCodeAt(b-1)<<24|8388608;break;case 2:o=e.charCodeAt(b-2)<<24|e.charCodeAt(b-1)<<16|32768;break;case 3:o=e.charCodeAt(b-3)<<24|e.charCodeAt(b-2)<<16|e.charCodeAt(b-1)<<8|128}for(y.push(o);y.length%16!=14;)y.push(0);for(y.push(b>>>29),y.push(b<<3&4294967295),t=0;t<y.length;t+=16){for(o=0;16>o;o++)g[o]=y[t+o];for(o=16;79>=o;o++)g[o]=u(g[o-3]^g[o-8]^g[o-14]^g[o-16],1);for(a=p,r=f,i=h,s=_,c=v,o=0;19>=o;o++)l=u(a,5)+(r&i|~r&s)+c+g[o]+1518500249&4294967295,c=s,s=i,i=u(r,30),r=a,a=l;for(o=20;39>=o;o++)l=u(a,5)+(r^i^s)+c+g[o]+1859775393&4294967295,c=s,s=i,i=u(r,30),r=a,a=l;for(o=40;59>=o;o++)l=u(a,5)+(r&i|r&s|i&s)+c+g[o]+2400959708&4294967295,c=s,s=i,i=u(r,30),r=a,a=l;for(o=60;79>=o;o++)l=u(a,5)+(r^i^s)+c+g[o]+3395469782&4294967295,c=s,s=i,i=u(r,30),r=a,a=l;p=p+a&4294967295,f=f+r&4294967295,h=h+i&4294967295,_=_+s&4294967295,v=v+c&4294967295}var l=d(p)+d(f)+d(h)+d(_)+d(v);return l.toLowerCase()},PB.Crypto={},PB.Crypto.RSA={generate:function(e,t){if(!e||"object"!=typeof e)throw"Invalid parameter object";if(!t||"function"!=typeof t)throw"Invalid callback function";if(!e.length)throw"Required parameter 'length'";var o=new RSAKey;o.generate(parseInt(e.length),"3");var n=new Object;n.n=o.n.toString(16),n.e=o.e.toString(16),n.d=o.d.toString(16),n.p=o.p.toString(16),n.q=o.q.toString(16),n.dmp1=o.dmp1.toString(16),n.dmq1=o.dmq1.toString(16),n.coeff=o.coeff.toString(16),t(n)},makeKeys:function(e,t){if(!e||"object"!=typeof e)throw"Invalid parameter object";if(!t||"function"!=typeof t)throw"Invalid callback function";if(!e.rsa)throw"Required parameter 'rsa'";var o=e.rsa,n={};n.n=o.n.toString(16),n.e=o.e.toString(16);var a={};a.n=o.n.toString(16),a.e=o.e.toString(16),a.d=o.d.toString(16),a.p=o.p.toString(16),a.q=o.q.toString(16),a.dmp1=o.dmp1.toString(16),a.dmq1=o.dmq1.toString(16),a.coeff=o.iqmp.toString(16);var r={jsonPublicKey:n,jsonPrivateKey:a};t(r)},encrypt:function(e,t){if(!e||"object"!=typeof e)throw"Invalid parameter object";if(!t||"function"!=typeof t)throw"Invalid callback function";if(!e.secret)throw"Required parameter 'secret'";if(!e.key)throw"Required parameter 'key'";var o=e.secret,n=e.key,a=new RSAKey;a.setPublic(n.n,n.e);var r=a.encrypt(o);t(r)},decrypt:function(e,t){if(!e||"object"!=typeof e)throw"Invalid parameter object";if(!t||"function"!=typeof t)throw"Invalid callback function";if(!e.cipher)throw"Required parameter 'cipher'";if(!e.key)throw"Required parameter 'key'";var o=e.cipher,n=e.key,a=new RSAKey;a.setPrivateEx(n.n,n.e,n.d,n.p,n.q,n.dmp1,n.dmq1,n.coeff);var r=a.decrypt(o);t(r)}},PB.Crypto.AES={encrypt:function(e,t){if(!e||"object"!=typeof e)throw"Invalid parameter object";if(!t||"function"!=typeof t)throw"Invalid callback function";if(!e.plain)throw"Required parameter 'plain'";if(!e.passphrase)throw"Required parameter 'passphrase'";var o=e.plain,n=e.passphrase,n=("undefined"==typeof e.length?256:e.length,e.plaintext,e.passphrase);"CTR"==PB.crypto.settings.aes_version?t(PB.crypto.COMPAT.encryptVeness(o,n,256)):"CCM"==PB.crypto.settings.aes_version&&t(PB.crypto.COMPAT.encrypt(o,n,256))},decrypt:function(e,t){if(!e||"object"!=typeof e)throw"Invalid parameter object";if(!t||"function"!=typeof t)throw"Invalid callback function";if(!e.cipher)throw"Required parameter 'cipher'";if(!e.passphrase)throw"Required parameter 'passphrase'";var o=e.cipher,n=e.passphrase,o=("undefined"==typeof e.length?256:e.length,e.cipher),n=e.passphrase;t(PB.crypto.COMPAT.decrypt(o,n,256))}},PB.Crypto.PBKDF2={derive:function(e,t){if(!e||"object"!=typeof e)throw"Invalid parameter object";if(!t||"function"!=typeof t)throw"Invalid callback function";if(!e.plain)throw"Required parameter 'plain'";if(!e.salt)throw"Required parameter 'salt'";if(!e.length)throw"Required parameter 'length'";if(!e.iterations)throw"Required parameter 'iterations'";var o=e.plain,n=e.salt,a=e.length,r=e.iterations,i=e.sha256?sjcl.hash.sha256:sjcl.hash.sha1,s=sjcl.codec.hex.fromBits(sjcl.misc.pbkdf2(o,sjcl.codec.utf8String.toBits(n),r,a,sjcl.misc.hmac,i));t(s)}},PB.Crypto.SHA1=function(e,t){if(!e||"object"!=typeof e)throw"Invalid parameter object";if(!t||"function"!=typeof t)throw"Invalid callback function";var o,n,a,r,i,s,c,l,u,d=function(e,t){return e<<t|e>>>32-t},m=function(e){var t,o,n="";for(t=7;t>=0;t--)o=e>>>4*t&15,n+=o.toString(16);return n},g=function(e){e=e.replace(/\x0d\x0a/g,"\n");for(var t="",o=0;o<e.length;o++){var n=e.charCodeAt(o);128>n?t+=String.fromCharCode(n):n>127&&2048>n?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t},p=new Array(80),f=1732584193,h=4023233417,_=2562383102,v=271733878,b=3285377520,y=g(e.string),k=y.length,B=new Array;for(n=0;k-3>n;n+=4)a=y.charCodeAt(n)<<24|y.charCodeAt(n+1)<<16|y.charCodeAt(n+2)<<8|y.charCodeAt(n+3),B.push(a);switch(k%4){case 0:n=2147483648;break;case 1:n=y.charCodeAt(k-1)<<24|8388608;break;case 2:n=y.charCodeAt(k-2)<<24|y.charCodeAt(k-1)<<16|32768;break;case 3:n=y.charCodeAt(k-3)<<24|y.charCodeAt(k-2)<<16|y.charCodeAt(k-1)<<8|128}for(B.push(n);B.length%16!=14;)B.push(0);for(B.push(k>>>29),B.push(k<<3&4294967295),o=0;o<B.length;o+=16){for(n=0;16>n;n++)p[n]=B[o+n];for(n=16;79>=n;n++)p[n]=d(p[n-3]^p[n-8]^p[n-14]^p[n-16],1);for(r=f,i=h,s=_,c=v,l=b,n=0;19>=n;n++)u=d(r,5)+(i&s|~i&c)+l+p[n]+1518500249&4294967295,l=c,c=s,s=d(i,30),i=r,r=u;for(n=20;39>=n;n++)u=d(r,5)+(i^s^c)+l+p[n]+1859775393&4294967295,l=c,c=s,s=d(i,30),i=r,r=u;for(n=40;59>=n;n++)u=d(r,5)+(i&s|i&c|s&c)+l+p[n]+2400959708&4294967295,l=c,c=s,s=d(i,30),i=r,r=u;for(n=60;79>=n;n++)u=d(r,5)+(i^s^c)+l+p[n]+3395469782&4294967295,l=c,c=s,s=d(i,30),i=r,r=u;f=f+r&4294967295,h=h+i&4294967295,_=_+s&4294967295,v=v+c&4294967295,b=b+l&4294967295}var u=m(f)+m(h)+m(_)+m(v)+m(b);t(u.toLowerCase())},PB.Crypto.computeDerivedKey=function(e,t){function o(t){return e.client_iterations?void PB.Crypto.PBKDF2.derive({plain:t,salt:e.salt,iterations:parseInt(r),length:512,sha256:!0},n):n(t)}function n(t){PB.Crypto.PBKDF2.derive({plain:t,salt:e.salt,iterations:parseInt(i),length:256,sha256:!0},a)}function a(e){t(e)}if(!e||"object"!=typeof e)throw"Invalid parameter object";if(!t||"function"!=typeof t)throw"Invalid callback function";if(!e.plain)throw"Required parameter 'plain'";if(!e.salt)throw"Required parameter 'salt'";var r=e.client_iterations||0,i=e.server_iterations||1;PB.Crypto.PBKDF2.derive({plain:e.plain,salt:e.salt,iterations:1,length:512},o)},PB.Crypto.computeKey=PB.Crypto.computeKek=function(e,t){function o(t){PB.Crypto.PBKDF2.derive({plain:t+""+e.password,salt:e.salt,iterations:1,length:512},n)}function n(o){return e.encryptedKey?void PB.Crypto.AES.decrypt({cipher:e.encryptedKey,passphrase:o},a):t(o)}function a(e){t(e)}if(!e||"object"!=typeof e)throw"Invalid parameter object";if(!t||"function"!=typeof t)throw"Invalid callback function";if(!e.password)throw"Required parameter 'password'";if(!e.salt)throw"Required parameter 'salt'";if(!e.rules)throw"Required parameter 'rules'";if("object"!=typeof e.rules)throw"Invalid 'rules' parameter";PB.Crypto.computeDerivedKey({plain:e.password,salt:e.salt,server_iterations:e.rules.iterations,client_iterations:e.rules.client_iterations},o)},PB.Crypto.computeDerivedPassword=function(e,t){function o(e){t(e)}if(!e||"object"!=typeof e)throw"Invalid parameter object";if(!t||"function"!=typeof t)throw"Invalid callback function";if(!e.email)throw"Required parameter 'email'";if(!e.password)throw"Required parameter 'password'";var n=PB.crypto.SHA1(e.email);PB.Crypto.PBKDF2.derive({plain:e.password,salt:n,iterations:1e4,length:256,sha256:!0},o)},PB.Crypto.computeLocalDataKey=function(e,t){function o(e){t(e)}if(!e||"object"!=typeof e)throw"Invalid parameter object";if(!t||"function"!=typeof t)throw"Invalid callback function";if(!e.base)throw"Required parameter 'base'";if(!e.salt)throw"Required parameter 'salt'";PB.Crypto.PBKDF2.derive({plain:e.base,salt:e.salt,iterations:1e4,length:512},o)},PB.sharing={create:function(e,t,o){if(t=t||function(){return!1},o=o||function(){return!1},"object"!=typeof e)return o(),!1;if("undefined"==typeof e.contacts.length||e.contacts.length<1)return o(),!1;if(e.message=e.message||null,"after"==e.type)count=e.contacts.length,_.each(e.contacts,function(n){count--;var a={};add_to_collection=!1;var r=FA.Background.contacts.find_by_email(n.email);if(r&&null==r.get("secret_member_k")&&r.pending())return 0==count&&t(),!1;var i=r?!0:!1;PB.sharing.getPublicKey(n.email,function(s){if("string"==typeof s&&(s=JSON.parse(s)),r){if(null==r.get("secret_member_k")){var c=PB.crypto.SALT.generate(),l=PB.crypto.AES.encrypt(c,FA.Background.fa_member.key);a.secret_member_k=l,s&&""!=s.public_key&&("Object"!=typeof s.public_key&&"undefined"!=typeof s.public_key&&(s.public_key=JSON.parse(s.public_key)),a.secret_contact_pub=PB.crypto.RSA.encrypt(c,s.public_key))}a.auto_bequeath=!0}else{var c=PB.crypto.SALT.generate(),l=PB.crypto.AES.encrypt(c,FA.Background.fa_member.key);a.email=n.email,a.secret_member_k=l,a.invitation_type="after",a.auto_bequeath=!0,a.invitation_text=e.message,s&&""!=s.public_key&&("Object"!=typeof s.public_key&&"undefined"!=typeof s.public_key&&(s.public_key=JSON.parse(s.public_key)),a.secret_contact_pub=PB.crypto.RSA.encrypt(c,s.public_key)),
"string"==typeof n.name&&(a.fullname=n.name),add_to_collection=!0,r=new FA.Models.Contact}r.save(a,{success:function(){i||PB.mixpanel.track("invite_user",{invite_type:a.invitation_type}),PB.mixpanel.track("bequeath_box"),PB.reward.signalEvent({name:"assign_digital_heir"},function(e){PB.mixpanel.track("completed_reward_task",{rewards_passwords_earned:FA.Background.fa_member.get("awarded_allowance"),rewards_earned:localStorage.getItem("completedRewards"),intent_name:"assign_digital_heir",reward_password_count:e.data.adjustment_value})}),add_to_collection&&FA.Background.contacts.add(r);var e=FA.Background.assets.mine().length;PB.sharing.create_secret_for_every_asset({contact:r},function(){e--,0==count&&0>=e&&t()})},error:function(e,t,n){return console.error("Contact saving error"),o(),!1}})})});else{if("live"!=e.type)return o(),!1;if("object"!=typeof e.asset)return o(),!1;"undefined"==typeof e.asset.get&&(e.asset=new FA.Models.Asset(e.asset)),count2=e.contacts.length,_.each(e.contacts,function(n){count2--;var a=FA.Background.contacts.find_by_email(n.email),r={};if(a)if(null==a.get("secret_member_k")){if(a.pending())return o(),!1;var i=PB.crypto.SALT.generate(),s=PB.crypto.AES.encrypt(i,FA.Background.fa_member.key);r.secret_member_k=s,PB.sharing.getPublicKey(n.email,function(n){"string"==typeof n&&(n=JSON.parse(n)),n&&""!=n.public_key&&("Object"!=typeof n.public_key&&"undefined"!=typeof n.public_key&&(n.public_key=JSON.parse(n.public_key)),r.secret_contact_pub=PB.crypto.RSA.encrypt(i,n.public_key)),a.save(r,{success:function(){PB.sharing.create_secret_for_asset({contact:a,asset:e.asset,shared:!0},function(){0==count2&&(PB.mixpanel.track("share_password",{website_url:e.asset.attributes.url,asset_title:e.asset.attributes.name}),PB.reward.signalEvent({name:"share_asset"},function(e){PB.mixpanel.track("completed_reward_task",{rewards_passwords_earned:FA.Background.fa_member.get("awarded_allowance"),rewards_earned:localStorage.getItem("completedRewards"),intent_name:"share_asset",reward_password_count:e.data.adjustment_value})}),t())})},error:function(e,t,n){return console.error("Contact saving error"),o(),!1}})})}else PB.sharing.create_secret_for_asset({contact:a,asset:e.asset,shared:!0},function(){0==count2&&(PB.mixpanel.track("share_password",{website_url:e.asset.attributes.url,asset_title:e.asset.attributes.name}),PB.reward.signalEvent({name:"share_asset"},function(e){PB.mixpanel.track("completed_reward_task",{rewards_passwords_earned:FA.Background.fa_member.get("awarded_allowance"),rewards_earned:localStorage.getItem("completedRewards"),intent_name:"share_asset",reward_password_count:e.data.adjustment_value})}),t())});else PB.sharing.getPublicKey(n.email,function(i){"string"==typeof i&&(i=JSON.parse(i));var s=PB.crypto.SALT.generate(),c=PB.crypto.AES.encrypt(s,FA.Background.fa_member.key);r.email=n.email,r.secret_member_k=c,r.invitation_type="live",r.invitation_text=e.message,i&&""!=i.public_key&&("Object"!=typeof i.public_key&&"undefined"!=typeof i.public_key&&(i.public_key=JSON.parse(i.public_key)),r.secret_contact_pub=PB.crypto.RSA.encrypt(s,i.public_key)),"string"==typeof n.name&&(r.fullname=n.name),a=new FA.Models.Contact,a.save(r,{success:function(){PB.mixpanel.track("invite_user",{invite_type:r.invitation_type}),FA.Background.contacts.add(a),PB.sharing.create_secret_for_asset({contact:a,asset:e.asset,shared:!0},function(){0==count2&&(PB.mixpanel.track("share_password",{website_url:e.asset.attributes.url,asset_title:e.asset.attributes.name}),PB.reward.signalEvent({name:"share_asset"},function(e){PB.mixpanel.track("completed_reward_task",{rewards_passwords_earned:FA.Background.fa_member.get("awarded_allowance"),rewards_earned:localStorage.getItem("completedRewards"),intent_name:"share_asset",reward_password_count:e.data.adjustment_value})}),t())})},error:function(e,t,n){return console.error("Contact saving error"),o(),!1}})})})}},remove:function(e,t,o){if("undefined"==typeof e.contact.get&&(e.contact=FA.Background.contacts.get(e.contact.id)),t=t||function(){return!1},o=o||function(){return!1},"object"!=typeof e)return o(),!1;if("object"!=typeof e.contact)return o(),!1;if("after"==e.type)contact=e.contact,contact_id=contact.get("id"),contact.acceptedInvitation()||contact.hasSharedPasswords()?contact.save({auto_bequeath:!1},{success:function(e){var o=new Array;FA.Background.secrets.each(function(e){e.get("contact_id")==contact_id&&0==e.get("shared")&&o.push(e)}),o.length>0?(count=o.length,_.each(o,function(e){e.destroy({success:function(){count--,0==count&&t()},error:function(){count--,0==count&&t()}})})):t()},error:function(e,t,n){o()}}):contact.destroy({success:function(e){FA.Background.secrets.fetch({success:function(){FA.Background.contacts.fetch({success:function(){t()}})}})},error:function(e,t,n){o()}});else{if("live"!=e.type)return o(),!1;contact=e.contact,asset=e.asset,secret=FA.Background.secrets.getForContactAsset(contact,asset),1==contact.get("auto_bequeath")?secret.save({shared:0},{success:function(e,o){t()},error:function(e,t,n){o()}}):contact.acceptedInvitation()||1!=FA.Background.secrets.getForContact(contact).length?secret.destroy({success:function(e,o){t()},error:function(e,t,n){o()}}):contact.destroy({success:function(e){FA.Background.secrets.fetch({success:function(){t()}})},error:function(e,t,n){o()}})}},create_secret_for_every_asset:function(e,t){t=t||function(){return!1},_.each(FA.Background.assets.mine(),function(o){_.extend(e,{asset:o}),PB.sharing.create_secret_for_asset(e,t)}),0==FA.Background.assets.mine().length&&t()},create_secret_for_asset:function(e,t){t=t||function(){return!1};var o=e.asset,n=e.contact,a=e.shared?!0:!1,r={},i="";null!=o.getCPassword()&&""!=o.getCPassword()&&(i=PB.crypto.AES.encrypt(o.getCPassword(),n.getSharedSecret())),r.shared=a,r.crypted_key=i;var s=FA.Background.secrets.getForContactAsset(n,o);s?s.get("shared")&&(r.shared=!0):(r.contact_id=n.id,r.asset_id=o.id,s=new FA.Models.Secret);var c=s.isNew();s.save(r,{success:function(e,o){c&&FA.Background.secrets.add(e),t()},error:function(e,t,o){console.error("Could not save secret")}})},requests:function(e){e=e||function(){return!1},hash={url:FA_Config_urlApi+"invitations/index",type:"GET",dataType:"JSON",success:function(t){"object"!=typeof t&&(t=JSON.parse(t)),requests=new Array,t.length>0&&_.each(t,function(e){requests.push({name:e.fullname,email:e.email,member_id:e.member_id,preserve:e.auto_bequeath})}),FA.Background.requests=requests,"desktop-extension-firefox"!=PB.config.target?$(document).trigger("requestsLoaded"):FA.documentTrigger("requestsLoaded");try{e(requests)}catch(o){console.error("requests error")}}},$.ajax(hash)},accepted:function(e){e=e||function(){return!1},hash={url:FA_Config_urlApi+"invitations/accepted",type:"GET",dataType:"JSON",success:function(t){"object"!=typeof t&&(t=JSON.parse(t)),counting=new Array,t.length>0&&_.each(t,function(e){counting.push({name:e.fullname,member_id:e.member_id,email:e.email})}),FA.Background.counting=counting,"desktop-extension-firefox"!=PB.config.target?$(document).trigger("countingLoaded"):FA.documentTrigger("countingLoaded"),e(counting)}},$.ajax(hash)},accept:function(e,t){hash={url:FA_Config_urlApi+"invitations/update",type:"POST",dataType:"JSON",data:{member_id:e},success:function(e){FA.Background.contacts.fetch({success:function(){FA.Background.extensionBadge.updateState(),t&&t(!0)}})},error:function(e,o,n){console.error("PB.Sharing.accept error: "+JSON.stringify(e)),t&&t(!1)}},$.ajax(hash)},decline:function(e,t){hash={url:FA_Config_urlApi+"invitations/destroy",type:"POST",dataType:"JSON",data:{member_id:e},success:function(e){FA.Background.extensionBadge.updateState(),t&&t(!0)},error:function(e,o,n){console.error("PB.Sharing.accept error: "+JSON.stringify(e)),t&&t(!1)}},$.ajax(hash)},resend:function(e,t){t=t||function(){return!1},contact=FA.Background.contacts.get(e),hash={url:contact.url()+"/resend.json",success:function(){contact.fetch(),t&&t(!0)},error:function(e,o,n){console.error("PB.Sharing.accept error: "+JSON.stringify(e)),t&&t(!1)}},$.ajax(hash)},dont_count_on_me:function(e){FA.Background.contacts.find_by_member_id(e)},recryptSecrets:function(e){FA.Background.secrets.each(function(t){t.get("asset_id")==e.get("id")&&(contact=FA.Background.contacts.get(t.escape("contact_id")),contact&&contact.getSharedSecret()&&(null==e.getCPassword()||""==e.getCPassword()?cryptedKey="":cryptedKey=PB.crypto.AES.encrypt(e.getCPassword(),contact.getSharedSecret()),t.save({crypted_key:cryptedKey})))}),FA.Background.contacts.auto_bequeathing().each(function(t){FA.Background.secrets.getForContactAsset(t,e,!1)||PB.sharing.create_secret_for_asset({contact:t,asset:e,shared:!1},function(){})})},getPublicKey:function(e,t){hash={url:FA_Config_urlApi+"contacts/keys?q="+encodeURIComponent(e),success:function(e){t&&t(e)},error:function(e,o,n){t&&t(!1)}},$.ajax(hash)},initMigration:function(){migration=new Object,migration.steps=0,migration.progress=0},start_migration:function(e){PB.sharing.initMigration();var t=FA.Background.fa_member.get("salt");return"string"==typeof t&&t.length>0?(migration.steps=1,migration.progress=1,e(migration),!1):(migration.steps=5+FA.Background.contacts.length+2*FA.Background.assets.mine().length,migration.progress=0,e(migration),void PB.sharing.migrate(e))},migrate:function(e){var t=PB.crypto.SALT.generate(),o=PB.crypto.SALT.generate();derived=CryptoJS.PBKDF2(FA.Background.fa_cpassword,t,{keySize:16,iterations:1}).toString(),hash={url:FA_Config_urlApi+"derive.json",type:"POST",data:{salt:t,hash:derived},success:function(n){"object"!=typeof n&&(n=JSON.parse(n)),kek=CryptoJS.PBKDF2(n.derived+""+FA.Background.fa_cpassword,t,{keySize:16,iterations:1}).toString(),data={private_key:PB.crypto.AES.encrypt(JSON.stringify(FA.Background.fa_rsaKey.jsonPrivateKey),o),k_kek:PB.crypto.AES.encrypt(o,kek),salt:t},FA.Background.fa_member.key=o,FA.Background.fa_member.save(data,{success:function(){migration.progress+=5,e(migration);var t=FA.Background.contacts.length;0==t&&PB.sharing.migratePasswords(e),FA.Background.contacts.each(function(o){var n=PB.crypto.SALT.generate(),a=PB.crypto.AES.encrypt(n,FA.Background.fa_member.key);if(""!=o.get("public_key"))var r=PB.crypto.RSA.encrypt(n,o.get("public_key"));else var r="";o.save({secret_member_k:a,secret_contact_pub:r},{success:function(){migration.progress+=1,e(migration),t--,0==t&&PB.sharing.migratePasswords(e)},error:function(e,t,o){alert("Contact migration failed")}})})},error:function(e,t,o){alert("Account migration failed. ")}})}},$.ajax(hash)},migratePasswords:function(e,t){var o=FA.Background.fa_member.get("salt");return"string"!=typeof o||o.length<32?(e({steps:0,progress:0}),t(),!1):(assets=FA.Background.assets.mine(),assets.length>0?(PB.sharing.migratePassword(assets,e,t),!1):void t())},migratePassword:function(e,t,o){"undefined"==typeof migration&&PB.sharing.initMigration(),asset=e.pop(),asset.emptyPassword_k()&&!asset.emptyPassword()?(asset.cpassword=PB.crypto.RSA.decrypt(asset.get("password"),FA.Background.fa_rsaKey.jsonPrivateKey),asset.save({},{success:function(){migration.progress+=2,t(migration),e.length>0?PB.sharing.migratePassword(e,t,o):o&&o()}})):(migration.progress+=2,t(migration),e.length>0?PB.sharing.migratePassword(e,t,o):o&&o())}},PB="undefined"==typeof PB?{}:PB,PB.Callback=PB.Callback||{},PB.Callback.AssetSaveSuccess=function(e,t){FA.Background.assets.add(e),FA.Background.tempAssets&&FA.Background.tempAssets.remove(e),$(PB.SessionData.events).trigger("asset_saved")},function(e){function t(e,t){return function(o){return c(e.call(this,o),t)}}function o(e){return function(t){return this.lang().ordinal(e.call(this,t))}}function n(){}function a(e){i(this,e)}function r(e){var t=this._data={},o=e.years||e.year||e.y||0,n=e.months||e.month||e.M||0,a=e.weeks||e.week||e.w||0,r=e.days||e.day||e.d||0,i=e.hours||e.hour||e.h||0,c=e.minutes||e.minute||e.m||0,l=e.seconds||e.second||e.s||0,u=e.milliseconds||e.millisecond||e.ms||0;this._milliseconds=u+1e3*l+6e4*c+36e5*i,this._days=r+7*a,this._months=n+12*o,t.milliseconds=u%1e3,l+=s(u/1e3),t.seconds=l%60,c+=s(l/60),t.minutes=c%60,i+=s(c/60),t.hours=i%24,r+=s(i/24),r+=7*a,t.days=r%30,n+=s(r/30),t.months=n%12,o+=s(n/12),t.years=o}function i(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);return e}function s(e){return 0>e?Math.ceil(e):Math.floor(e)}function c(e,t){for(var o=e+"";o.length<t;)o="0"+o;return o}function l(e,t,o){var n,a=t._milliseconds,r=t._days,i=t._months;a&&e._d.setTime(+e+a*o),r&&e.date(e.date()+r*o),i&&(n=e.date(),e.date(1).month(e.month()+i*o).date(Math.min(n,e.daysInMonth())))}function u(e){return"[object Array]"===Object.prototype.toString.call(e)}function d(e,t){var o,n=Math.min(e.length,t.length),a=Math.abs(e.length-t.length),r=0;for(o=0;n>o;o++)~~e[o]!==~~t[o]&&r++;return r+a}function m(e,t){return t.abbr=e,E[e]||(E[e]=new n),E[e].set(t),E[e]}function g(e){return e?(!E[e]&&O&&require("./lang/"+e),E[e]):D.fn._lang}function p(e){return e.match(/\[.*\]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function f(e){var t,o,n=e.match(U);for(t=0,o=n.length;o>t;t++)ae[n[t]]?n[t]=ae[n[t]]:n[t]=p(n[t]);return function(a){var r="";for(t=0;o>t;t++)r+="function"==typeof n[t].call?n[t].call(a,e):n[t];return r}}function h(e,t){function o(t){return e.lang().longDateFormat(t)||t}for(var n=5;n--&&N.test(t);)t=t.replace(N,o);return te[t]||(te[t]=f(t)),te[t](e)}function _(e){switch(e){case"DDDD":return z;case"YYYY":return G;case"YYYYY":return W;case"S":case"SS":case"SSS":case"DDD":return q;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":case"a":case"A":return V;case"X":return K;case"Z":case"ZZ":return $;case"T":return J;case"MM":case"DD":case"YY":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":return j;default:return new RegExp(e.replace("\\",""))}}function v(e,t,o){var n,a=o._a;switch(e){case"M":case"MM":a[1]=null==t?0:~~t-1;break;case"MMM":case"MMMM":n=g(o._l).monthsParse(t),null!=n?a[1]=n:o._isValid=!1;break;case"D":case"DD":case"DDD":case"DDDD":null!=t&&(a[2]=~~t);break;case"YY":a[0]=~~t+(~~t>68?1900:2e3);break;case"YYYY":case"YYYYY":a[0]=~~t;break;case"a":case"A":o._isPm="pm"===(t+"").toLowerCase();break;case"H":case"HH":case"h":case"hh":a[3]=~~t;break;case"m":case"mm":a[4]=~~t;break;case"s":case"ss":a[5]=~~t;break;case"S":case"SS":case"SSS":a[6]=~~(1e3*("0."+t));break;case"X":o._d=new Date(1e3*parseFloat(t));break;case"Z":case"ZZ":o._useUTC=!0,n=(t+"").match(Z),n&&n[1]&&(o._tzh=~~n[1]),n&&n[2]&&(o._tzm=~~n[2]),n&&"+"===n[0]&&(o._tzh=-o._tzh,o._tzm=-o._tzm)}null==t&&(o._isValid=!1)}function b(e){var t,o,n=[];if(!e._d){for(t=0;7>t;t++)e._a[t]=n[t]=null==e._a[t]?2===t?1:0:e._a[t];n[3]+=e._tzh||0,n[4]+=e._tzm||0,o=new Date(0),e._useUTC?(o.setUTCFullYear(n[0],n[1],n[2]),o.setUTCHours(n[3],n[4],n[5],n[6])):(o.setFullYear(n[0],n[1],n[2]),o.setHours(n[3],n[4],n[5],n[6])),e._d=o}}function y(e){var t,o,n=e._f.match(U),a=e._i;for(e._a=[],t=0;t<n.length;t++)o=(_(n[t]).exec(a)||[])[0],o&&(a=a.slice(a.indexOf(o)+o.length)),ae[n[t]]&&v(n[t],o,e);e._isPm&&e._a[3]<12&&(e._a[3]+=12),e._isPm===!1&&12===e._a[3]&&(e._a[3]=0),b(e)}function k(e){for(var t,o,n,r,s=99;e._f.length;){if(t=i({},e),t._f=e._f.pop(),y(t),o=new a(t),o.isValid()){n=o;break}r=d(t._a,o.toArray()),s>r&&(s=r,n=o)}i(e,n)}function B(e){var t,o=e._i;if(H.exec(o)){for(e._f="YYYY-MM-DDT",t=0;4>t;t++)if(Q[t][1].exec(o)){e._f+=Q[t][0];break}$.exec(o)&&(e._f+=" Z"),y(e)}else e._d=new Date(o)}function w(t){var o=t._i,n=R.exec(o);o===e?t._d=new Date:n?t._d=new Date(+n[1]):"string"==typeof o?B(t):u(o)?(t._a=o.slice(0),b(t)):t._d=new Date(o instanceof Date?+o:o)}function A(e,t,o,n,a){return a.relativeTime(t||1,!!o,e,n)}function S(e,t,o){var n=M(Math.abs(e)/1e3),a=M(n/60),r=M(a/60),i=M(r/24),s=M(i/365),c=45>n&&["s",n]||1===a&&["m"]||45>a&&["mm",a]||1===r&&["h"]||22>r&&["hh",r]||1===i&&["d"]||25>=i&&["dd",i]||45>=i&&["M"]||345>i&&["MM",M(i/30)]||1===s&&["y"]||["yy",s];return c[2]=t,c[3]=e>0,c[4]=o,A.apply({},c)}function P(e,t,o){var n=o-t,a=o-e.day();return a>n&&(a-=7),n-7>a&&(a+=7),Math.ceil(D(e).add("d",a).dayOfYear()/7)}function F(e){var t=e._i,o=e._f;return null===t||""===t?null:("string"==typeof t&&(e._i=t=g().preparse(t)),D.isMoment(t)?(e=i({},t),e._d=new Date(+t._d)):o?u(o)?k(e):y(e):w(e),new a(e))}function x(e,t){D.fn[e]=D.fn[e+"s"]=function(e){var o=this._isUTC?"UTC":"";return null!=e?(this._d["set"+o+t](e),this):this._d["get"+o+t]()}}function C(e){D.duration.fn[e]=function(){return this._data[e]}}function I(e,t){D.duration.fn["as"+e]=function(){return+this/t}}for(var D,T,L="2.0.0",M=Math.round,E={},O="undefined"!=typeof module&&module.exports,R=/^\/?Date\((\-?\d+)/i,U=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|a|A|hh?|HH?|mm?|ss?|SS?S?|X|zz?|ZZ?|.)/g,N=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,j=/\d\d?/,q=/\d{1,3}/,z=/\d{3}/,G=/\d{1,4}/,W=/[+\-]?\d{1,6}/,V=/[0-9]*[a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF]+\s*?[\u0600-\u06FF]+/i,$=/Z|[\+\-]\d\d:?\d\d/i,J=/T/i,K=/[\+\-]?\d+(\.\d{1,3})?/,H=/^\s*\d{4}-\d\d-\d\d((T| )(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?/,Y="YYYY-MM-DDTHH:mm:ssZ",Q=[["HH:mm:ss.S",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],Z=/([\+\-]|\d\d)/gi,X="Month|Date|Hours|Minutes|Seconds|Milliseconds".split("|"),ee={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},te={},oe="DDD w W M D d".split(" "),ne="M D H h m s w W".split(" "),ae={M:function(){return this.month()+1},MMM:function(e){return this.lang().monthsShort(this,e)},MMMM:function(e){return this.lang().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.lang().weekdaysMin(this,e)},ddd:function(e){return this.lang().weekdaysShort(this,e)},dddd:function(e){return this.lang().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return c(this.year()%100,2)},YYYY:function(){return c(this.year(),4)},YYYYY:function(){return c(this.year(),5)},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return~~(this.milliseconds()/100)},SS:function(){return c(~~(this.milliseconds()/10),2)},SSS:function(){return c(this.milliseconds(),3)},Z:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+c(~~(e/60),2)+":"+c(~~e%60,2)},ZZ:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+c(~~(10*e/6),4)},X:function(){return this.unix()}};oe.length;)T=oe.pop(),ae[T+"o"]=o(ae[T]);for(;ne.length;)T=ne.pop(),ae[T+T]=t(ae[T],2);for(ae.DDDD=t(ae.DDD,3),n.prototype={set:function(e){var t,o;for(o in e)t=e[o],"function"==typeof t?this[o]=t:this["_"+o]=t},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(e){return this._months[e.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(e){var t,o,n;for(this._monthsParse||(this._monthsParse=[]),t=0;12>t;t++)if(this._monthsParse[t]||(o=D([2e3,t]),n="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[t]=new RegExp(n.replace(".",""),"i")),this._monthsParse[t].test(e))return t},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(e){return this._weekdays[e.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t},meridiem:function(e,t,o){return e>11?o?"pm":"PM":o?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[last] dddd [at] LT",sameElse:"L"},calendar:function(e,t){var o=this._calendar[e];return"function"==typeof o?o.apply(t):o},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,o,n){var a=this._relativeTime[o];return"function"==typeof a?a(e,t,o,n):a.replace(/%d/i,e)},pastFuture:function(e,t){var o=this._relativeTime[e>0?"future":"past"];return"function"==typeof o?o(t):o.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",preparse:function(e){return e},postformat:function(e){return e},week:function(e){return P(e,this._week.dow,this._week.doy)},_week:{dow:0,doy:6}},D=function(e,t,o){return F({_i:e,_f:t,_l:o,_isUTC:!1})},D.utc=function(e,t,o){return F({_useUTC:!0,_isUTC:!0,_l:o,_i:e,_f:t})},D.unix=function(e){return D(1e3*e)},D.duration=function(e,t){var o,n=D.isDuration(e),a="number"==typeof e,i=n?e._data:a?{}:e;return a&&(t?i[t]=e:i.milliseconds=e),o=new r(i),n&&e.hasOwnProperty("_lang")&&(o._lang=e._lang),o},D.version=L,D.defaultFormat=Y,D.lang=function(e,t){return e?(t?m(e,t):E[e]||g(e),void(D.duration.fn._lang=D.fn._lang=g(e))):D.fn._lang._abbr},D.langData=function(e){return e&&e._lang&&e._lang._abbr&&(e=e._lang._abbr),g(e)},D.isMoment=function(e){return e instanceof a},D.isDuration=function(e){return e instanceof r},D.fn=a.prototype={clone:function(){return D(this)},valueOf:function(){return+this._d},unix:function(){return Math.floor(+this._d/1e3)},toString:function(){return this.format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._d},toJSON:function(){return D.utc(this).format("YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds()]},isValid:function(){return null==this._isValid&&(this._a?this._isValid=!d(this._a,(this._isUTC?D.utc(this._a):D(this._a)).toArray()):this._isValid=!isNaN(this._d.getTime())),!!this._isValid},utc:function(){return this._isUTC=!0,this},local:function(){return this._isUTC=!1,this},format:function(e){var t=h(this,e||D.defaultFormat);return this.lang().postformat(t)},add:function(e,t){var o;return o="string"==typeof e?D.duration(+t,e):D.duration(e,t),l(this,o,1),this},subtract:function(e,t){var o;return o="string"==typeof e?D.duration(+t,e):D.duration(e,t),l(this,o,-1),this},diff:function(e,t,o){var n,a,r=this._isUTC?D(e).utc():D(e).local(),i=6e4*(this.zone()-r.zone());return t&&(t=t.replace(/s$/,"")),"year"===t||"month"===t?(n=432e5*(this.daysInMonth()+r.daysInMonth()),a=12*(this.year()-r.year())+(this.month()-r.month()),a+=(this-D(this).startOf("month")-(r-D(r).startOf("month")))/n,"year"===t&&(a/=12)):(n=this-r-i,a="second"===t?n/1e3:"minute"===t?n/6e4:"hour"===t?n/36e5:"day"===t?n/864e5:"week"===t?n/6048e5:n),o?a:s(a)},from:function(e,t){return D.duration(this.diff(e)).lang(this.lang()._abbr).humanize(!t)},fromNow:function(e){return this.from(D(),e)},calendar:function(){var e=this.diff(D().startOf("day"),"days",!0),t=-6>e?"sameElse":-1>e?"lastWeek":0>e?"lastDay":1>e?"sameDay":2>e?"nextDay":7>e?"nextWeek":"sameElse";return this.format(this.lang().calendar(t,this))},isLeapYear:function(){var e=this.year();return e%4===0&&e%100!==0||e%400===0},isDST:function(){return this.zone()<D([this.year()]).zone()||this.zone()<D([this.year(),5]).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null==e?t:this.add({d:e-t})},startOf:function(e){switch(e=e.replace(/s$/,"")){case"year":this.month(0);case"month":this.date(1);case"week":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.day(0),this},endOf:function(e){return this.startOf(e).add(e.replace(/s?$/,"s"),1).subtract("ms",1)},isAfter:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)>+D(e).startOf(t)},isBefore:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)<+D(e).startOf(t)},isSame:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)===+D(e).startOf(t)},zone:function(){return this._isUTC?0:this._d.getTimezoneOffset()},daysInMonth:function(){return D.utc([this.year(),this.month()+1,0]).date()},dayOfYear:function(e){var t=M((D(this).startOf("day")-D(this).startOf("year"))/864e5)+1;return null==e?t:this.add("d",e-t)},isoWeek:function(e){var t=P(this,1,4);return null==e?t:this.add("d",7*(e-t))},week:function(e){var t=this.lang().week(this);return null==e?t:this.add("d",7*(e-t))},lang:function(t){return t===e?this._lang:(this._lang=g(t),this)}},T=0;T<X.length;T++)x(X[T].toLowerCase().replace(/s$/,""),X[T]);x("year","FullYear"),D.fn.days=D.fn.day,D.fn.weeks=D.fn.week,D.fn.isoWeeks=D.fn.isoWeek,D.duration.fn=r.prototype={weeks:function(){return s(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+2592e6*this._months},humanize:function(e){var t=+this,o=S(t,!e,this.lang());return e&&(o=this.lang().pastFuture(t,o)),this.lang().postformat(o)},lang:D.fn.lang};for(T in ee)ee.hasOwnProperty(T)&&(I(T,ee[T]),C(T.toLowerCase()));I("Weeks",6048e5),D.lang("en",{ordinal:function(e){var t=e%10,o=1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+o}}),O&&(module.exports=D),"undefined"==typeof ender&&(this.moment=D),"function"==typeof define&&define.amd&&define("moment",[],function(){return D})}.call(this),PB="undefined"==typeof PB?{}:PB,PB.PasswordImporter={getFiltered:function(e){function t(t){var o=PB.PasswordImporter.filter(PB.PasswordImporter.trim(t));e&&e.success&&e.success(o)}function o(){e&&e.error&&e.error()}function n(){e&&e.complete&&e.complete()}this.getAll({success:t,error:o,complete:n})},getAll:function(e){PB.MemoryMap.readImportedPasswords(e)},trim:function(e){var t=[];if(!(e&&"length"in e&&e.length))return t;for(var o=0;o<e.length;++o){var n=e[o],a=n.Url;if(a){var r=n.user;if(r){var i=n.password;if(i){for(var s=!1,c=0;c<t.length;++c){var l=t[c];if(n.Url==l.Url&&r==l.user&&i==l.password){s=!0;break}}s||t.push(n)}}}}return t},filter:function(e){var t=[],o={};if(!(e&&"length"in e&&e.length))return t;for(var n=0;n<e.length;++n){var a=e[n],r=PB.Utility.parseUrl(a.Url);if(r){var i=r.host;i in o||(o[i]=0),o[i]>=PB.Config.IMPORT_MAX_PER_DOMAIN||(++o[i],t.push({url:r,username:a.user,password:a.password}))}}return t},fetchAll:function(e){PB.MemoryMap.readImportedPasswords({success:function(t){PB.PasswordImporter.saveAll(t,e)},error:function(){"function"==typeof e&&e(!1)}})},saveAll:function(e,t){function o(e,t,o){FA.Background.assets.add(e),++i,a()}function n(e,t,o){a()}function a(){++r,console.log("processedCount",r),r<e.length||(console.log("Complete: "+i+" / "+r),PB.MemoryMap.wipeImportedPasswords(),"function"==typeof t&&t(i))}e&&"object"==typeof e&&e.length||(e=[]);var r=0,i=0;console.log("Retrieved "+e.length+" credentials"),e=PB.PasswordImporter.trim(e),console.log("Trimmed to "+e.length+" credentials"),e=PB.PasswordImporter.filter(e),console.log("Filtered to "+e.length+" credentials");for(var s=0;s<e.length;++s){var c=e[s],l=new FA.Models.Asset;l.cpassword=c.password;var u={name:c.Url,login:c.user,url:c.Url,details:"",type:"other"};l.save(u,{success:o,error:n})}}},PB.experiments={AVG:{variation1:{props:{blockWidget:!0,neverSignedUpVariation:"neverSignedUp3",blockContextNeverSignedUp:!0},tracking:{avg_experiment_variation:1,widget:!1,engagement_count:1,engagement_step:"after_sign_in",topbar_color:"black",in_page_style:"topbar",after_sign_in_in_page_opt_out_variation:"never_for_this_site"}},variation2:{props:{blockWidget:!0,neverSignedUpVariation:"none"},tracking:{avg_experiment_variation:2,widget:!1,engagement_count:1,engagement_step:"before_sign_in",in_page_style:"tooltip"}},variation3:{props:{blockWidget:!0,avgAdded:!0,neverSignedUpVariation:"neverSignedUp3",blockContextNeverSignedUp:!0},tracking:{avg_experiment_variation:3,widget:!1,engagement_count:2,engagement_step:"after_install_and_after_sign_in",topbar_color:"black",in_page_style:"topbar",after_sign_in_in_page_opt_out_variation:"never_for_this_site"}},variation4:{props:{blockWidget:!0,neverSignedUpVariation:"tabNeverSignedUp",blockContextNeverSignedUp:!0},tracking:{avg_experiment_variation:4,widget:!1,engagement_count:1,engagement_step:"after_sign_in",in_page_style:"sidebar",after_sign_in_in_page_opt_out_variation:"never_again"}},variation5:{props:{blockWidget:!0,neverSignedUpVariation:"neverSignedUp2",blockContextNeverSignedUp:!0},tracking:{avg_experiment_variation:5,widget:!1,engagement_count:1,engagement_step:"after_sign_in",topbar_color:"green",in_page_style:"topbar",after_sign_in_in_page_opt_out_variation:"never_again"}},variation6:{props:{avgAdded:!0,neverSignedUpVariation:"none",blockContextNeverSignedUp:!0},tracking:{avg_experiment_variation:6,widget:!0,engagement_count:1,engagement_step:"after_install",topbar_color:"black",in_page_style:"topbar"}},variation7:{props:{avgAdded:!0,neverSignedUpVariation:"none",blockContextNeverSignedUp:!0},tracking:{avg_experiment_variation:7,widget:!0,engagement_count:2,engagement_step:"after_install_and_before_sign_in",topbar_color:"black",in_page_style:["topbar","tooltip"]}},variation8:{props:{avgAdded:!1,neverSignedUpVariation:"overlayNeverSignedUp2",blockContextNeverSignedUp:!0},tracking:{avg_experiment_variation:8,widget:!0,engagement_count:1,engagement_step:"“after_sign_in”",topbar_color:"black",in_page_style:"box",after_sign_in_in_page_opt_out_variation:"never_for_this_site"}},variation9:{props:{avgAdded:!1,neverSignedUpVariation:"none",blockContextNeverSignedUp:!0},tracking:{avg_experiment_variation:9,widget:!0,engagement_count:1,engagement_step:"after_sign_in",in_page_style:"overlay"}},variation10:{props:{avgAdded:!1,neverSignedUpVariation:"overlayNeverSignedUp",blockContextNeverSignedUp:!0},tracking:{avg_experiment_variation:10,widget:!0,engagement_count:1,engagement_step:"before_sign_in",in_page_style:"overlay"}}}},PB="undefined"==typeof PB?{}:PB,PB.MemoryMap={get:function(){throw new Error("PB.MemoryMap.get() is not implemented.")},set:function(){throw new Error("PB.MemoryMap.set() is not implemented.")},getMacAddress:function(){throw new Error("PB.MemoryMap.getUID() is not implemented.")},readImportedPasswords:function(){throw new Error("PB.MemoryMap.readImportedPasswords() is not implemented.")},wipeImportedPasswords:function(){throw new Error("PB.MemoryMap.wipeImportedPasswords() is not implemented.")}},PB.MemoryMap={_prop_prefix:"_prop_",_sendCommand:function(e,t){var o=t||{};if(!e)throw"PB.MemoryMap._sendCommand() requires at least the command parameter.";$.ajax({type:"GET",url:PB.Config.URL_LOCAL_HTTP_SERVER+PB.settings.uuid.get()+"/"+e,cache:!1,dataType:"text",success:o.success,error:o.error})},isAvailable:function(e){function t(t,o,n){localStorage.removeItem("disable_memorymap"),e&&e(!0)}function o(t,o,n){if(e){var a="timeout"==o;a||localStorage.setItem("disable_memorymap",1),e(a)}}return PB.Config.IS_MAC?void o():void this._sendCommand("getp/ping",{success:t,error:o})},get:function(e,t){function o(e,o,n){var a=e||"";t&&(t.success&&t.success(a),t.complete&&t.complete())}function n(o,n,a){"error"==n&&localStorage.setItem("disable_memorymap",1);var r=localStorage.getItem(e);if(t){if(t.retry&&t.retry>0)return--t.retry,void this.get(e,t);t.success&&t.success(r,!0),t.complete&&t.complete(!0)}}return localStorage.getItem("disable_memorymap")?void n():void this._sendCommand("getp/"+e,{
success:o,error:n})},set:function(e,t,o){function n(e,t,n){var a=e||"";o&&(o.success&&o.success(a),o.complete&&o.complete())}function a(n,a,r){return"error"==a&&localStorage.setItem("disable_memorymap",1),o&&o.retry&&o.retry>0?(--o.retry,void this.set(e,o)):(localStorage.setItem(e,t),void(o&&(o.success&&o.success(!0),o.complete&&o.complete(!0))))}return localStorage.getItem("disable_memorymap")?void a():void this._sendCommand("setp/"+e+":"+t,{success:n,error:a})},getMachineKey:function(e,t){function o(e,o,n){var a=e||"";t&&(t.success&&t.success(a),t.complete&&t.complete())}function n(o,n,a){"error"==n&&localStorage.setItem("disable_memorymap",1);var r=localStorage.getItem(this._prop_prefix+e);t&&(t.success&&t.success(r,!0),t.complete&&t.complete(!0))}return localStorage.getItem("disable_memorymap")?void n():void this._sendCommand("prop/"+e,{success:o,error:n})},getMacAddress:function(e){this.getMachineKey("uid")},readImportedPasswords:function(e){function t(t,o,n){if(e){if(e.success){var a={},r=t||"{}";try{a=JSON.parse(r)}catch(i){console.error("Error parsing imported credentials: "+i.message),PB.MemoryMap.wipeImportedPasswords()}e.success&&e.success(a.logins)}e.complete&&e.complete()}}function o(t,o,n){e&&(e.error&&e.error(),e.complete&&e.complete())}return localStorage.getItem("disable_memorymap")?void o():void this._sendCommand("get_pwfile",{success:t,error:o})},wipeImportedPasswords:function(e){function t(t,o,n){var a=t||"";e&&(e.success&&e.success(a),e.complete&&e.complete())}function o(t,o,n){e&&(e.error&&e.error(),e.complete&&e.complete())}return localStorage.getItem("disable_memorymap")?void o():void this._sendCommand("del_pwfile",{success:t,error:o})}},PB="undefined"==typeof PB?{}:PB,PB.Public=PB.Public||{},PB.Public._executeCallback=function(e,t){try{e&&e(t)}catch(o){console.error("[PB.Public._executeCallback] Cannot execute callback")}},PB.Public.importPasswords=function(e){function t(e){var t={data:e,bypassError:!0};PB.asset.create(t,o)}function o(e){e.error||0!=a.length||PB.mixpanel.track_activity("create_password",{number_of_passwords_created:n.length,password_creation_type:"password_importer"})}PB.Utility.isFunction(e)||(e=PB.Utility.emptyFunc),PB.SessionData.importedPasswords&&PB.SessionData.importedPasswords.length||e(new PB.CallbackResponse.createError("no_import"));var n=PB.SessionData.importedPasswords;PB.SessionData.importTotal=n.length,PB.SessionData.importedPasswords=null;for(var a=[],r=0;r<n.length;++r){var i=n[r];a.push({url:i.url.url,name:i.url.host,username:i.username,password:i.password})}for(;a.length;)t(a.splice(0,100));PB.MemoryMap.wipeImportedPasswords(),e()},PB.Public.cancelPasswordImport=function(e){PB.mixpanel.track_activity("import_password_declined"),PB.SessionData.importedPasswords=null,PB.MemoryMap.wipeImportedPasswords()},PB.Public.getAllNonConfirmedSharedAssets=function(){return _.sortBy(FA.Background.assets.getAllNonConfirmed(),function(e){return e.get("member_id")})},PB.Public.confirmAllSharedAssets=function(e){var t=FA.Background.assets.getAllNonConfirmed();FA.Background.confirm_assets(t,e)},PB.Public.confirm_shared_assets_by_member_id=function(e,t){var o=FA.Background.assets.get_all_non_confirmed_by_member_id(e);FA.Background.confirm_assets(o,t)},PB.Public.getUrl=function(e,t){$.ajax({url:e,success:function(e){t(e)},error:function(){console.error("Request failed:",e),t(null)}})},PB.Public.saveMemberSettings=function(e,t){var o=FA.Background.fa_member;return o?void o.save({settings:e},{success:function(){t(!0)},error:function(e,o,n){t(!1)}}):t(!1)};var metaUtils={getPathForFile:function(e){e=e||"";var t=new AxShell,o=t.ExpandEnvironmentStrings("%localappdata%"),n=o+"\\Passwordbox\\"+e;return n},loadFile:function(e){var t;try{var o=new AxFileSystemObject,n=metaUtils.getPathForFile(e);if(!o.FileExists(n))return null;t=o.OpenTextFile(n,1,!0,-1);var a=t.ReadAll();return t.Close(),a}catch(r){t&&t.Close(),console.error("Failed to load file",r)}return null},saveFile:function(e,t){var o;try{var n=new AxFileSystemObject,a=metaUtils.getPathForFile();n.FolderExists(a)||n.CreateFolder(a);var r=a+e,o=n.OpenTextFile(r,2,!0,-1);o.Write(t),o.Close()}catch(i){o&&o.Close(),console.error("Failed to save file",i)}}};PB.Public.setMetaCache=function(e){"desktop-extension-ie"===PB.config.target?(console.log("setMetaCache ie"),metaUtils.saveFile("meta.cache",e)):(console.log("setMetaCache non-ie"),localStorage.setItem("meta",e)),PB.SessionData.metaCache=e},PB.Public.getMetaCache=function(){return PB.SessionData.metaCache||("desktop-extension-ie"===PB.config.target?(console.log("getMetaCache ie g"),PB.SessionData.metaCache=metaUtils.loadFile("meta.cache")):(console.log("getMetaCache non-ie g"),PB.SessionData.metaCache=localStorage.getItem("meta"))),console.log("getMetaCache returned cache: "+!!PB.SessionData.metaCache),PB.SessionData.metaCache},PB.Public.isPasswordValid=function(e,t){function o(e){var o={status:0,message:"Password validity computed",output:e==FA.Background.fa_cpassword};return PB.Public._executeCallback(t,o)}if(!e||"object"!=typeof e)return PB.Public._executeCallback(t,{status:1,message:"Invalid argument 0; Expected object type"});if(!e.password)return PB.Public._executeCallback(t,{status:2,message:"Parameter 'password' is required"});var n=e.password;if(!FA.Background.fa_member||"object"!=typeof FA.Background.fa_member)return PB.Public._executeCallback(t,{status:3,message:"Cannot find retrieve member information"});var a=FA.Background.fa_member.get("email");PB.Authentication.settings.legacyAuth(a).isActive?PB.Crypto.SHA1({string:n},o):PB.Worker.spawnCrypto({fn:"Crypto.computeDerivedPassword",params:{password:n,email:a}},o)},PB.Public.registerAutoLogin=function(e){PB.AutoLogin.queue({assetId:e.i_id})},PB.Public.autoLoginQueue=function(e){PB.AutoLogin.queue({assetId:e.assetId})},PB.Public.loadRewards=function(e,t){PB.reward.getAll({},function(e){var o={status:0,message:"Rewards fetched"};e.error?o={status:1,message:"Error retrieving rewards"}:o.data=e.data,t&&t(o)})},PB.Public.sendEvent=function(e,t){"object"!=typeof e&&(e={});var o={name:e.name};PB.reward.signalEvent(o,function(e){var o={status:0,message:"Reward signal sent"};e.error?o={status:1,message:"Error sending reward signal"}:o.data=e.data,t&&t(o)})},PB="undefined"==typeof PB?{}:PB,PB.AutoLoginTimeout={_panel_interval:void 0,_timerCallback:function(){return 0==PB.settings.autoLoginTimeoutInterval.get()?!1:(PB.settings.profile.reset(),PB.settings.key.reset(),void FA.Background.doLogout(function(){"desktop-extension-firefox"==PB.config.target&&FA.logout()}))},check:function(e){var t=e||{},o=PB.settings.autoLoginTimeoutInterval.get(),n=PB.settings.lastActiveTimestamp.get(),a=Math.round(+new Date/1e3),r=n+o>a;!o||r?("undefined"==typeof PB.AutoLoginTimeout.timer&&PB.AutoLoginTimeout.reset_timer(),t.valid&&t.valid()):t.invalid&&t.invalid(),t.complete&&t.complete()},reset_timer:function(){clearTimeout(PB.AutoLoginTimeout.timer),PB.settings.lastActiveTimestamp.reset(),PB.AutoLoginTimeout.timer=setTimeout(function(){PB.AutoLoginTimeout._timerCallback()},1e3*PB.settings.autoLoginTimeoutInterval.get())},prevent_autologout:function(){clearInterval(PB.AutoLoginTimeout._panel_interval),PB.AutoLoginTimeout._panel_interval=setInterval(function(){PB.AutoLoginTimeout.reset_timer()},1e3*PB.Config.INTERVAL_AUTOLOGOUT_PING),PB.AutoLoginTimeout.reset_timer()},stop_panel_interval:function(){clearInterval(PB.AutoLoginTimeout._panel_interval)}},PB="undefined"==typeof PB?{}:PB,PB.Authentication=function(){var e={},t={isAuthenticated:!1,isProcessing:!1,isOnline:!1,hasCollections:!1};return e._private=t,e.isAuthenticated=function(){return t.isAuthenticated},e.isProcessing=function(){return t.isProcessing},e.isOnline=function(){return t.isOnline},e.hasCollections=function(){return t.hasCollections},e.settings={legacyAuth:function(e){var t=localStorage.getItem("legacyData");return t?t=JSON.parse(t):(localStorage.setItem("legacyData","{}"),t={}),"object"==typeof t&&t||(t={}),activate=function(){t[e.toLowerCase()]=!0,localStorage.setItem("legacyData",JSON.stringify(t))},disactivate=function(){t[e.toLowerCase()]=!1,localStorage.setItem("legacyData",JSON.stringify(t))},isActive=function(){return t[e]||!1},toggle=function(){isActive()?disactivate():activate()},clearIt=function(){delete t[e.toLowerCase()],localStorage.setItem("legacyData",JSON.stringify(t))},{isActive:isActive(),disactivate:disactivate,activate:activate,toggle:toggle,clearIt:clearIt}},derivationRules:new function(){var e;return get=function(){return e=FA.Background.fa_member?JSON.parse(FA.Background.fa_member.get("dr"))||{}:{client_iterations:PB.Config.DERIVATION_FIRST_ITERATION_COUNT,iterations:PB.Config.DERIVATION_SECOND_ITERATION_COUNT,algo:"sha256"}},{get:get}}},e.generateCryptedMP=function(e,t){function o(e){t(e)}var n=FA.Background.fa_member.get("email");PB.Worker.spawnCrypto({fn:"Crypto.computeDerivedPassword",params:{password:e,email:n}},o)},e.generateKek=function(t,o){var n,a=e.settings.derivationRules.get(),r=a.iterations||1,n=a.client_iterations||0,i=sjcl.codec.hex.fromBits(sjcl.misc.pbkdf2(o,sjcl.codec.utf8String.toBits(t),1,512,sjcl.misc.hmac,sjcl.hash.sha1));n>0&&(i=sjcl.codec.hex.fromBits(sjcl.misc.pbkdf2(i,sjcl.codec.utf8String.toBits(t),n,512,sjcl.misc.hmac,sjcl.hash.sha256))),i=sjcl.codec.hex.fromBits(sjcl.misc.pbkdf2(i,sjcl.codec.utf8String.toBits(t),r,256,sjcl.misc.hmac,sjcl.hash.sha256));var s=sjcl.codec.hex.fromBits(sjcl.misc.pbkdf2(i+""+o,sjcl.codec.utf8String.toBits(t),1,512,void 0,sjcl.hash.sha1));return s},e.generateRSA=function(){PB.member.initRsaKeys().then(function(){FA.Background.fa_member.hasRSAKeys=!0,"desktop-extension-firefox"==PB.config.target&&FA.resync()})},e.register=function(e,o){function n(t){r=t,PB.Worker.spawnCrypto({fn:"Crypto.computeDerivedPassword",params:{password:e.cpassword,email:e.email}},a)}function a(n){i=n;var a="{}";try{"object"==typeof AB&&(a=JSON.stringify(AB))}catch(l){console.error("Error parsing identity")}var u={source:e.source,member:{name:e.name,email:e.email,password:i,password_confirmation:i,derivation_attributes:{rules:PB.Config.REGISTER_RULES},wizard_step:99,k_kek:PB.crypto.AES.encrypt(c,r),salt:s,cpassword:e.cpassword,key:c,cohort:a}},d=(u.member.cpassword,u.member.key);delete u.member.cpassword,delete u.member.key,"desktop-extension-firefox"==PB.config.target&&FA.resync();var m=function(e){var t=!0;for(var o in e)return!1;return t};if(PB.user_activity.obj&&!m(PB.user_activity.obj)){var g=Math.floor(1e12*Math.random());_.extend(AB,{distinct_id:g,mixpanel:{pb_id:g}}),identityManager.sync();try{mixpanel.identify(g)}catch(p){}}u.member.cohort=JSON.stringify(AB),AB.distinct_id&&mixpanel.identify(AB.distinct_id);var f={url:FA_Config_urlApi+"members.json",type:"POST",data:{target:PB.config.target,member:u.member,p:AB.p},success:function(e){FA.Background.fa_member=new FA.Models.Member(e),FA.Background.fa_member.key=d;var n={source:"extension"};u.source&&(n={source:u.source,context:u.source,target:u.source}),PB.mixpanel.track_activity("signup",n),PB.mixpanel.track("log_in",n),"object"!=typeof e&&(e=JSON.parse(e)),e&&"string"!=typeof e&&e.id?(FA.Background.setCredentials(e.email,u.member.password,e.id,e.fullname,FA.Background.fa_rsaKey),FA.Background.setProfilePicture(),FA.Background.fa_member=new FA.Models.Member(e),localStorage.setItem("fa_csrf",e.csrf),FA.Background.fa_member.key=d,FA.Background.assetsLoaded=!0,t.isOnline=!0,t.isAuthenticated=!0,t.isProcessing=!1,t.hasCollections=!0,PB.Authentication.generateRSA(),FA.Background.extensionBadge.setState({state:"on"}),"desktop-extension-firefox"!=PB.config.target?$(document).trigger("collectionsLoaded"):FA.documentTrigger("collectionsLoaded"),"undefined"!=typeof PB.user_activity&&PB.user_activity.update_user(u.member.email),PB.Config.IS_LITE||PB.settings.rememberPassword.activate(!0),PB.settings.rememberEmail.activate(),PB.settings.skipIntro.activate(),PB.Worker.spawnCrypto({fn:"Crypto.computeLocalDataKey",params:{base:i,salt:s}},function(e){PB.SessionData.localStorageKey=e,PB.LocalData.save()}),o&&o(!0)):("desktop-extension-chrome"!=PB.config.target&&FA.Background.setIcon("build/images/ext/warn.png"),FA.Background.setCredentials(null,null,null,null,null),PB.settings.skipIntro.activate(),t.isOnline=!1,t.isAuthenticated=!1,t.isProcessing=!1,o&&o(!1))},error:function(e,n,a){console.error("Failed to register: "+JSON.stringify(e)),t.isOnline=!1,t.isAuthenticated=!1,t.isProcessing=!1,o&&o(!1)}};setTimeout(function(){$.ajax(f)},1e3)}if(t.isOnline=!1,t.isAuthenticated=!1,t.isProcessing=!0,!e.email)throw{message:"Parameter email is required"};if(!e.cpassword)throw{message:"Parameter cpassword is required"};if("string"!=typeof e.email)throw{message:"Parameter email must be a string"};e.email=e.email.trim().toLowerCase();var r,i,s=PB.crypto.SALT.generate(),c=PB.crypto.SALT.generate();PB.Worker.spawnCrypto({fn:"Crypto.computeKey",params:{salt:s,password:e.cpassword,rules:PB.Config.REGISTER_RULES}},n)},e.login=function(o,n,a,r,i){function s(e){y=e,PB.API.isDown()&&l(),$.ajax({PB:o._PB,url:FA_Config_urlApi+"api_login.json",type:"POST",data:{target:PB.config.target,member:{email:o.email,password:e}},success:u,error:c})}function c(t,s,c){var u={};try{u=JSON.parse(t.responseText)}catch(d){console.error("Error parsing authentication failure response")}if("incorrect_auth_scheme_possibility"===u.error_code){if(!(r||PB.API.isDown()||i))return PB.Authentication.settings.legacyAuth(o.email).toggle(),e.login(o,n,a,!0),!1;r&&PB.Authentication.settings.legacyAuth(o.email).toggle()}var m=o.source||"extension",g=o.login_context||"extension",p={source:m,context:m,target:m,login_context:g,login_successful:!1};return PB.mixpanel.track("attempted_log_in",p),t&&403===t.status?void(n&&n(!1)):void l()}function l(){function e(e){if(r=e,!r){try{PB.mixpanel.track("debugging",{method:"afterLocalDataLoad-error1"})}catch(t){}return void g()}try{r=JSON.parse(r)}catch(o){return console.error("Error parsing local data",o),localStorage.removeItem(field),void g()}PB.Worker.spawnCrypto({fn:"Crypto.computeLocalDataKey",params:{base:y,salt:r.salt}},n)}function n(e){PB.SessionData.localStorageKey=e;try{var t=PB.LocalData.aesDecryptFunctionName||"Crypto.AES.decrypt";PB.Worker.spawnCrypto({fn:t,params:{cipher:r.data,passphrase:e}},a)}catch(o){console.error("Error decrypting local data",o),localStorage.removeItem(field),g()}}function a(e){function n(o){try{f(b,o)}catch(n){return console.error("Error initializing member",n),PB.mixpanel.track("crypto_error",{context:"offline",stack:n.stack,dr:FA.Background.fa_member.get("dr")}),g()}FA.Background.assets=new FA.Collections.Assets(e.collections.assets),FA.Background.documents=new FA.Collections.Documents(e.collections.documents),FA.Background.blockedItems=new FA.Collections.BlockedItems(e.collections.blockedItems),FA.Background.secrets=new FA.Collections.Secrets(e.collections.secrets),FA.Background.contacts=new FA.Collections.Contacts(e.collections.contacts),FA.Background.assetsLoaded=!0,t.hasCollections=!0,m()}if(!e||"{"!==e.charAt(0)||"}"!==e.charAt(e.length-1))return void g();try{e=JSON.parse(e)}catch(a){return console.error("Error parsing user data",a),localStorage.removeItem(field),void g()}try{b=JSON.parse(e.member)}catch(a){return console.error("Error parsing member data",a),localStorage.removeItem(field),void g()}var r;try{r=JSON.parse(b.dr)}catch(a){return console.error("Error parsing derivation rules",a),g()}FA.Background.member_key?n(FA.Background.member_key):PB.Crypto.computeKey({password:o.cpassword,salt:b.salt,rules:r,encryptedKey:b.k_kek},n)}PB.LocalData.read({email:o.email},e);var r}function u(e,n,r){function i(e,t){if(t.status)return console.error(t.message),g();var o=PB.crypto.AES.decrypt(b.k_kek,e);s(o)}function s(e){try{f(b,e)}catch(t){return PB.mixpanel.track("crypto_error",{context:"online",stack:t.stack,dr:FA.Background.fa_member.get("dr")}),console.error("Error initializing member",t),g()}PB.SessionData.member_data=JSON.stringify(b),b.ttl>=60&&(PB.Config.INTERVAL_COLLECTION_REFRESH=b.ttl),FA.Background.save_inpage_assets(o.token,function(){o._PB.skipInitCollections?p(!0):FA.Background.initCollections(d)})}if(t.isOnline=!0,t.isAuthenticated=!0,"string"==typeof e)try{e=JSON.parse(e)}catch(c){return console.error("Error parsing response",c),void g()}if(PB.settings.csrfToken.set(e.csrf),"object"!=typeof e)return console.error("Invalid response",e),void g();if(b=e,!b.salt||b.salt.length<32)try{v(b,a)}catch(c){console.error("Error handling legacy user",c),g()}else{var l;try{l=JSON.parse(b.dr)}catch(c){console.error("Error parsing derivation rules",c),g()}FA.Background.member_key?s(FA.Background.member_key):PB.Worker.spawnCrypto({fn:"Crypto.computeKey",params:{password:o.cpassword,salt:b.salt,rules:l}},i)}}function d(e){return e?(t.hasCollections=!0,FA.Background.tempAssets.each(function(e){var t=!1;FA.Background.assets.getForDomain(e.get("url")).each(function(o){t||(e.get("login")==o.get("login")&&e.get("cpassword")==o.getCPassword()?(FA.Background.tempAssets.remove(e),t=!0):e.get("login")==o.get("login")&&o.get("member_id")==FA.Background.fa_member_id&&(e.attributes.asset_id=o.escape("id")))})}),FA.Background.tempAssets.each(function(e){FA.Background._saveAsset(e.cid)}),PB.Worker.spawnCrypto({fn:"Crypto.computeLocalDataKey",params:{base:y,salt:b.salt}},function(e){PB.SessionData.localStorageKey=e,PB.LocalData.save()}),PB.settings.skipIntro.activate(),void m()):(console.error("Error loading collection"),void g())}function m(){PB.SessionData.member={email:o.email,derived_password:y},t.isAuthenticated=!0,FA.Background.extensionBadge.updateState(),p(!0)}function g(e,n,a){try{PB.mixpanel.track("debugging",{method:"onLoginError"})}catch(r){}console.error("Authentication error"),t.isOnline=!1,o._PB.skipOldUserDiscard||(t.isAuthenticated=!1,t.hasCollections=!1,FA.Background.resetCollections(),FA.Background.clearSession()),p(!1)}function p(e){h(e),t.isProcessing=!1,n&&n(e)}function f(t,n){FA.Background.fa_member=new FA.Models.Member(t),FA.Background.fa_member.key=n,FA.Background.member_key=n;var a=null;if(t.public_key&&t.private_key){var r=JSON.parse(t.public_key),i=PB.crypto.AES.decrypt(t.private_key,n);i=JSON.parse(i),a={jsonPublicKey:r,jsonPrivateKey:i},FA.Background.fa_member.hasRSAKeys=!0}else e.generateRSA();FA.Background.setCredentials(o.email,y,t.id,t.fullname,a),FA.Background.setProfilePicture(),FA.Background.setExperiment(o.email),localStorage.setItem("fa_csrf",t.csrf)}function h(){var e;try{e=JSON.parse(b.cohort)}catch(t){return void console.error("Error parsing cohort data",t)}var n=e.distinct_id,a=AB.distinct_id;if(AB={},e&&e.distinct_id?(_.each(e,function(e,t){AB[t]=e}),AB.distinct_id=e.distinct_id,AB.mixpanel=e.mixpanel,AB.app_version=FA_version,AB.signup_date=e.signup_date,AB.p=e.p,identityManager.sync()):console.warn("Cannot track",e),!o.isRememberMe){var r=o.source||"extension",i=o.login_context||"extension",s={source:r,context:r,target:r,login_successful:!0,login_context:i,core_login_legacy_auth:PB.Authentication.settings.legacyAuth(o.email).isActive};PB.mixpanel.track("attempted_log_in",s),_.extend(s,{settings_auto_lock_duration:PB.settings.autoLoginTimeoutInterval.get_formatted()}),PB.mixpanel.track("im_alive",s);var c=localStorage.getItem("rewarded_users"),l=[];c&&(l=JSON.parse(c)),(l&&!_.contains(l,FA.Background.fa_member.get("email"))||null===c)&&(PB.reward.signalEvent({name:"login_on_desktop"},function(e){PB.mixpanel.track("completed_reward_task",{rewards_passwords_earned:FA.Background.fa_member.get("awarded_allowance"),rewards_earned:localStorage.getItem("completedRewards"),intent_name:"login_on_desktop",reward_password_count:e.data.adjustment_value})}),null===l&&(l=[]),l.push(FA.Background.fa_member.get("email")),localStorage.setItem("rewarded_users",JSON.stringify(l)))}a!=n&&PB.mixpanel.track("id_switched",{from_distinct_id:a,to_distinct_id:n})}function v(e,n){function a(e){return e?(n&&n(),t.hasCollections=!0,void p(e)):(console.error("Error loading collection"),void g())}try{PB.mixpanel.track("debugging",{method:"handleLegacyLogin",hasSalt:null!=b.salt,saltLength:b.salt.length})}catch(r){}var i={jsonPublicKey:JSON.parse(e.public_key),jsonPrivateKey:JSON.parse(PB.crypto.AES.decrypt(e.private_key,o.cpassword))};FA.Background.setCredentials(o.email,$.sha1(o.cpassword),e.id,e.fullname,i),FA.Background.setProfilePicture(),localStorage.setItem("fa_csrf",e.csrf),FA.Background.initCollections(a)}o="object"==typeof o?o||{}:{},o._PB=o._PB||{};var b={};o&&"object"==typeof o&&(o.email||o.cpassword)||(o=o||{},i=!0,PB.SessionData.member&&(o.email=PB.SessionData.member.email,o.cpassword=PB.SessionData.member.derived_password)),o._PB.skipOldUserDiscard||(FA.Background.resetCollections(),t.hasCollections=!1,t.isAuthenticated=!1,t.isOnline=!1),t.isProcessing=!0;var y=o.cpassword;return i?void s(y):PB.Authentication.settings.legacyAuth(o.email).isActive?void s($.sha1(y)):void PB.Worker.spawnCrypto({fn:"Crypto.computeDerivedPassword",params:{password:y,email:o.email}},s)},e.logout=function(){t.isAuthenticated=!1,t.isOnline=!1,t.hasCollections=!1,PB.Worker.terminateAll(),PB.mixpanel.track("im_alive",{settings_auto_lock_duration:PB.settings.autoLoginTimeoutInterval.get_formatted()})},e}(),PB.connection={down:{listeners:[],notify:function(){for(var e=PB.connection.down.listeners,t=[],o=0;o<e.length;++o)try{e[o]()}catch(n){console.warn("[PB.connection] Listener #"+o+" is dead. Queuing for removal"),t.push(o)}if(t.length>0)for(var o=t.length-1;o>=0;--o)this.listeners.splice(t[o],1)},addListener:function(e){PB.connection.down.listeners.push(e)},test:function(e){$.ajax({type:"get",url:FA_Config_urlApi,timeout:7e3,success:function(t,o,n){"success"in e&&e.success(t,o,n)},error:function(t,o,n){"error"in e&&e.success(t,o,n)}})}}},PB="undefined"==typeof PB?{}:PB,PB.API=function(){function e(e,t){if(!e)throw"Parameter 'name' is required.";return r[e]||(r[e]=[]),r[e].push([t,arguments.callee.caller])}function t(e,t){if(!e)throw"Parameter 'name' is required.";if(r[e])for(var o=0;o<r[e].length;++o){var n=r[e][o][0];n==t&&(r[e]=r[e].splice(o,1))}}function o(e){if(!e)throw"Parameter 'name' is required.";var t=[];if(r[e]){for(var o=0;o<r[e].length;++o){var n=r[e][o],a=n[0],i=n[1];try{a.apply(i,arguments)}catch(s){t.push(o)}}for(;t.length;)console.log("Removing PB.API.down listener #"+o),danglingListenerId=t.pop(),r[e]=r[e].splice(o,1)}}function n(e){if(!e)throw"Parameter 'name' is required.";r[e]=[]}var a={},r={},i=!1;return a.isDown=function(){return i},a.onDown={addListener:function(t){return e("down",t)},removeListener:function(e){return t("down",e)},notifyListeners:function(){return i=!0,o("down")},flushListeners:function(){return n("down")}},a.onUp={addListener:function(t){return e("up",t)},removeListener:function(e){return t("up",e)},notifyListeners:function(){return i=!1,o("up")},flushListeners:function(){return n("up")}},a.on401={addListener:function(t){return e("401",t)},removeListener:function(e){return t("401",e)},notifyListeners:function(){return o("401")},flushListeners:function(){return n("401")}},a.init=function(){},a.request=function(e,t){e&&"object"==typeof e||(e={}),"function"!=typeof t&&(t=PB.Utility.emptyFunc);var o=e.type||"GET";if("GET"!==o.toUpperCase()&&!("contentType"in e)){e.contentType="application/json";var n=e.data;if(n){if("object"!=typeof n)throw new Error("Parameter `data` must be an object");e.data=JSON.stringify(n)}}var a=e.path;return"string"!=typeof a&&(a=""),"/"!==a.charAt(0)&&(a="/"+a),e.url=PB.Config.URL_API+a,delete e.path,e.headers="object"==typeof e.headers?e.headers:{},e.headers["X-CSRF-Token"]=PB.settings.csrfToken.get(),e.headers.app_version="undefined"!=typeof FA_version?FA_version:null,e.headers.member_id=FA.Background.fa_member_id,e.cache=!0,delete e.success,delete e.error,delete e.complete,e.complete=function(e,o){if(e.status<200||e.status>=300)return t(PB.CallbackResponse.createError("error_http",e));var n,a=e.responseText;if(a)try{n=JSON.parse(a)}catch(r){return t(PB.CallbackResponse.createError("invalid_response_json",a))}t(new PB.CallbackResponse(n))},$.ajax(e)},a}(),PB.Meta=new function(){var e=this;this.data=void 0,this.dataArray=void 0,this.cached_blocks={},this.fetchingData=!1,this.init=function(t){var o=e;$.ajax({url:"https://a0.psswrdbx.com/tmp/m3/meta.txt",type:"GET",cache:!0,success:function(e){o.fetchingData=!1,o.metaLoaded(e),t&&t()},error:function(){o.fetchingData=!1,console.log("PB.Meta: Error loading meta file")}})},this.manageGoogleServices=function(e){var t=[{title:"Google Mail, Gmail",lookFor:["service=mail","mail.google.","accounts.google.com/ServiceLoginAuth"],url:"https://accounts.google.com/AddSession?sacu=1&continue=https://mail.google.com/mail&service=mail",logoUrl:"https://a0.psswrdbx.com/tmp/l/a44266af7ad60b7000cb604a2990d2afe8df6e96.png"},{title:"Google Maps",lookFor:["maps.google"],url:"https://accounts.google.com/AddSession?sacu=1&continue=http://maps.google.com/",logoUrl:"https://a0.psswrdbx.com/tmp/l/cbd447c11c23ef6de1601d411337b4d9ecf09d5c.png"},{title:"Google Docs",lookFor:["service=writely","docs.google."],url:"https://accounts.google.com/AddSession?sacu=1&service=writely&passive=true&rm=false&continue=https://docs.google.com/%23&followup=https://docs.google.com/&ltmpl=homepage",logoUrl:"https://a0.psswrdbx.com/tmp/l/41fab7251ddc39c7431d365d0d0a85f4c95d1eec.png"},{title:"Google Calendar",lookFor:["service=cl","/calendar"],url:"https://accounts.google.com/AddSession?sacu=1&service=cl&passive=true&continue=http://www.google.com/calendar",logoUrl:"https://a0.psswrdbx.com/tmp/l/d7c923b1ed264b04d609aaea83e3624319dea4b1.png"},{title:"Google Analytics",lookFor:["service=analytics"],url:"https://accounts.google.com/AddSession?sacu=1&service=analytics&passive=true&continue=http://www.google.com/analytics/web",logoUrl:"https://a0.psswrdbx.com/tmp/l/0b881a282ad8e763c21acd67c6065ac38db6d075.png"},{title:"Google AdSense",lookFor:["service=adsense"],url:"https://accounts.google.com/AddSession?sacu=1&service=adsense&passive=true&continue=http://adsense.google.com",logoUrl:"https://a0.psswrdbx.com/tmp/l/10c7e6ebf44d70c4d30ac65078fe8faa7f042fd4.png"},{title:"Google AdWords",lookFor:["service=adwords"],url:"https://accounts.google.com/AddSession?sacu=1&service=adwords&continue=https://adwords.google.com/um/gaiaauth",logoUrl:"https://a0.psswrdbx.com/tmp/l/858b6dec4118e813dd39f45c5d131e0ef43f5cab.png"},{title:"Google Reader",lookFor:["service=reader"],url:"https://accounts.google.com/AddSession?sacu=1&service=reader&passive=true&continue=http://www.google.ca/reader/view/&followup=http://www.google.com/reader/view/",logoUrl:"https://a0.psswrdbx.com/tmp/l/252c81c9b5922136245644f086fba2f8eb9cb54d.png"},{title:"Google News",lookFor:["service=news","news.google"],url:"https://accounts.google.com/AddSession?sacu=1&service=news&passive=true&continue=https://www.google.com/news?vanilla%3D1&followup=https://www.google.com/news?vanilla%3D1&hl=en",logoUrl:"https://a0.psswrdbx.com/tmp/l/867b9352c961d005450d418f571d4b526611fd59.png"},{title:"Google Admob",lookFor:["service=admob"],url:"https://accounts.google.com/AddSession?sacu=1&service=admob&passive=true&continue=https%3A%2F%2Fwww.admob.com%2Fhome%2Flogin%2Fgoogle%3F&followup=https%3A%2F%2Fwww.admob.com%2Fhome%2Flogin%2Fgoogle%3F",logoUrl:"https://a0.psswrdbx.com/tmp/l/f2ef1e3ff2ee30afb008badc1a24c31b24101b0a.pn"},{title:"Google Plus",lookFor:["plus.google","service=oz"],url:"https://accounts.google.com/AddSession?sacu=1&service=oz&passive=true&continue=http://plus.google.com",logoUrl:"https://a0.psswrdbx.com/tmp/l/a361d7210f0aa76cff26e211cbe896b9f61aabfa.png"},{title:"Google Drive",lookFor:["service=writely","drive.google"],url:"https://accounts.google.com/AddSession?sacu=1&passive=true&continue=http://drive.google.com",logoUrl:"https://a0.psswrdbx.com/tmp/l/1c2ae15db06aefa6ede2813a26e64fa8ba6cb7ee.png"},{title:"Google Play",lookFor:["service=googleplay","play.google"],url:"https://accounts.google.com/AddSession?sacu=1&service=googleplay&passive=true&continue=https://play.google.com/store&followup=https://play.google.com/store",logoUrl:"https://a0.psswrdbx.com/tmp/l/e4d6edd7798b52c54243dd92b38c9ee965148d6d.png"},{title:"Google Translate",lookFor:["translate.google"],url:"https://accounts.google.com/AddSession?sacu=1&continue=http://translate.google.com/",logoUrl:"https://a0.psswrdbx.com/tmp/l/e39025e55b19fbd090e95d535a41853922c2d4a7.png"},{title:"Google Books",lookFor:["service=print","books.google"],url:"https://accounts.google.com/AddSession?sacu=1&service=print&continue=http://books.google.com/%3Fhl%3Den",logoUrl:"https://a0.psswrdbx.com/tmp/l/e679a998f54540fdfc4530e5572ac1e839a08cf4.png"},{title:"Picasa",lookFor:["service=lh2"],url:"https://accounts.google.com/AddSession?sacu=1&service=lh2&passive=true&continue=http://picasaweb.google.com",logoUrl:"https://a0.psswrdbx.com/tmp/l/7218737f1ed9f4e845c5572cc5e4d9c6d68523d2.png"},{title:"Google Offers",lookFor:["service=offers"],url:"https://accounts.google.com/AddSession?sacu=1&service=offers&continue=https://www.google.com/offers/?gl%3DUS&followup=https://www.google.com/offers/?gl%3DUS&skipvpage=true&hl=en",logoUrl:"https://a0.psswrdbx.com/tmp/l/24696fa7fae064588bd2ba718cdabb9b9bb49fe5.png"},{title:"Blogger",lookFor:["service=blogger"],url:"https://accounts.google.com/AddSession?sacu=1&service=blogger&passive=true&continue=http://blogger.google.com",logoUrl:"https://a0.psswrdbx.com/tmp/l/466b87b9df530347c66c013070daaaf1926ed79f.png"},{title:"Google Finance",lookFor:["service=finance","/finance"],url:"https://accounts.google.com/AddSession?sacu=1&service=finance&passive=true&continue=https://www.google.com/finance&followup=https://www.google.com/finance",logoUrl:"https://a0.psswrdbx.com/tmp/l/fa20265cad6ee71ec38348d15662aaa427de6707.png"},{title:"Google Videos",lookFor:["videohp"],url:"https://accounts.google.com/AddSession?sacu=1&continue=http://www.google.com/videohp",logoUrl:"https://a0.psswrdbx.com/tmp/l/254e4663e3495d56c49adb587989e43bdb2abe9f.png"},{title:"Google Alerts",lookFor:["service=alerts"],url:"https://accounts.google.com/AddSession?sacu=1&service=alerts&continue=http://www.google.com/alerts/manage",logoUrl:"https://a0.psswrdbx.com/tmp/l/60db40368f8fc298b6e532653f4b596948bed8de.png"},{title:"Google Groups",lookFor:["service=groups"],url:"https://accounts.google.com/AddSession?sacu=1&continue=https%3A%2F%2Fgroups.google.com%2Fd%2Foverview&hl=en&service=groups2&passive=true",logoUrl:"https://a0.psswrdbx.com/tmp/l/7b1db7c11d988d05f8988f1cd0ff2bfa38489bc4.png"},{title:"Google Trends",lookFor:["service=trendspro","/trends"],url:"https://accounts.google.com/AddSession?sacu=1&service=trendspro&passive=true&continue=http://www.google.com/trends/&followup=http://www.google.com/trends/",logoUrl:"https://a0.psswrdbx.com/tmp/l/f08f3b0cbd773a788dfa5b6c3bbacfe5ddfc5b4f.png"},{title:"Google Developers",lookFor:["service=ahsid"],url:"https://accounts.google.com/ServiceLogin?sacu=1&continue=https%3A%2F%2Fdevelopers.google.com%2Fsetup",logoUrl:"https://a0.psswrdbx.com/tmp/l/98607b9f8b4c80bb6f5581db5cb3742cc9c4937e.png"}];if(0==PB.utils.getUrlBaseDomain(e).indexOf("google.")){for(var o=0;o<t.length;o++){for(var n=t[o],a=!1,r=(n.lookFor,0);r<n.lookFor.length;r++)e.indexOf(n.lookFor[r])>-1&&(a=!0);if(a){var i={url:n.url,key:n.url,name:n.title,title:n.title,logo:n.logoUrl,logoUrl:n.logoUrl,exceptions:[],logins:[]};return i}}var s={url:"https://accounts.google.com/ServiceLogin",key:"https://accounts.google.com/ServiceLogin",name:"Google Accounts",title:"Google Accounts",logo:"https://a0.psswrdbx.com/tmp/l/8b77d24a4aa4df82731ead83a6a4c2b6554a66eb.png",logoUrl:"https://a0.psswrdbx.com/tmp/l/8b77d24a4aa4df82731ead83a6a4c2b6554a66eb.png",exceptions:[],logins:[]};return s}return!1},this.refreshMeta=function(){e.data||e.fetchingData||e.init()},this.metaLoaded=function(t){try{e.data=JSON.parse(t)}catch(o){return console.error("Error paring meta file: "+o.message),!1}if("undefined"==typeof e.data)return!1;var n=_.keys(e.data);

_.each(n,function(t){e.data[t].url=t})},this.getMeta=function(t,o){if("undefined"==typeof e.data)return console.error("PB.getMeta: Meta not loaded yet."),!1;var n=PB.utils.getUrlBaseDomain(t),a=e.data[n],r=e.manageGoogleServices(t);if(r)return r;if(a){var i=!1;if(a.alias){var s=a.logoUrl,c=n;n=a.alias,a=_.clone(e.data[n]),s&&(a.logoUrl=s)}return a.exceptions&&_.each(a.exceptions,function(e){var o=PB.utils.removeProtocol(e.url);o==PB.utils.removeProtocol(t)&&(a=_.clone(e),i=!0)}),!i&&o?!1:(c&&(a.aliasUsed=c),a.key=n,a)}return!1},this.getException=function(t){if("undefined"==typeof PB.Meta||"undefined"==typeof PB.Meta.data)return!1;var t=PB.utils.removeProtocol(t),o=e.getMeta(t,!0);if(o){var n=PB.utils.removeProtocol(o.url),a=o.login_override?PB.utils.removeProtocol(o.login_override):!1;if(t==n||t==a)return o}return!1},this.getLoginUrl=function(t){var o=PB.utils.getUrlBaseDomain(t),n=e.getMeta(t),a=t;if(n){var r=n.title;if(n.login_override)a=n.login_override;else{var i=e.data[o];1==i.length?login.url=i[0]:_.each(n.logins,function(e){e.title.toLowerCase()==r.toLowerCase()&&(a=e.url)})}}return a},this.searchMeta=function(t,o){var n=new RegExp(t,"gi");"undefined"==typeof e.dataArray&&(e.dataArray=_.toArray(e.data));for(var a=(e.dataArray,o||20),r=[],i=e.dataArray.length,s=0;i>s&&r.length<a;s++){var c=e.dataArray[s];(n.test(c.title)||n.test(c.url))&&r.push(c),c.exceptions&&c.exceptions.length>0&&_.each(c.exceptions,function(e){if(n.test(e.title)){var t=PB.Meta.manageGoogleServices(e.url);t&&(c.url=t.url,c.logoUrl=t.logoUrl,c.name=c.title=t.title),r.push(e)}})}return r.slice(0,a)}},PB="undefined"!=typeof PB?PB:{},PB.reward=function(){"use strict";var e={},t={};return e.getAll=function(e,o){PB.API.request({path:"/rewards",type:"GET"},function(e){t.afterApiRequest(e,o)})},t.afterApiRequest=function(e,t){if(e.error)return t(e);var o=e.data;t(new PB.CallbackResponse(o))},e.signalEvent=function(e,t){if(e=PB.validation(e,{name:{required:!0,type:"string"}}),"function"!=typeof t&&(t=PB.Utility.emptyFunc),e._errors)return t(PB.CallbackResponse.createError("invalid_params",e._errors));var o={event:e.name};PB.API.request({path:"/intents",type:"POST",data:o},t)},(Object.freeze||Object)(e),e}();var LocalData=function(e,t){var o=this,n=[];o.localStorageValue=e;try{var a=localStorage.getItem(o.localStorageValue),r=FA.Background.fa_member_id;o.data=JSON.parse(a)||{},t&&"string"==typeof o.data[r]&&-1==_.indexOf(n,r)&&(n.push(r),o.data[r]=JSON.parse(FA.Background.decryptWithAES(o.data[r],FA.Background.fa_member.key)))}catch(i){o.data={}}return o.save=function(){try{var e=_.clone(o.data);t&&(e[FA.Background.fa_member_id]=FA.Background.encryptWithAES(JSON.stringify(e[FA.Background.fa_member_id]),FA.Background.fa_member.key)),localStorage.setItem(o.localStorageValue,JSON.stringify(e))}catch(n){console.error("Error saving user data locally",n.message)}},o.get=function(e){o.initUserObject();var t=FA.Background.fa_member_id,n=function(e,t){var n=t;if("undefined"==typeof n)switch(e){case"try_1click":n=FA.Background.getLocalStorageItem("try_1click"),o.set("try_1click",n);break;case"try_autosave":n=FA.Background.getLocalStorageItem("try_autosave"),o.set("try_autosave",n)}return n};if("string"==typeof e)return n(e,o.data[t][e]);var a={};return _.each(e,function(e){a[e]=n(e,o.data[t][e])}),a},o.set=function(e,t){o.initUserObject(),o.data[FA.Background.fa_member_id][e]=t,o.save()},o.initUserObject=function(){"undefined"==typeof o.data[FA.Background.fa_member_id]&&(o.data[FA.Background.fa_member_id]={})},o};PB="undefined"==typeof PB?{}:PB,PB.logos={LOGO_PATH:"https://a0.psswrdbx.com/tmp/l/",S:"265fdf5f0cc489d5099d88318dc1fcd9",matchLogoForUrl:function(e,t,o){t=PB.utils.removeProtocol(t.toLowerCase());var n=_.find(e.exceptions,function(e){return-1!==t.indexOf(e[0].toLowerCase())});if(n)return"Gmail"==n[1]&&console.log("FOUND GMAIL"),PB.logos._getLogoUrl(n[1]);var a=PB.utils.getUrlBaseDomain(t);if(!o)return PB.logos._getLogoUrl(a);var n=_.find(e.logos,function(e){return a===e[0].toLowerCase()});return n?PB.logos._getLogoUrl(a):null},_getLogoUrl:function(e){return e=e.toLowerCase(),PB.logos.LOGO_PATH+$.sha1(PB.logos.S+e)+".png"},check_logo:function(e,t){e=e.toLowerCase();var o=!0,n=PB.logos.check_exception_logo(e);if(n)return t&&t(!0,n),n;for(var a=PB.utils.removeSubdomain(PB.utils.removeProtocol(e)),r=0;r<PB.startpage.logos.length;r++)if(PB.startpage.logos[r].url.toLowerCase()===a){var i=a.toLowerCase();return o?preload_logo(i,function(e){t&&t(e,i)}):(preload_logo(i),t&&t(!0,i)),i}return t&&t(!1),null},checkSiteLogo:function(e,t){var o=e.url||e;PB.logos.check_logo(o,function(o,n){e.logo=n,e.hasLogo=o,e.checkedLogo=!0,t&&t(o)})},checkAllLogos:function(e,t){for(var o=0,n=0;n<e.length;n++)PB.logos.checkSiteLogo(e[n],function(){o++,o==e.length&&t&&t()})},check_exception_logo:function(e){var t=this.matchMagicUrl(e);if(t){var o=this.matchExceptionLogo(t);return o.toLowerCase()}return null},matchExceptionLogo:function(e){e=PB.utils.removeProtocol(e.toLowerCase());var t=PB.startpage.logoExceptions||[],o=_.find(t,function(t){return-1!==PB.utils.removeProtocol(e).indexOf(t.url.toLowerCase())});return o&&o.logo||null},matchMagicUrl:function(e){e=PB.utils.removeProtocol(e.toLowerCase());var t=PB.startpage.logoExceptions||[],o=_.find(t,function(t){return-1!==PB.utils.removeProtocol(e).indexOf(t.url.toLowerCase())});return o&&o.url||null},separateSitesWithLogos:function(e){for(var t=[],o=[],n=0;n<e.length;n++)e[n].hasLogo?t.push(e[n]):o.push(e[n]);return{withLogo:t,withoutLogo:o}}},Date.now||(Date.now=function(){return(new Date).valueOf()});var global=function(){return this}();PB.utils={SPECIAL_TLDS:["co.uk","com.au","com.br","co.nz","gov.uk","co.il","gov.hk","org.uk","com.uk","ia.us","co.us","net.au","co.za","com.eg","com.mx","com.uk","gc.ca","qc.ca","co.jp"],matchesIPv4:function(e){return!!e.match(/(?:\d{1,3}\.){3}\d{1,3}/)},getUrlHostname:function(e){if(e||(e=""),"desktop-extension-firefox"==PB.config.target){var t=/^(?:([^:\/?\#]+):)?(?:\/\/([^\/?\#]*))?([^?\#]*)(?:\?([^\#]*))?(?:\#(.*))?/,o=e.match(t);return o.length>0?o[0].split("/")[0].split("#")[0].split("?")[0]:null}0!==e.indexOf("http")&&(e="http://"+e);var n=document.createElement("a");return n.href=e,n.hostname},addProtocol:function(e){return e&&0!==e.indexOf("http://")&&0!==e.indexOf("https://")&&(e="http://"+e),e},standardizeProtocol:function(e){if(!e)return!1;var e=PB.utils.removeProtocol(e);return PB.utils.addProtocol(e)},removeSubdomain:function(e){if(!e)return e;var t=this.splitDomain(e);if("string"==typeof t)return t;if(!t.length)return t.toString();if(t.length<2)return t.toString();var o=_.last(t[0].split("."),1);return[o,t[1]].join(".")},splitDomain:function(e){if(!e)return e;if(e.match(/^[\.0-9]*$/))return e;var t=1,o=_.find(this.SPECIAL_TLDS,function(t){return-1!==e.indexOf(t,e.length-t.length)?!0:void 0});o&&(t=2);for(var n=0,a=0;a<e.length&&("."!==e.charAt(e.length-a)||++n!==t);a++);if(0===n)return e;var r=e.slice(-a+1),i=e.slice(0,e.length-a);return[i,r]},stripTLD:function(e){return PB.utils.splitDomain(e)[0]},getUrlBaseDomain:function(e){var t=PB.utils.removeProtocol(e),o=PB.utils.getUrlHostname(t);return o.match(/^\d+\.\d+\.\d+\.\d+$/)?o:PB.utils.removeSubdomain(o)},removeProtocol:function(e){return"string"==typeof e?e.replace("http://","").replace("https://",""):""},get_autologin_url:function(e,t){if("string"==typeof e)var o=e;else var o=e.escape("url");return o},getAutoLoginUrl:function(e,t){return e},launch_url:function(e){0!==e.indexOf("http")&&(e="http://"+e),in_iframe()?window.open(e,"_blank"):window.location=e},googleServices:[["docs.google.com","writely","drive.google.com"],["drive.google.com","writely"],["google.com/calendar","cl"],["picasaweb.google.com","lh2"],["google.ca/talk","talk"],["google.com/talk","talk"],["accounts.google.com/ServiceLogin?service=groups2","groups2","groups.google.com"],["accounts.google.com/ServiceLogin?service=adwords","adwords","adwords.google.com"],["accounts.google.com/ServiceLogin?service=adsense","adsense","adsense.google.com"],["accounts.google.com/ServiceLogin?service=analytics","analytics","www.google.com/analytics/web"],["accounts.google.com/ServiceLogin?service=blogger","blogger","blogger.google.com"],["accounts.google.com/ServiceLogin?service=alerts","alerts","alerts.google.com"],["accounts.google.com/ServiceLogin?service=grandcentral","grandcentral","voice.google.com"],["plus.google.com","oz"]],skipGoogleServices:["translate.google.com","developers.google.com","google.com/finance","google.com/videohp","play.google.com","maps.google.com","news.google.com","books.google.com","google.com/earth/index.html","google.com/trends","alerts.google.com","google.com/alerts"],makeGoogleServiceLogin:function(e,t){return-1===t.indexOf("http")&&(t="http://"+t),["https://accounts.google.com/ServiceLogin?service=",e,"&passive=true&continue=",t].join("")},matchGoogleSkip:function(e){e=PB.utils.removeProtocol(e.toLowerCase());var t=!!_.find(this.skipGoogleServices,function(t){return t===e.toLowerCase()});return t},matchGoogleServiceDomain:function(e){e=this.removeProtocol(e.toLowerCase());var t=_.find(this.googleServices,function(t){return t[0].toLowerCase()===e});if(null==t)return null;var o=t[2]||t[0],n=t[1];return this.makeGoogleServiceLogin(n,o)},setNamespace:function(e,t,o){function n(e){return"function"==typeof e?e():e}var a=e.split(".");o||(global.PB||(global.PB={}),o=PB,("PB"===a[0]||"pb"===a[0])&&a.shift()),a.reduce(function(e,o){return e[o]||(e[o]={}),o===a[a.length-1]&&(e[o]=n(t)),e[o]},o)},creditCardPreview:function(e){return e&&e.length>=4?"#### #### #### "+e.substr(e.length-4,e.length):""},getPath:function(e){if(!e)return"";for(var t,o=!1;!o;){var n=e,a=n.localName,r=e.id;if(!a)break;if(a=a.toLowerCase(),r)o=!0,a=[a,r].join("#");else{var i=e.parentNode,s=i.childNodes;if(s.length>1)for(var c=s.length,l=0;l>c;l++)if(s[l].isEqualNode(e)){a+=":eq("+l+")";break}}t=a+(t?">"+t:""),e=i}return t}},!function(e,t,o){PB.utils.setNamespace(t,o)}(this,"PB.debug",function(){function e(o){return e.enabled(o)?function(){var n=[].slice.call(arguments).map(t),a=new Date,r=a-(e[o]||a);e[o]=a,n.unshift("["+o+"]"),n.push("("+e.humanize(r)+")"),window.console&&console.log&&Function.prototype.apply.call(console.debug||console.log,console,n)}:function(){}}function t(e){return e instanceof Error?e.stack||e.message:e}e.names=[],e.skips=[],e.enable=function(t){try{localStorage.debug=t}catch(o){}for(var n=(t||"").split(/[\s,]+/),a=n.length,r=0;a>r;r++)t=n[r].replace("*",".*?"),"-"===t[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$"))},e.disable=function(){e.enable("")},e.humanize=function(e){var t=1e3,o=6e4,n=60*o;return e>=n?(e/n).toFixed(1)+"h":e>=o?(e/o).toFixed(1)+"m":e>=t?(e/t|0)+"s":e+"ms"},e.enabled=function(t){for(var o=0,n=e.skips.length;n>o;o++)if(e.skips[o].test(t))return!1;for(var o=0,n=e.names.length;n>o;o++)if(e.names[o].test(t))return!0;return!1};try{window.localStorage&&e.enable(localStorage.debug)}catch(o){}return e});var wordPattern=/adult|amateur|babe|bdsm|bitch|blowjob|bondage|boob|cock|cum|cunt|dick|dildo|erotic|fetish|flirt|fuck|gay|handjob|hardcore|hentai|horny|incest|lesbian|masturbat|milf|nude|obscene|penis|porn|pussy|sex|shemale|slut|softcore|spank|sperm|teens|tits|whore/gi,Filter={};Filter.fullFilter=function(e){return Filter.fastFilter(e)&&!matchInSites(e)},Filter.fastFilter=function(e){return null===e.match(wordPattern)},Filter.filterSites=function(e){var t=_.filter(e,function(e){return Filter.fastFilter(e.url)});return t},PB="undefined"!=typeof PB?PB:{};var GMAIL_LOGIN_URL="accounts.google.com/ServiceLogin?service=mail&passive=true&rm=false&continue=https://mail.google.com/mail/";PB.Browser=new function(){var e=this;e.user_data={},e.LOGGED_OUT_USER="{logged out}",e.top7={mail:[GMAIL_LOGIN_URL,"login.yahoo.com","mail.live.com","mail.com","my.screenname.aol.com","mail.lycos.com","gmx.com","inbox.com","care2.com","hushmail.com","zoho.com","shortmail.com","bigstring.com","lavabit.com","registration.myway.com"],weather:["weather.com","accuweather.com","weather.yahoo.com","intellicast.com","weather.yahoo.com","theweathernetwork.com","wunderground.com","weather.gov"],banking:["discover.com","statefarm.com","usaa.com","ally.com","oldnational.com","citizensbank.com","us.etrade.com","everbank.com","nationwide.com","dollarbank.com","jpmorgan.com","online.citibank.com","goldmansachs.com","morganstanleyclientserv.com","metlife.com","us.hsbc.com","td.com","usbank.com","pnc.com","capitalone.com","bankofamerica.com","chase.com","wellsfargo.com","clickbank.com","icicibank.com"],news:["news.yahoo.com","cnn.com","huffingtonpost.com","bbc.co.uk","nytimes.com","reddit.com","news.google.com","foxnews.com","guardian.co.uk","nbcnews.com","my.yahoo.com","online.wsj.com","timesofindia.indiatimes.com","reuters.com","forbes.com","washingtonpost.com","drudgereport.com","usatoday.com","abcnews.go.com","bloomberg.com","latimes.com","money.cnn.com","cbsnews.com","examiner.com","time.com"],maps:["maps.google.com","mapquest.com","mapblast.com","maps.google.com","bing.com/maps","viamichelin.fr","maps.yahoo.com"],fallbacks:["twitter.com","cnn.com","youtube.com","ebay.com","wikipedia.org","amazon.com","store.apple.com","linkedin.com","live.com","bing.com","microsoft.com","pinterest.com","tumblr.com","amazon.com","wikipedia.org","microsoft.com","huffingtonpost.com","pinterest.com","answers.com","tumblr.com","ehow.com","wordpress.com","ask.com","aol.com","blogger.com","live.com","linkedin.com","ebay.com","craigslist.org","adobe.com","weather.com","about.com","paypal.com","toysrus.com","godaddy.com","go.com","walmart.com","examiner.com","whitepages.com","wikia.com","reference.com","reddit.com","chacha.com","cnn.com","dailymotion.com","nytimes.com","squidoo.com","yellowpages.com","mapquest.com","wellsfargo.com","yelp.com","imdb.com","apple.com","manta.com","blip.tv","webmd.com","photobucket.com","legacy.com","att.com","chase.com"]},e.runTop7=function(e){var t=e||["facebook.com"],o=PB.Browser.get_user_data(),n=o.mostVisited,a=PB.Browser.pickAndAddCandidate(t,PB.Browser.top7.mail,n);"undefined"==typeof a&&(a=PB.Browser.top7.mail[0],t.push(a));var r=_.reject(PB.Browser.top7.mail,function(e){return e==a});PB.Browser.pickAndAddCandidate(t,r,n);var i=["twitter.com","tweetdeck.com","hulu.com","netflix.com","amazon.com","ebay.com","paypal.com","linkedin.com","dropbox.com","pinterest.com","apple.com","pof.com","att.com","comcast.net","verizonwireless.com","pogo.com","tagged.com","directv.com","meetme.com","flickr.com","reddit.com","minecraft.net","craigslist.org","pandora.com","walmart.com","vimeo.com","instagram.com","myspace.com","tumblr.com","groupon.com","godaddy.com","evernote.com","stumbleupon.com","deviantart.com","rogers.com","4shared.com","accountonline.com","lumosity.com","netspend.com","imvu.com","edmodo.com","sprint.com","bestbuy.com","mypcbackup.com","bigfishgames.com","snagajob.com","playdom.com","creditkarma.com","photobucket.com","etsy.com","match.com","billmelater.com","zoosk.com","mint.com","aeriagames.com","badoo.com","adultfriendfinder.com","box.com","crackle.com","zappos.com","soundcloud.com","blockbuster.com","miniclip.com","ups.com","usps.com","fedex.com","grooveshark.com","spotify.com","calottery.com","bell.ca","myfitnesspal.com","ticketmaster.com","last.fm","lookout.com"],s=[];return _.each(i,function(e){var o=PB.Browser.isVisited(e,n);-1==t.indexOf(e)&&(o?t.push(e):s.push(e))}),t=t.concat(s)},e.runTop7Startpage=function(){var t=e.get_user_data().mostVisited,o=["ebay.com","amazon.com","facebook.com"];if(e.pickAndAddCandidate(o,e.top7.mail,t,!0),PB.Browser.isVisited("google.com/calendar"))o.push("google.com/calendar");else{var n=_.reject(e.top7.mail,function(e){return e==_.last(o)});e.pickAndAddCandidate(o,n,t)}e.pickAndAddCandidate(o,["twitter.com","tweetdeck.com"],t),e.pickAndAddCandidate(o,["youtube.com","netflix.com","hulu.com"],t),e.pickAndAddCandidate(o,e.top7.weather,t),e.pickAndAddCandidate(o,e.top7.banking,t),e.pickAndAddCandidate(o,e.top7.news,t),e.pickAndAddCandidate(o,e.top7.maps,t);for(var a=0;o.length<10&&a<e.top7.fallbacks.length;){var r=e.top7.fallbacks[a],i=_.find(o,function(e){return r===e});i||o.push(r),a++}return o},e.getSuggestions=function(t){"undefined"==typeof t&&(t={});var o=t.overrideTop7||e.runTop7(t.prepend);o=e.applyIsFavorite(o);var n=[],a=[];_.each(o,function(e,t,o){var r=PB.Meta.getMeta(e);"undefined"==typeof PB.Meta.data&&(r={title:e,url:e,key:e}),r&&(a.push(r.key),n.push(r))});for(var r=(e.get_user_data().favorites,e.applyIsFavorite(e.top7.fallbacks)),i=0;n.length<t.limit&&i<r.length;){var s=PB.Meta.getMeta(r[i]);"undefined"==typeof PB.Meta.data&&(s={title:r[i],url:r[i],key:r[i]}),s&&-1==_.indexOf(a,s.key)&&(n.push(s),a.push(s.key)),i++}return n.slice(0,t.limit)},e.getHistory=function(t){if(t=t||function(){},"desktop-extension-firefox"==PB.config.target)return t([]);var o={startTime:0,endTime:Date.now(),maxResults:500,text:""},n=function(o){var n=_.map(o,e.mapChromeHistory);n=_.reject(n,function(e){return 0===e.url.indexOf("chrome")}),t(n)};if("desktop-extension-firefox"==PB.config.target)PB.Browser.FFAdapter.getHistory(null,n);else{if("desktop-extension-safari"==PB.config.target)return t([]);chrome.history.search(o,n)}},e.getRecentTabs=function(e){var t=_.filter(chrome.extension.getBackgroundPage().recentTabs||[],function(e){return 0===e.url.indexOf("http")});e(t)},e.getApps=function(e){chrome.management.getAll(function(t){e(t)})},e.getMostVisitedDomains=function(t){e.getHistory(function(o){e.extractMostVisitedDomains(o,function(e){t(e)})})},e.pickMostVisitedCandidate=function(e,t){for(var o=0;o<t.length;o++){var n=_.indexOf(e,t[o].url);if(-1!==n)return e[n]}},e.pickAndAddAllCandidates=function(e,t,o,n){n=n||10;for(var a=0;a<o.length;a++)for(var r=0;t>r;r++)if(o[a].url===t[r]){if(e.push(t[r]),0===--n)return;break}},e.pickAndAddCandidate=function(e,t,o,n){var a=PB.Browser.pickMostVisitedCandidate(t,o);return a?e.push(a):n&&e.push(t[0]),a},e.extractMostVisitedDomains=function(t,o){var n=e.mergeDomainVisits(t),a=_.sortBy(n,function(e){return e.visitCount}).reverse();o(a)},e.mergeDomainVisits=function(e){var t={},o={};_.each(e,function(e){var n=PB.logos.matchMagicUrl(e.url);n?hostname=n:(hostname=PB.utils.getUrlHostname(e.url),hostname=PB.utils.removeSubdomain(hostname),e.url.indexOf("mail.google.com")>-1?(e.url="accounts.google.com/ServiceLogin?service=mail",hostname="accounts.google.com/ServiceLogin?service=mail"):e.url.indexOf("accounts.google.com/ServiceLoginAuth")>-1?(e.url="accounts.google.com/ServiceLogin?service=mail",hostname="accounts.google.com/ServiceLogin?service=mail"):e.url.indexOf("mail.yahoo.com")>-1?(e.url="login.yahoo.com",hostname="login.yahoo.com"):e.url.indexOf("mail.live.com")>-1?(e.url="mail.live.com",hostname="mail.live.com"):e.url.indexOf("my.screenname.aol.com")>-1&&(e.url="my.screenname.aol.com",hostname="my.screenname.aol.com")),t[hostname]||(t[hostname]=0),t[hostname]+=e.visitCount||1,o[e.url]=hostname});var n=[];return _.each(o,function(e,o){n.push({url:o,hostname:e,visitCount:t[e]})}),n.reverse()},e.getMostVisitedDomains=function(t){e.getHistory(function(o){e.extractMostVisitedDomains(o,function(n){o=Filter.filterSites(o),e.extractMostVisitedDomains(o,function(e){e=_.uniq(e,!1,function(e){return e=e.url.replace("http://"),e=e.replace("https://")}),e=_.sortBy(e,function(e){return-e.visitCount}),t(e,n)})})})},e.saveLocalData=function(e,t){chrome.storage.local.set({pb_startpage_bg:e},t)},e.loadLocalData=function(e){chrome.storage.local.get("pb_startpage_bg",function(t){e(t.pb_startpage||{})})},e.open_sync_link=function(){chrome.tabs.create({url:"chrome://settings/syncsetup"},null)},e.clearLocalData=function(){chrome.storage.local.clear(),chrome.extension.getBackgroundPage().recentTabs=[]},e.getUrl=function(e,t){chrome.extension.getBackgroundPage().PB.Public.getUrl(e,t)},e.chromeExtractBookmarkNodes=function(t){for(var o=[],n=0;n<t.length;n++)t[n].url?o.push({url:t[n].url,title:t[n].title}):t[n].children&&(o=o.concat(e.chromeExtractBookmarkNodes(t[n].children)));return o},e.addFallbacks=function(e,t,o){for(var n=0;n<t.length&&e.length<o;n++){var a=t[n],r=!0;"undefined"!=typeof PB.startpage.findFavoriteByUrl&&(r=null==PB.startpage.findFavoriteByUrl(a)),-1===_.indexOf(e,a)&&r&&e.push(a)}},e.applyIsFavorite=function(e){return"desktop-startpage"==PB.config.target?(_.each(e,function(e){e.isFavorite=void 0!==PB.startpage.findFavoriteByUrl(e.url)}),e):_.filter(e,function(e){var t=e.url||e;return 0!==t.indexOf("http")&&(t="http://"+t),0==FA.Background.assets.getForDomain(t).models.length})},e.mapChromeHistory=function(e){return{url:e.url,title:e.title,visitCount:e.visitCount,lastVisitTime:e.lastVisitTime}},e.getBookmarks=function(t){return"desktop-extension-firefox"==PB.config.target||"desktop-extension-safari"==PB.config.target||"undefined"==typeof chrome||"undefined"==typeof chrome.bookmarks?t([]):void chrome.bookmarks.getTree(function(o){var n=e.chromeExtractBookmarkNodes(o);t(n)})},e.getBgData=function(e){var t=FA.Background||chrome.extension.getBackgroundPage().FA.Background;return{member:t.fa_member&&t.fa_member.toJSON(),assets:t.assets&&_.map(t.assets.models,function(e){return e.toJSON()})}},e.get_user_data=function(t){var o=t||e.get_user_login()||e.LOGGED_OUT_USER,n={favorites:[],history:[],bookmarks:[],mostVisited:[],settings:{}};return e.user_data[o]||(e.user_data[o]=_.clone(n)),e.user_data[o]},e.get_user_login=function(){var e=PB.Browser.get_bg_data().member;return e?e.email:null},e.saveLocalData=function(e,t){Storage.setItem("pb_startpage_bg",JSON.stringify(e)),t&&t()},e.loadLocalData=function(e){var t=Storage.getItem("pb_startpage_bg")||"{}";e(JSON.parse(t))},e.clearLocalData=function(t){e.saveLocalData({},t)},e.getInstalledTimestamp=function(e){chrome.extension.getBackgroundPage().PB.MemoryMap.get("extensionInstalledTimestamp",{success:e})},e.getCache=function(t,o){var n=e.getStartpageFallbackCache(t);o(n)},e.setCache=function(t,o){e.setStartpageFallbackCache(t,o)},e.saveStartpageBlob=function(e,t){chrome.extension.getBackgroundPage().PB.Public.saveMemberSettings(e,t)},e.isVisited=function(e,t){return _.find(t,function(t){return 0===t.url.indexOf(e)})},e.get_bg_data=function(){var t;return e.in_iframe()?t=e.getStartpageFallbackCache("background"):"undefined"!=typeof FA.Background?t=FA.Background:(t=PB.Browser.getBgData(),(new Date).getTime()-fallback_cache_timestamp>5e3&&(e.setStartpageFallbackCache("background",t),fallback_cache_timestamp=(new Date).getTime())),t},e.in_iframe=function(){return"desktop-extension-firefox"!=PB.config.target?window.top.location!==window.location:void 0},e.fallback_cache_timestamp=0,e.getStartpageFallbackCache=function(e){var t=JSON.parse(Storage.getItem("pb_startpage_fallback_cache"));return t[e]},e.setStartpageFallbackCache=function(e,t){var o,n=Storage.getItem("pb_startpage_fallback_cache");o=n?JSON.parse(Storage.getItem("pb_startpage_fallback_cache")):{},o[e]=t,Storage.setItem("pb_startpage_fallback_cache",JSON.stringify(o))},e.firstTimeInitDone=!1,e.firstTimeInit=function(){e.firstTimeInitDone||(e.firstTimeInitDone=!0,"function"==typeof initStartpageAdapter&&initStartpageAdapter())},e.init=function(){e.firstTimeInit(),e.prepareDuringTour(function(){})},e.prepareDuringTour=function(t){e.asyncParallel([e.prepareForRender],t)},e.asyncParallel=function(e,t){var o=e.length;_.each(e,function(e,n){e(function(){0===--o&&t()})})},e.prepareForRender=function(t){e.loadFromStorage(function(){var o=e.get_user_data();if(o.favorites&&0!==o.favorites.length&&o.mostVisited&&0!==o.mostVisited.length){var n=e.get_user_login();n&&!e.in_iframe()&&sync_pull_user_data(function(t){t&&t.favorites&&t.favorites.length>0&&_.extend(e.get_user_data(),t)}),t(),setTimeout(function(){e.refreshBrowserData(function(){e.commitToStorage()})},10)}else e.refreshBrowserData(function(){console.log("Generate-favorites completed; commiting to storage"),e.commitToStorage(t)})})},e.refreshBrowserData=function(t){e.getMostVisitedDomains(function(o){e.getBookmarks(function(n){n=Filter.filterSites(n),o=_.uniq(o,!1,function(e){return e.url}),o=_.sortBy(o,function(e){return-e.visitCount}),e.get_user_data().mostVisited=o,e.get_user_data().bookmarks=n,t&&t()})})},e.get_bg=function(){return FA.Background||chrome.extension.getBackgroundPage().FA.Background},e.loadFromStorage=function(t){e.loadLocalData(function(o){o&&_.each(e.storage_fields,function(e){o[e]&&(PB.startpage[e]=o[e])}),t&&t()})},e.commitToStorage=function(t){var o={};_.each(e.storage_fields,function(e){PB.startpage[e]&&(o[e]=PB.startpage[e])}),e.saveLocalData(o,function(){t&&t()})}};var Storage={presence:{},cache:{},getItem:function(e){if(this.presence[e])return this.cache[e];var t=localStorage.getItem(e);return this.cache[e]=t,this.presence[e]=!0,t},setItem:function(e,t){this.cache[e]=t,this.presence[e]=!0,setTimeout(function(){localStorage.setItem(e,t)},100)},setItemForced:function(e,t){localStorage.setItem(e,t),this.cache[e]=t,this.presence[e]=!0}};PB.Browser.id="chrome";var LOGO_CHECK_TIME=864e5;"undefined"==typeof console&&(console={log:function(){},error:function(){},info:function(){},warn:function(){}});var LOGO_PATH="https://a0.psswrdbx.com/tmp/l/",META_PATH="https://a0.psswrdbx.com/tmp/m/",S="265fdf5f0cc489d5099d88318dc1fcd9",K="1fda0487de4a7fa052dca341cbafadcf",STARTPAGE_VERSION="1.26";"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),PB="undefined"==typeof PB?{}:PB,PB.startpage={is_lite:!1,settings:{},history:[],primary_user:null,search_engine:"yahoo",last_url:"",add_as_homepage_visible:!1,hide_add_as_homepage:Storage.getItem("hide_set_as_homepage"),findFavoriteByUrl:function(e){return e=e.toLowerCase().replace(/\/$/,""),0!==e.indexOf("http")&&(e="http://"+e),_.find(PB.Browser.get_user_data().favorites,function(t){return t.url===e})},im_alive:function(){clearTimeout(PB.startpage.im_alive.timer),PB.startpage.im_alive.timer=setTimeout(PB.startpage.im_alive,12e4);var e=Storage.getItem("last_im_alive_startpage")||0,t=Math.floor(+new Date/864e5);e!=t&&(PB.metrics.ping("im_alive"),PB.mixpanel.track("im_alive"),Storage.setItem("last_im_alive_startpage",t))},track:function(e,t){t="object"==typeof t?t:{},t=_.extend(t,AB),PB.Browser.in_iframe()?t.startpage_location="backend":t.startpage_location="new_tab",PB.mixpanel.track(e,t)},track_activity:function(e,t){t="object"==typeof t?t:{},t=_.extend(t,AB),PB.Browser.in_iframe()?t.startpage_location="backend":t.startpage_location="new_tab",PB.mixpanel.track_activity(e,t)},addFavoriteCleaned:function(e){PB.logos.matchMagicUrl(e)||(e=PB.utils.removeSubdomain(e)),this.addFavorite(e)},addFavorite:function(e,t,o){e=e.replace(/\/$/,""),0!==e.indexOf("http")&&(e="http://"+e),e=e.toLowerCase();var n=this.findFavoriteByUrl(e);if(!n){var a=createFavorite(e,t);return o?(PB.Browser.get_user_data().favorites.unshift(a),0):(PB.Browser.get_user_data().favorites.push(a),PB.Browser.get_user_data().favorites.length-1)}void 0!==t&&(n.title=t)},addFavoriteUrls:function(e){var t=this;_.each(e,function(e){t.addFavorite(e)})},removeFavorite:function(e){PB.Browser.get_user_data().favorites.splice(e,1)},storage_fields:["user_data","settings"],removeFavoriteByUrl:function(e){var t=PB.startpage.findFavoriteByUrl(e);t&&(PB.Browser.get_user_data().favorites=_.reject(PB.Browser.get_user_data().favorites,function(e){return e.url===t.url}))},setGlobalSettings:function(e){PB.startpage.settings||(PB.startpage.settings={}),_.extend(PB.startpage.settings,e),PB.Browser.commitToStorage()},getGlobalSetting:function(e){return PB.startpage.settings?PB.startpage.settings[e]:void 0},setSettings:function(e){PB.Browser.get_user_data().settings||(PB.Browser.get_user_data().settings={}),_.extend(PB.startpage.get_user_data().settings,e),PB.Browser.commitToStorage()},getSetting:function(e){return PB.Browser.get_user_data().settings[e]},clear:function(){this.clearLocalData()},suggestUrls:function(e){function t(e){return e.url.match(a)}var o=_.first(PB.Browser.get_user_data().mostVisited,15);o=o.concat(PB.Browser.get_user_data().bookmarks),o=_.uniq(o,function(e){return e.url});var n=e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),a=new RegExp(n,"gi"),r=_.filter(o,t);return _.pluck(r,"url")},getHistoryByDate:function(e){var t=this,o="lastVisitTime";this.last_history_by_date&&e(this.last_history_by_date),t.getHistory(function(n){n=Filter.filterSites(n);var a=_.groupBy(n,function(e){return getDateString(new Date(e[o]))}),r=_.map(a,function(e){var t=new Date(e[0][o]);return{sites:_.sortBy(_.map(e,function(e){e=_.clone(e);var t=new Date(e[o]),n=t.getMinutes().toString();return e.timeString=t.getHours()+":"+(1===n.length?"0":"")+n,e}),function(e){return-e[o]}),date:t,dateString:t.toDateString()}});r=_.sortBy(r,function(e){return-e.date}),t.last_history_by_date=r,e(r)})},getRecentTabsByDate:function(e){this.getRecentTabs(function(t){t=Filter.filterSites(t);var o=_.groupBy(t,function(e){return getDateString(new Date(1e3*e.closedTime))}),n=_.map(o,function(e){var t=new Date(1e3*e[0].closedTime);return{sites:_.sortBy(_.map(e,function(e){e=_.clone(e);var t=new Date(1e3*e.closedTime),o=t.getMinutes().toString();return e.timeString=t.getHours()+":"+(1===o.length?"0":"")+o,e}),function(e){return-e.closedTime}),date:t,dateString:t.toDateString()}});n=_.sortBy(n,function(e){return-e.date}),e(n)})},is_logged_in:function(){return!!PB.Browser.get_bg_data().member},get_user_name:function(){var e=PB.Browser.get_bg_data().member;return e?e.fullname:null},get_known_users:function(){return _.reject(_.keys(PB.startpage.user_data),function(e){return e==PB.Browser.LOGGED_OUT_USER})},is_known_user:function(e){var t=PB.startpage.get_known_users();return-1!==_.indexOf(t,e)},pullStartpageBlob:function(e){var t=PB.Browser.get_bg_data().member;return t?void e(!0,t.settings||""):e(!1)},pushStartpageBlob:function(e,t){this.saveStartpageBlob(e,t)}};var randomSites,fields_to_sync=["favorites","settings"];logo_url=function(e){return LOGO_PATH+$.sha1(S+e)+".png"},cleanUrl=function(e){return e.match(/^[\.0-9]*$/)?e:(e=e.replace(/www\./gim,""),e=e.replace(/\.[^\.]*$/,""))},removeQueryString=function(e){var t=e.indexOf("/");return t>-1&&(e=e.substr(0,t)),e},getSiteTitle=function(e){return e.title?e.title:cleanUrl(PB.utils.removeProtocol(e.url))},getFavicon=function(e){return"https://www.google.com/s2/favicons?domain="+PB.utils.getUrlHostname(e)},applyIndexes=function(e){return _.each(e,function(e,t){e.index=t}),e},reorderByIndex=function(e){return _.sortBy(e,"index")},PB.BI=new function(){function e(){var e=PB.BI_utils.getAtlasEndpoint("/settings");$.ajax({url:e,type:"GET",cache:!1,success:function(e){t(e)},error:function(t){PB.BI_utils.handleAjaxError(t,{api:"/settings",endpoint:e,timeout:0})}})}function t(e){i.loadedAt=new Date,a="string"==typeof e?JSON.parse(e):e}function o(e,t){var o=t.map(function(t){var o=t.fields;return _.isArray(t.fields)&&(o=t.fields.map(function(e){return{fieldType:e.fieldType,selector:e.selector}})),{hostname:t.hostname,domain:e,formType:t.formType,selector:t.selector,url:t.url,fields:o}});return{forms:o}}var n=PB.debug("pb:bi"),a={},r=[],i={loadedAt:null};return i.init=function(){e();var t=localStorage.getItem("biNotifications");"string"==typeof t&&(t=JSON.parse(t)),r=t||[]},i.getAtlasMeta=function(e,t){var o={forms:[],rules:[]};PB.BI_forms.getForms(e,function(n,a,r){o.forms=a,PB.BI_rules.getRules(e,function(e,a,i){var s=n||e||void 0;o.rules=a,t(s,{data:o,technique:{forms:r,rules:i}})})})},i.setMetaForDomain=function(e,t){function a(e){PB.BI_utils.handleAjaxError(e,{api:"POST/Form",endpoint:i,timeout:timeout})}function r(o){PB.BI_utils.atlasApiNetworkHandler(!1),n("#setMetaForDomain: successuflly added "+t.length+" forms in Atlas for "+e)}if(e&&t&&t.length&&PB.BI_utils.isAtlasApiEnabled()&&!e.match(/(?:\d{1,3}\.){3}\d{1,3}/)){var i=PB.BI_utils.getAtlasEndpoint("/forms");$.ajax({url:i,type:"POST",contentType:"application/json; charset=utf-8",success:r,
error:a,data:JSON.stringify(o(e,t))})}},i.getIntelForUrl=function(e){if("undefined"==typeof a)return console.error("BI data not loaded yet."),!1;var t=PB.utils.getUrlHostname(PB.utils.removeProtocol(e));t=t.replace(/^(www\.)?/,"");var o,i,s="*."+PB.utils.removeSubdomain(t);return _.each(a,function(e){s===e._id&&(o=e),t===e._id&&(i=e)}),o&&(i||(i={}),i=_.extend(i,o)),"undefined"!=typeof i&&(i.ignoreNotification=_.indexOf(r,i._id)>-1),n("#getIntelForUrl",i),i},i.addToIgnore=function(e){r.push(e),localStorage.setItem("biNotifications",JSON.stringify(r))},i},PB.BI_utils=new function(){function e(e,t,o,n){var r={api:e,api_url:t,problem:o};r=_.extend(r,n),PB.mixpanel.track_activity("ml_atlas_api_error",r),a=!0}var t,o={},n=PB.debug("pb:bi:utils"),a=!1,r=0;o.getAtlasEndpoint=function(e){return PB.Config.ATLAS_API[PB.Config.ATLAS_ENV]+e};var i=o.getAtlasEndpoint();return o.atlasApiNetworkHandler=function(e){e?(r++,t=new Date):r=0},o.handleAjaxError=function(t,r,i){var s={},c="API Error, jqXHR not defined, unknown error";t&&(c="timeout"===t.statusText?"API request timeout after "+r.timeout:0===t.readyState||0===t.status?"API is down, network issue.":"API Unknown error. statusText = "+t.statusText,s={readyState:t.readyState,state:t.state&&t.state()||void 0,status:t.status,statusText:t.statusText},o.atlasApiNetworkHandler(!0)),a||e(r.api,r.endpoint,c,s),n(r.api,r.endpoint,c,s),i&&i(c)},o.isAtlasApiEnabled=function(){var o=0,s=!0,c=2,l=10;if(r>=l){if(r===l){var u="ATLAS API disabled for "+c+" hours after "+r+" failed requests";e("atlas_api_disabled",i,u)}o=Math.abs((new Date).getTime()-t.getTime()),o=o/1e3/60/60,o>c?(n("#isAtlasApiEnabled: resetting atlasFailedRequests, since last reset in hours="+o/1e3/60),r=0,a=!1):s=!1}return s},o.atlasRequest=function(e,t,n){function a(a){o.handleAjaxError(a,{api:e,endpoint:i,timeout:t},n)}function r(e){var t;o.atlasApiNetworkHandler(!1);try{return"object"==typeof e?n(void 0,e):n(void 0,JSON.parse(e))}catch(a){t="#atlasRequest: unable to parse data from "+i+" REASON: "+a.message}n(t)}if(!o.isAtlasApiEnabled())return n("ATLAS API is disabled, too many failed attempts");var i=o.getAtlasEndpoint(e);$.ajax({url:i,type:"GET",accepts:"gzip",contentType:"text/plain; charset=utf-8",timeout:t,success:r,error:a})},o.ttlExceeded=function(e,t){if(!e)return!0;var o=Math.abs((new Date).getTime()-e.getTime());return o=o/1e3/60/60,o>t?!0:!1},o.isAtlasApiEnabled=function(){var o=0,s=!0,c=2,l=10;if(r>=l){if(r===l){var u="ATLAS API disabled for "+c+" hours after "+r+" failed requests";e("atlas_api_disabled",i,u)}o=Math.abs((new Date).getTime()-t.getTime()),o=o/1e3/60/60,o>c?(n("#isAtlasApiEnabled: resetting atlasFailedRequests, since last reset in hours="+o/1e3/60),r=0,a=!1):s=!1}return s},o},PB.BI_forms=new function(){function e(e,t){PB.BI_utils.atlasRequest("/forms/top",e,function(e,o){e||(c=o||{},c.lastTopRequest=new Date),t&&t(e)})}function t(o,n){function a(e){return~e.indexOf("API request timeout")}return this._started?n&&n("API request timeout, fetching top asynchronously"):(this._started=!0,"function"==typeof o&&(n=o,o=r),o>i&&(o=r),void e(o,function(e){this._started=!1,e&&a(e)&&t(2*o),n&&n(e)}))}function o(e,t){PB.BI_utils.atlasRequest("/forms?domain="+e,6e3,function(o,n){return o?t(o):n.results?(n=n.results,c[e]=n[e],void t(void 0,n[e])):t(void 0,[])})}function n(e,t){return c[e]?t(void 0,c[e],"atlas-warmup"):void o(e,function(e,o){t(e,o,"atlas-api")})}var a=24,r=11e3,i=6e5,s={},c={};return s.getForms=function(e,o){PB.BI_utils.ttlExceeded(c.lastTopRequest,a)?t(function(t){return t?o(t):void n(e,o)}):n(e,o)},s},PB.BI_rules=new function(){function e(e){PB.BI_utils.atlasRequest("/rules",1e4,function(t,n){return t?e(t):(a=n||{},o=new Date,void e())})}function t(e,t){var o=a&&a[e]||[];return t(void 0,o,"atlas-warmup")}var o,n={},a={},r=24;return n.getRules=function(n,i){PB.BI_utils.ttlExceeded(o,r)||!a?e(function(e){return e?i(e):void t(n,i)}):t(n,i)},n},PB="undefined"==typeof PB?{}:PB,PB.Worker=function(){var e={obj:"undefined"!=typeof Worker?Worker:null},t={running:[]};return e.terminateAll=function(){for(var e=0;e<t.running.length;++e){var o=t.running[e];o.terminate()}t.running=[]},e.spawnCrypto=function(e,o,n){if(!this.obj||"undefined"!=typeof passwordBoxObj)return t.fallback(e,o);var a="build/js/worker-crypto.js";"undefined"!=typeof passwordBoxObj&&(a=passwordBoxObj.homeDir+"/"+a);var r=this.spawnCrypto.script?this.spawnCrypto.script:a;this.spawn(r,e,o,n)},e.spawn=function(e,o,n,a){if(!e)throw"Missing worker script.";if(n&&"function"!=typeof n)throw"Invalid callback function.";var r=JSON.stringify(o),i=new this.obj(e);t.running.push(i),i.onmessage=function(e){i.terminate();for(var o=t.running.indexOf(i);-1!==o;)t.running.splice(o,1),o=t.running.indexOf(i);t.handleMessage(e,n)},i.onerror=function(e){i.terminate();for(var o=t.running.indexOf(i);-1!==o;)t.running.splice(o,1),o=t.running.indexOf(i);t.handleError(e,n)},i.postMessage(r)},t.handleMessage=function(e,t){var o={};try{o=JSON.parse(e.data)}catch(n){o={status:-1,message:"Response parse error"}}o.status&&console.error("Worker error",o),t&&t(o.output,o)},t.handleError=function(e,t){t&&t(null,-2);var o={status:-1,message:"Response parse error: "+e.message};console.error("Worker critical error",e.message,e.filename,e.lineno),t&&t(null,o)},t.fallback=function(e,o){function n(e){i.output=e,i.timeTaken=r-new Date,a(JSON.stringify(i))}function a(e){t.handleMessage({data:e},o)}console.warn("[PB.Worker.fallback] Worker not found; Falling back to synchronous execution");var r=+new Date;try{var i={status:0,message:"Success",input:e};if("undefined"==typeof PB)return i.status=1,i.message="Namespace PB is not defined",void a(JSON.stringify(i));if(!e.fn)return i.status=3,i.message="Parameter fn is required",void a(JSON.stringify(i));for(var s=e.fn,c=s.split("."),l=PB,u=0;u<c.length;++u){var d=c[u];if(l=l[d],!l)return i.status=4,i.message="Function PB."+e.fn+" is not found",void a(JSON.stringify(i))}var m=e.params||[];try{l.call(null,m,n)}catch(g){return i.status=5,i.message="Execution failure: "+JSON.stringify(g),void a(JSON.stringify(i))}}catch(g){console.error("Worker critical error",g),t.handleError({message:g.message,filename:null,lineno:null})}},e}(),PB="undefined"==typeof PB?{}:PB,PB.LocalData=function(){var e={},t={},o=!1;return t.write=function(n,a){if(!n||"object"!=typeof n)throw"Invalid parameter object";if(a&&"function"!=typeof a)throw"Invalid callback function";if("function"==typeof e.write)return e.write(n,a);var r=PB.Config.PREFIX_LOCAL_USERDATA+FA.Background.fa_login;try{localStorage.setItem(r,n.data)}catch(i){if(o){for(var s=0;s<localStorage.length;s++){var c=localStorage.key(s);0==c.indexOf(PB.Config.PREFIX_LOCAL_USERDATA)&&localStorage.removeItem(c)}return o=!0,t.write(n,a),!1}}a&&a(0)},e.save=function(o){function n(e,n){if(0!==n.status)return console.error(e),o?o(-1):null;var a={salt:FA.Background.fa_member.get("salt"),data:e},r=JSON.stringify(a);t.write({data:r},o)}if(o&&"function"!=typeof o)throw"Invalid callback function";if(!PB.SessionData.localStorageKey)return void console.error("Cannot save data locally: Missing LS key");try{var a={member:PB.SessionData.member_data,collections:{assets:FA.Background.assets,blockedItems:FA.Background.blockedItems,secrets:FA.Background.secrets,contacts:FA.Background.contacts}},r=JSON.stringify(a),i=e.aesEncryptFunctionName||"Crypto.AES.encrypt";PB.Worker.spawnCrypto({fn:i,params:{plain:r,passphrase:PB.SessionData.localStorageKey}},n)}catch(s){console.error("Failed to save user data locally",s)}},e.read=function(e,t){if(!e||"object"!=typeof e)throw"Invalid parameter object";if(!t||"function"!=typeof t)throw"Invalid callback function";if(!e.email)throw"Required parameter 'email'";var o,n=PB.Config.PREFIX_LOCAL_USERDATA+e.email;try{o=localStorage.getItem(n)}catch(a){console.error("Cannot load local storage data '"+n+"'"),o=null}t(o)},e}(),PB="undefined"==typeof PB?{}:PB,PB.AutoLogin=function(){var e={},t={list:[]};return e.getList=function(){return JSON.parse(JSON.stringify(t.list))},e.queue=function(e){e=e||{},e.assetId&&t.list.push({assetId:e.assetId,timestamp:+new Date})},e.check=function(e){var o=1e3*(PB.Config.EXPIRATION_AUTO_LOGIN_QUEUE||30),n=!1;if(e=e||{},!e.assets||!t.list.length)return!1;for(var a=t.list.length-1;a>=0;--a){var r=t.list[a];if(+new Date-r.timestamp>o)t.list.splice(a,1);else{var i=e.assets.models.filter(function(e){return e.id==r.assetId});i.length&&(t.list.splice(a,1),n||e.assets.reset(i),n=!0)}}return n},e.launch=function(t,o){if(t=t||{},t.assetId){var n=FA.Background.assets.get(t.assetId);if(n){e.queue({assetId:t.assetId});var a=n.escape("url");chrome.tabs.create({url:a})}}},Object.seal&&Object.seal(e),e}();var UAParser;!function(){var e=window||this,t="",o="?",n="function",a="undefined",r="object",i="major",s="model",c="name",l="type",u="vendor",d="version",m="architecture",g="console",p="mobile",f="tablet",h={has:function(e,t){return-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()}},_={rgx:function(){for(var e,t,o,i,s,c,l,u=0,d=arguments;u<d.length;u+=2){var m=d[u],g=d[u+1];if(typeof e===a){e={};for(i in g)s=g[i],typeof s===r?e[s[0]]=void 0:e[s]=void 0}for(t=o=0;t<m.length;t++)if(c=m[t].exec(this.getUA())){for(i=0;i<g.length;i++)l=c[++o],s=g[i],typeof s===r&&s.length>0?2==s.length?typeof s[1]==n?e[s[0]]=s[1].call(this,l):e[s[0]]=s[1]:3==s.length?typeof s[1]!==n||s[1].exec&&s[1].test?e[s[0]]=l?l.replace(s[1],s[2]):void 0:e[s[0]]=l?s[1].call(this,l,s[2]):void 0:4==s.length&&(e[s[0]]=l?s[3].call(this,l.replace(s[1],s[2])):void 0):e[s]=l?l:void 0;break}if(c)break}return e},str:function(e,t){for(var n in t)if(typeof t[n]===r&&t[n].length>0){for(var a=0;a<t[n].length;a++)if(h.has(t[n][a],e))return n===o?void 0:n}else if(h.has(t[n],e))return n===o?void 0:n;return e}},v={browser:{oldsafari:{major:{1:["/8","/1","/3"],2:"/4","?":"/"},version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2000:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",RT:"ARM"}}}},b={browser:[[/(opera\smini)\/((\d+)?[\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/((\d+)?[\w\.-]+)/i,/(opera).+version\/((\d+)?[\w\.]+)/i,/(opera)[\/\s]+((\d+)?[\w\.]+)/i],[c,d,i],[/\s(opr)\/((\d+)?[\w\.]+)/i],[[c,"Opera"],d,i],[/(kindle)\/((\d+)?[\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?((\d+)?[\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?((\d+)?[\w\.]*)/i,/(?:ms|\()(ie)\s((\d+)?[\w\.]+)/i,/(rekonq)((?:\/)[\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron)\/((\d+)?[\w\.-]+)/i],[c,d,i],[/(trident).+rv[:\s]((\d+)?[\w\.]+).+like\sgecko/i],[[c,"IE"],d,i],[/(yabrowser)\/((\d+)?[\w\.]+)/i],[[c,"Yandex"],d,i],[/(comodo_dragon)\/((\d+)?[\w\.]+)/i],[[c,/_/g," "],d,i],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?((\d+)?[\w\.]+)/i],[c,d,i],[/(dolfin)\/((\d+)?[\w\.]+)/i],[[c,"Dolphin"],d,i],[/((?:android.+)crmo|crios)\/((\d+)?[\w\.]+)/i],[[c,"Chrome"],d,i],[/version\/((\d+)?[\w\.]+).+?mobile\/\w+\s(safari)/i],[d,i,[c,"Mobile Safari"]],[/version\/((\d+)?[\w\.]+).+?(mobile\s?safari|safari)/i],[d,i,c],[/webkit.+?(mobile\s?safari|safari)((\/[\w\.]+))/i],[c,[i,_.str,v.browser.oldsafari.major],[d,_.str,v.browser.oldsafari.version]],[/(konqueror)\/((\d+)?[\w\.]+)/i,/(webkit|khtml)\/((\d+)?[\w\.]+)/i],[c,d,i],[/(navigator|netscape)\/((\d+)?[\w\.-]+)/i],[[c,"Netscape"],d,i],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?((\d+)?[\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/((\d+)?[\w\.-]+)/i,/(mozilla)\/((\d+)?[\w\.]+).+rv\:.+gecko\/\d+/i,/(uc\s?browser|polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|qqbrowser)[\/\s]?((\d+)?[\w\.]+)/i,/(links)\s\(((\d+)?[\w\.]+)/i,/(gobrowser)\/?((\d+)?[\w\.]+)*/i,/(ice\s?browser)\/v?((\d+)?[\w\._]+)/i,/(mosaic)[\/\s]((\d+)?[\w\.]+)/i],[c,d,i]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[m,"amd64"]],[/((?:i[346]|x)86)[;\)]/i],[[m,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[m,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[m,/ower/,"",h.lowerize]],[/(sun4\w)[;\)]/i],[[m,"sparc"]],[/(ia64(?=;)|68k(?=\))|arm(?=v\d+;)|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[m,h.lowerize]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[s,u,[l,f]],[/(hp).+(touchpad)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[u,s,[l,f]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[s,u,[l,p]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|huawei|meizu|motorola)[\s_-]?([\w-]+)*/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[u,s,[l,p]],[/\((bb10);\s(\w+)/i],[[u,"BlackBerry"],s,[l,p]],[/android.+((transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+))/i],[[u,"Asus"],s,[l,f]],[/(sony)\s(tablet\s[ps])/i],[u,s,[l,f]],[/(nintendo)\s([wids3u]+)/i],[u,s,[l,g]],[/((playstation)\s[3portablevi]+)/i],[[u,"Sony"],s,[l,g]],[/(sprint\s(\w+))/i],[[u,_.str,v.device.sprint.vendor],[s,_.str,v.device.sprint.model],[l,p]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w+)*/i,/(alcatel|geeksphone|huawei|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]+)*/i],[u,[s,/_/g," "],[l,p]],[/\s((milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?(:?\s4g)?))[\w\s]+build\//i,/(mot)[\s-]?(\w+)*/i],[[u,"Motorola"],s,[l,p]],[/android.+\s((mz60\d|xoom[\s2]{0,2}))\sbuild\//i],[[u,"Motorola"],s,[l,f]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n8000|sgh-t8[56]9))/i],[[u,"Samsung"],s,[l,f]],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i,/sec-((sgh\w+))/i],[[u,"Samsung"],s,[l,p]],[/(sie)-(\w+)*/i],[[u,"Siemens"],s,[l,p]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]+)*/i],[[u,"Nokia"],s,[l,p]],[/android\s3\.[\s\w-;]{10}((a\d{3}))/i],[[u,"Acer"],s,[l,f]],[/android\s3\.[\s\w-;]{10}(lg?)-([06cv9]{3,4})/i],[[u,"LG"],s,[l,f]],[/((nexus\s[45]))/i,/(lg)[e;\s-\/]+(\w+)*/i],[[u,"LG"],s,[l,p]],[/android.+((ideatab[a-z0-9\-\s]+))/i],[[u,"Lenovo"],s,[l,f]],[/(mobile|tablet);.+rv\:.+gecko\//i],[l,u,s]],engine:[[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[c,d],[/rv\:([\w\.]+).*(gecko)/i],[d,c]],os:[[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[c,[d,_.str,v.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[c,"Windows"],[d,_.str,v.os.windows.version]],[/\((bb)(10);/i],[[c,"BlackBerry"],d],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)\/([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego)[\/\s-]?([\w\.]+)*/i],[c,d],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[c,"Symbian"],d],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[c,"Firefox OS"],d],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[c,d],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[c,"Chromium OS"],d],[/(sunos)\s?([\w\.]+\d)*/i],[[c,"Solaris"],d],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[c,d],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[[c,"iOS"],[d,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i],[c,[d,/_/g,"."]],[/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(macintosh|mac(?=_powerpc)|plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos)/i,/(unix)\s?([\w\.]+)*/i],[c,d]]};if(UAParser=function(o){var n=o||(e&&e.navigator&&e.navigator.userAgent?e.navigator.userAgent:t);return this instanceof UAParser?(this.getBrowser=function(){return _.rgx.apply(this,b.browser)},this.getCPU=function(){return _.rgx.apply(this,b.cpu)},this.getDevice=function(){return _.rgx.apply(this,b.device)},this.getEngine=function(){return _.rgx.apply(this,b.engine)},this.getOS=function(){return _.rgx.apply(this,b.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(e){return n=e,this},void this.setUA(n)):new UAParser(o).getResult()},typeof exports!==a)typeof module!==a&&module.exports&&(exports=module.exports=UAParser),exports.UAParser=UAParser;else if(e.UAParser=UAParser,typeof define===n&&define.amd&&define(function(){return UAParser}),typeof e.jQuery!==a){var y=e.jQuery,k=new UAParser;y.ua=k.getResult(),y.ua.get=function(){return k.getUA()},y.ua.set=function(e){k.setUA(e);var t=k.getResult();for(var o in t)y.ua[o]=t[o]}}}(),function(e,t){var o,n,a,r;o=e.createElement("script"),o.type="text/javascript",o.async=!0,o.src="https://api.mixpanel.com/site_media/js/api/mixpanel.2.js",n=e.getElementsByTagName("script")[0],n.parentNode.insertBefore(o,n),t._i=[],t.init=function(e,o,n){var i=t;for("undefined"!=typeof n?i=t[n]=[]:n="mixpanel",a="disable track track_pageview track_links track_forms register register_once unregister identify name_tag set_config".split(" "),r=0;r<a.length;r++)(function(e){i[e]=function(){i.push([e].concat(Array.prototype.slice.call(arguments,0)))}})(a[r]);t._i.push([e,o,n])},window.mixpanel=t}(document,[]),mixpanel.init(FA_Config_mixpanel,{track_pageview:!1,api_host:"https://api.mixpanel.com"}),PB.getUAParser=function(){return void 0===PB.uaParser&&"undefined"!=typeof UAParser&&(PB.uaParser=new UAParser),PB.uaParser},PB.normalizedUAData=function(){var e=PB.getUAParser(),t=e&&e.getOS(),o=e&&e.getBrowser();return{os:t&&t.name,os_version:t&&t.version,browser:o&&o.name,browser_version:o&&o.version}},PB.metrics=function(){function e(e){var t=PB.normalizedUAData();return{event:e,member_id:o||0,pb_id:AB.distinct_id,os:t.os,os_version:t.os_version,browser:t.browser,browser_version:t.browser_version,network:AB.p,target:PB.config.target}}function t(e){var t={};for(var o in e)_.contains(["object","function"],typeof e[o])||(t[o]=encodeURIComponent(e[o]));return t}var o=null;"undefined"!=typeof FA&&FA.Background&&FA.Background.fa_member_id?o=FA.Background.fa_member_id:"undefined"!=typeof PB&&PB.member&&PB.member.id&&(o=PB.member.id);var n="https://metrics.passwordbox.com/ping?",a=[];return{ping:function(o){function r(o){if(o){var a=e(o),r=n+$.param(t(a));$.ajax({url:r,cache:!1})}}if("startpage_impression"===o){if("undefined"!=typeof Browser&&Browser.firefox)return void(o&&Browser.metrics_ping(o));if(o&&a.push(o),!(PB.utils&&PB.utils.isWelcomeFlow&&PB.utils.isWelcomeFlow())||"undefined"!=typeof pbExtMetricsReadySignal&&pbExtMetricsReadySignal)for(;a.length;)r(a.shift())}}}}(),PB.viralninjas={events:{login_view:{viralninjas:"ImportationForm",mixpanel:"VN_login_page_view"},contacts_imported:{viralninjas:"ContactSelectionForm",mixpanel:"VN_contacts_page_view"},invites_sent:{viralninjas:"ConfirmationSentForm",mixpanel:"VN_sent_page_view"}},track:function(e,t){var o=this;if(this.events[e]){var n={page_type:this.events[e].viralninjas};return _.isObject(t)&&_.extend(n,t),this.sendTrackEvent(n,function(){o.logMixpanel(e,n)}),{event:n}}PB.utils.log("Unknown viral event:",e)},logMixpanel:function(e,t){var o={},n=this.events[e]&&this.events[e].mixpanel;for(var a in t)t.hasOwnProperty(a)&&(o["vn_"+a]=t[a]);PB.mixpanel.track(n,o)},sendTrackEvent:function(e,t,o){$.ajax({type:"POST",url:"/api/0/viral/track.json",data:e,success:function(e){PB.utils.log("VIRALNINJAS REQUEST:"),PB.utils.log(e),t&&t.call(this,e)},error:function(t){PB.utils.log("Failed to track viral event:",e),o&&o.call(this,t)}})}},PB.at=new function(){this.test=function(e){$.ajax({url:"https://at.passwordbox.com/test",data:{data:e}})}},PB.mixpanel=new function(){this.policy=null;var e=[],t=function(e,t){if(t=PB.mixpanel.extend(t),"distinct_id"in t&&(t.d_id=t.distinct_id),t.stack&&(t.stack=t.stack.replace(/\(.*\)/g,";").replace(/at\s/g,"").replace(/\n/g,"").replace(/\s/g,"")),"undefined"!=typeof Browser&&Browser.firefox)Browser.mixpanel_track(e,t);else if("undefined"!=typeof mixpanel){mixpanel.track(PB.mixpanel.events[e].text,t);var o=t;o.event_id=e}else"undefined"!=typeof chrome&&chrome.extension?chrome.extension.sendMessage({message:"track",args:{name:e,params:t}}):console.error("Cannot track: No channel found")},o=function(){_.contains(["development","staging","lab","staging3"],PB.config.env)&&mixpanel.set_config({debug:!0})};this.init=function(){mixpanel.init.apply(mixpanel,arguments),o()},this.release=function(){_.each(e,function(e){t(e[0],e[1])}),e=[]},this.extend=function(e){e=e||{};var t=this.policy?this.policy():{};if(e=_.extend({},t,e),"undefined"!=typeof AB){var o=PB.normalizedUAData();AB.browser=o.browser,AB.browser_version=o.browser_version,AB.os=AB.os_name=o.os,AB.os_version=o.os_version,e=_.extend({},AB,e)}return e},this.track=function(o,n){return o=o||"",n=n||{},o in PB.mixpanel.events?void("undefined"!=typeof PB&&PB.isDisabled||("undefined"==typeof identityManager||identityManager.inited?(this.release(),t(o,n)):e.push([o,n]))):(console.warn("Unknown event : "+o),!1)},this.track_activity=function(){PB.mixpanel.track.apply(this,arguments)}},function(){var e={perform_activity:"Performed activity",perform_tab_activity:"Performed tab activity",log_in:"Logged in",attempted_log_in:"Attempted log in",create_password:"Created new password",edit_password:"Edited a password",delete_password:"Deleted password",bequeath_box:"Bequeathed box",invite_user:"Invited new contact",share_password:"Shared password",im_alive:"i'm alive",id_switched:"Switching distinct_id",logged_in_external_placement:"Logged in from external placement",copied_asset_to_clipboard:"Copied asset to clipboard",copied_username_to_clipboard:"Copied username to clipboard",viewed_clear_password:"Viewed clear password","viewed_in-app_screen":"Viewed screen",accessed_website_from_extension:"Accessed website from extension",created_new_document:"Created new document",generated_password:"Generated new password",sms_device_sync:"Sent sync SMS to mobile device",email_device_sync:"Sent sync Email",imported_passwords:"Imported passwords",crypto_error:"crypto error",download_extension:"Clicked download",engagement_modal_share_action:"Shared from engagement modal",engagement_modal_chrome_rate:"Rated on chrome store from engagement modal",engagement_modal_wallet_add:"Added to wallet from engagement modal",updated_chrome_browser_version:"Updated Chrome Browser Version",did_not_disable:"Did not disable",one_click_login:"One-click login from StartPage",one_click_website:"Accessed website from StartPage",one_click_app:"Accessed app from StartPage",custom_search:"Custom search",add_website:"Added new site to StartPage",websites_tab:"Clicked on 'websites' view",apps_tab:"Clicked on 'apps' view",chrome_sync:"Clicked on Chrome sync",config_click:"Opened config",app_config_save:"Saved details in StartPage",connect_with_chrome:"Connected to a Google Chrome account",installed_launchramp:"Installed StartPage",launchramp_search:"StartPage search",startpage_login:"Login from StartPage",deleted_favorite:"Removed a favorite from StartPage",modified_grid:"Modified the StartPage favorites",edited_website_from_startpage:"Edited website from StartPage",landing_page_view:"Viewed landing page",download_page_view:"Viewed download page",signup:"Signed up",signup_click:"Clicked sign up",download_extension:"Clicked download",install_extension:"Installed extension",page_view:"Viewed page",clear_bequeath:"Cleared bequeath in sign up",create_master_password:"Created master password",confirm_email:"Confirmed email",accept_invitation:"Accepted invitation",invitation_email_click:"Clicked invitation email",auto_login:"Auto-logged in with extension",bulk_create_password:"Bulk passwords created",in_page_viewed:"Viewed a in-page action",account_login:"Logged into a saved account",import_password_shown:"Import password shown",import_password_accepted:"Import password accepted",import_password_declined:"Import password declined",click_inpage_cta:"Clicked In-page Call-To-Action",fillForm:"Form automatically filled",submitForm:"Submitted login form automatically",disabledLoginPrompt:"Disabled login prompt",viewed_overlay:"Viewed overlay",clicked_overlay:"Clicked on overlay",dismissed_overlay:"Dismissed overlay",mobile_app_install:"Installed mobile app",mobile_welcome_view:"Viewed mobile welcome page",mobile_welcome_video:"Clicked mobile welcome video",mobile_signup_click:"Clicked to create account",confirm_master_password:"Viewed confirm password page",signed_up:"Signed up",mobile_tour_complete:"Completed mobile tour",add_first_password_view:"Viewed first password flow",one_tap_login:"Performed first one tap login",account_login:"Logged into a saved account",mobile_search:"Performed mobile web search",mobile_website_visit:"Visited website on mobile",mobile_app_focus:"Opened mobile app",debugging:"debugging",accessed_rewards_screen:"Accessed rewards screen",completed_reward_task:"Completed a reward task",exp_report_website:"Experimental: reported a broken website",ml_atlas_api_error:"Experimental: Atlas data could not be retrieved",ml_bad_experiences:"Experimental: ML Bad Experiences",exp_pw_user_filled:"Password not classified by form filling",exp_feedback_from_users:"Sent feedback through webpage"};PB.mixpanel.events={};for(var t in e){var o=e[t];PB.mixpanel.events[t]={text:o}}}(),PB="undefined"==typeof PB?{}:PB,PB.Algorithms=PB.Algorithms||{},PB.Algorithms.Favorites={get:function(e,t,o){var n={"mail.yahoo.com":null,"rocketmail.com":"mail.yahoo.com","ymail.com":"mail.yahoo.com","login.yahoo.com":"mail.yahoo.com","gmail.com":"accounts.google.com/ServiceLogin?service=mail","mail.google.com":"accounts.google.com/ServiceLogin?service=mail","accounts.google.com/ServiceLogin?service=mail":null,"hotmail.com":"outlook.com","outlook.com":null,"login.live.com":"outlook.com","mail.live.com":"outlook.com","live.com":"outlook.com","mail.com":null,"my.screenname.aol.com":null,"mail.lycos.com":null,"gmx.com":null,"inbox.com":null,"care2.com":null,"hushmail.com":null,"zoho.com":null,"shortmail.com":null,"bigstring.com":null,"lavabit.com":null,"registration.myway.com":null},a={"twitter.com":null,"tweetdeck.com":null},r={"youtube.com":null,"netflix.com":null,"hulu.com":null},i={"weather.com":null,"accuweather.com":null,"weather.yahoo.com":null,"intellicast.com":null,"weather.yahoo.com":null,"theweathernetwork.com":null,"wunderground.com":null,"weather.gov":null},s={"amazon.com":null,"ebay.com":null},c={"discover.com":null,"statefarm.com":null,"usaa.com":null,"ally.com":null,"oldnational.com":null,"citizensbank.com":null,"us.etrade.com":null,"everbank.com":null,"nationwide.com":null,"dollarbank.com":null,"jpmorgan.com":null,"citibank.com":null,"goldmansachs.com":null,"morganstanleyclientserv.com":null,"metlife.com":null,"hsbc.com":null,"td.com":null,"usbank.com":null,"pnc.com":null,"capitalone.com":null,"bankofamerica.com":null,"chase.com":null,"wellsfargo.com":null,"clickbank.com":null,"icicibank.com":null},l={"news.yahoo.com":null,"cnn.com":null,"huffingtonpost.com":null,"bbc.co.uk":null,"nytimes.com":null,"reddit.com":null,"news.google.com":null,"foxnews.com":null,"guardian.co.uk":null,"nbcnews.com":null,"my.yahoo.com":null,"online.wsj.com":null,"timesofindia.indiatimes.com":null,"reuters.com":null,"forbes.com":null,"washingtonpost.com":null,"drudgereport.com":null,"usatoday.com":null,"abcnews.go.com":null,"bloomberg.com":null,"latimes.com":null,"money.cnn.com":null,"cbsnews.com":null,"examiner.com":null,"time.com":null},u={"maps.google.com":null,"mapquest.com":null,"mapblast.com":null,"maps.google.com":null,"bing.com/maps":null,"viamichelin.fr":null,"maps.yahoo.com":null},d=["twitter.com","cnn.com","youtube.com","ebay.com","wikipedia.org","amazon.com","store.apple.com","linkedin.com","live.com","bing.com","microsoft.com","pinterest.com","tumblr.com"],m=function(){return _.each(e,function(t,o){e[o]=t.replace("https://",""),e[o]=t.replace("http://","")}),e||[]},g=function(){var e=o||PB.startpage.get_user_data().bookmarks;return _.map(e,function(e){return e.url})},p=function(){var e=[],o=g();_.each(o,function(t){e.push({url:t})});var n=t||PB.startpage.get_user_data().mostVisited;return _.each(n,function(t){e.push(t)}),e=_.uniq(_.map(e,function(e){return e.url=e.url.replace("http://",""),e.url=e.url.replace("https://",""),e}),!1,function(e){return e.url}),e=_.sortBy(e,function(e){var t=!1;return _.each(o,function(o){var n=o.split("://").pop();n=n.replace("www.",""),n=n.split("/")[0],n=n.split("."),n=n.slice(-2).join("."),e.url.indexOf(n)>-1&&(t=!0)}),e.visitCount=e.visitCount||0,t&&(e.visitCount+=1e3),-e.visitCount}),t=_.sortBy(t,function(e){return!1}),_.map(e,function(e){return e.url})},f=function(e,t,o){var n=!1;return _.each(t,function(t){n||_.each(o,function(o,a){if(!n&&t.indexOf(a)>=0){var r=!1;o=null===o?a:o,_.each(e,function(e){e.indexOf(o)>=0&&(r=!0)}),r||(n=!0,e.push(o))}})}),n?e:!1},h=function(e,t){return t=t||7,e.length>=t?e=e.slice(0,t):e.length<t&&_.each(d,function(o){!_.contains(e,o)&&e.length<t&&e.push(o)}),e.slice(0,t)},v=function(e,t){var o={US:"zappos.com",CA:"officedepot.ca",RU:"aliexpress.com",CN:"aliexpress.com",IN:"aliexpress.com",ES:"aliexpress.com",ID:"aliexpress.com",PK:"aliexpress.com",MX:"aliexpress.com"},n=_.indexOf(e,"amazon.com");return-1!==n&&(o[t]?e[n]=o[t]:e[n]="newegg.com"),e},b=m(),t=p();_.contains(b,"ebay.com")||b.push("ebay.com"),_.contains(b,"amazon.com")||b.push("amazon.com"),_.contains(b,"facebook.com")||b.push("facebook.com"),b=f(b,t,n)||b,b=f(b,t,{"calendar.google.com":"accounts.google.com/ServiceLogin?service=cl","accounts.google.com/ServiceLogin?service=cl":null,"google.com/calendar":"accounts.google.com/ServiceLogin?service=cl"})||f(b,t,n)||b,b=f(b,t,a)||b,b=f(b,t,r)||b,b=f(b,t,i)||b,b=f(b,t,s)||b,b=f(b,t,c)||b,b=f(b,t,l)||b,b=f(b,t,u)||b,b=h(b,7),_.each(b,function(e,t){e.toLowerCase().indexOf("accounts.google.com/servicelogin?service=mail")>=0?b[t]="accounts.google.com/ServiceLogin?service=mail":e.toLowerCase().indexOf("mail.google.com")>=0?b[t]="accounts.google.com/ServiceLogin?service=mail":e.toLowerCase().indexOf("gmail.com")>=0&&(b[t]="accounts.google.com/ServiceLogin?service=mail")});var y="US";return PB.Browser&&PB.Browser.get_bg_data()?y=PB.Browser.get_bg_data().locale.toUpperCase():get_bg_data()&&(y=get_bg_data().locale.toUpperCase()),b=v(b,y)}},PB="undefined"!=typeof PB?PB:{},PB.member=function(){"use strict";var e={};return e.changeMasterPassword=function(e){return new Promise(function(t,o){function n(e){s=e,PB.Worker.spawnCrypto({fn:"Crypto.computeDerivedPassword",params:{password:u,email:d}},a)}function a(e){c=e,PB.Worker.spawnCrypto({fn:"Crypto.computeKey",params:{salt:m,password:u,rules:PB.Authentication.settings.derivationRules.get()}},r)}function r(e){var t=PB.crypto.AES.encrypt(FA.Background.fa_member.key,e);PB.API.request({path:"/members/change_master_password",type:"POST",data:{k_kek:t,auth_key:c,old_auth_key:s}},i)}function i(e){var n;if(e.error){var a="";try{n=JSON.parse(e.data.responseText),a=n.error_code}catch(r){}return"password_mismatch"!==a&&(a="request_error"),o(new Error(a))}var n=e.data;FA.Background.fa_member.attributes.k_kek=e.data.k_kek,PB.Authentication.settings.legacyAuth(d).clearIt(),PB.Worker.spawnCrypto({fn:"Crypto.computeLocalDataKey",params:{base:u,salt:m}},function(e){PB.SessionData.localStorageKey=e,PB.LocalData.save()}),t()}if(e=PB.validation(e,{oldPassword:{required:!0,type:"string"},password:{required:!0,type:"string"}}),e._errors)return o(new PB.Error({code:"invalid_params",message:e._errorMessage,data:e._errors}));var s,c,l=e.oldPassword,u=e.password,d=FA.Background.fa_member.get("email"),m=FA.Background.fa_member.get("salt");PB.Authentication.settings.legacyAuth(d).isActive?n($.sha1(l)):PB.Worker.spawnCrypto({fn:"Crypto.computeDerivedPassword",params:{
password:l,email:d}},n)})},e.initRsaKeys=function(e){return new Promise(function(t,o){function n(e){var t,n=PB.crypto.RSA.makeKeys(e);try{t=PB.crypto.AES.encrypt(JSON.stringify(n.jsonPrivateKey),FA.Background.fa_member.key)}catch(r){return o(new PB.Error({code:"rsa_key_encryption_error"}))}var i=JSON.stringify(n.jsonPublicKey);PB.API.request({path:"/members/"+FA.Background.fa_member.id+"/rsa_key",type:"POST",data:{private_key:t,public_key:i}},a)}function a(e){var n={};if(e.error){var a="";try{n=JSON.parse(e.data.responseText),a=n.error}catch(r){console.log(r)}if("rsa_keys_exist"!==n.error_code)return o(new PB.Error({code:"request_error",data:n}));n=n.data}else n=e.data;FA.Background.fa_member.set(n),t()}if(e=PB.validation(e,{overwrite:{type:"boolean"}}),e._errors)return o(new PB.Error({code:"invalid_params",message:e._errorMessage,data:e._errors}));var r=FA.Background.fa_member,i=r&&r.get("email_verification")||{};return i.verified_at?r&&r.get("private_key")?o(new PB.Error({code:"rsa_keys_exist"})):void PB.Worker.spawnCrypto({fn:"Crypto.RSA.generate",params:{length:2048}},n):o(new PB.Error({code:"email_unverified"}))})},e}(),"undefined"!=typeof module&&(module.exports=PB.member),FA={Collections:{},Models:{},Routers:{},Views:{App:{},Chrome:{},Assets:{},Secrets:{},Contacts:{},BlockedItems:{}},getDomainFromUrl:function(e){if(!e)return e;var t=document.createElement("a");return t.href=e.toLowerCase(),t.hostname.replace(/^www\./i,"").replace(/accounts\.google/i,"google").replace(/login\.yahoo/i,"yahoo").replace(/wwws\.mint/i,"mint")},isDomainInTopDomain:function(e,t){var o=new RegExp("\\."+t+"$");return o.test("."+e)},isUrlInTopDomain:function(e,t){return domain=FA.getDomainFromUrl(e),FA.isDomainInTopDomain(domain,t)},getVirtualPassword:function(e){return""},isJson:function(e){try{return e.length<2?!1:(json=JSON.parse(e),!0)}catch(t){return!1}},getLoginFromForm:function(e,t){try{var o=null,n=null;return e=_.filter(e,function(e){return"hidden"!=e.type&&"checkbox"!=e.type}),_.each(e,function(e){if(t&&0==e.value.length)return!1;if(["text","email","phone"].indexOf(e.type)>-1){if(n=e,["username","login","email","pbResetPasswordFakeInput"].indexOf(e.name)>-1)return o=e,!1}else if("password"==e.type)return o=n,!1}),o}catch(a){console.error(a)}},getPasswordFromForm:function(e,t){try{var o=null;return e=_.filter(e,function(e){return"hidden"!=e.type}),_.each(e,function(e){return t&&0==e.value.length?!1:"password"==e.type?(o=e,!1):void 0}),o}catch(n){console.error(n)}},isValidAssetUrl:function(e){return regexp=/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/,regexp.test(e)},isEmail:function(e){return regex=/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/,regex.test(e)?!0:!1}},FA=FA||{},FA.Crypto={encryptWithAES:function(e,t){return Aes.Ctr.encrypt(e,t,256)},decryptWithAES:function(e,t){return Aes.Ctr.decrypt(e,t,256)},makeRsaKeys:function(e){return oPubRSA={},oPrivRSA={},oPubRSA.n=e.n.toString(16),oPubRSA.e=e.e.toString(16),oPrivRSA.n=e.n.toString(16),oPrivRSA.e=e.e.toString(16),oPrivRSA.d=e.d.toString(16),oPrivRSA.p=e.p.toString(16),oPrivRSA.q=e.q.toString(16),oPrivRSA.dmp1=e.dmp1.toString(16),oPrivRSA.dmq1=e.dmq1.toString(16),oPrivRSA.coeff=e.iqmp.toString(16),rsaKey={jsonPublicKey:oPubRSA,jsonPrivateKey:oPrivRSA},rsaKey},encryptWithRSA:function(e,t){return rsa=new RSAKey,oRSA=t,rsa.setPublic(oRSA.n,oRSA.e),res=rsa.encrypt(e),res?res:null},decryptWithRSA:function(e,t){return rsa=new RSAKey,oRSA=t,rsa.setPrivateEx(oRSA.n,oRSA.e,oRSA.d,oRSA.p,oRSA.q,oRSA.dmp1,oRSA.dmq1,oRSA.coeff),res=rsa.decrypt(e),res?res:null}},"mobile-native-iphone"==PB.config.target?_.extend(FA,{u:function(){var e=JSON.parse(FA.Crypto.decryptWithAES(PB.settings.profile.get(),"profilePictureData")),t=JSON.parse(FA.Crypto.decryptWithAES(PB.settings.key.get(),"profilePictureData"));return _.extend(FA.Background,e,t),PB.Public.nativeAutoLoginCb&&PB.Public.nativeAutoLoginCb.notify(_.extend({},e,t)),!0}}):_.extend(FA,{u:function(){return _.extend(FA.Background,JSON.parse(FA.Crypto.decryptWithAES(PB.settings.profile.get(),"profilePictureData"))),_.extend(FA.Background,JSON.parse(FA.Crypto.decryptWithAES(PB.settings.key.get(),"profilePictureData"))),FA.Background.doLogin({email:FA.Background.fa_login,cpassword:FA.Background.fa_cpassword,isRememberMe:!0},function(e){return"desktop-extension-safari"==PB.config.target&&e&&safari.extension.popovers[0].contentWindow.Backbone.history.navigate("my_passwordbox",!0),PB.Public.nativeAutoLoginCb&&PB.Public.nativeAutoLoginCb.notify(!!e),e?void 0:!1},null,!0),!0}}),_.extend(FA,{v:function(e){return e&&(PB.settings.profile.set(FA.Crypto.encryptWithAES(JSON.stringify({fa_login:FA.Background.fa_login,fa_cpassword:FA.Background.fa_cpassword,fa_member_id:FA.Background.fa_member_id,fa_member_name:FA.Background.fa_member_name,welcome:FA.Background.welcome,member_id:FA.Background.fa_member.id,member_cid:FA.Background.fa_member.cid,member_key:FA.Background.fa_member.key,offline_key:FA.Background.offline_key||null}),"profilePictureData")),PB.settings.key.set(FA.Crypto.encryptWithAES(JSON.stringify({fa_rsaKey:FA.Background.fa_rsaKey}),"profilePictureData"))),!0}}),FA.Categories={allSites:{Facebook:{matchDomain:"facebook.com$",url:"http://www.facebook.com",name:"Facebook",icon:"facebook-32x32.png",logo_key:"facebook"},Google:{matchDomain:"google.com$",url:"https://www.google.com/accounts/servicelogin",name:"Google",icon:"google-32x32.png",logo_key:"google"},Linkedin:{matchDomain:"linkedin.com$",url:"http://www.linkedin.com",name:"Linkedin",icon:"linkedin-32x32.png",logo_key:"linkedin"},Ebay:{matchDomain:"ebay.com$",url:"https://signin.ebay.com/ws/eBayISAPI.dll",name:"eBay",icon:"ebay-32x32.png",logo_key:"ebay"},Twitter:{matchDomain:"twitter.com$",url:"http://twitter.com",name:"Twitter",icon:"twitter-32x32.png",logo_key:"twitter"},Skype:{matchDomain:"skype.com$",url:"https://login.skype.com/",name:"Skype",icon:"skype-32x32.png",logo_key:"skype"},Itunes:{matchDomain:"apple.com$",url:"http://www.apple.com",name:"Itunes",icon:"itunes-32x32.png",logo_key:"itunes"},Youtube:{matchDomain:"google.com$",url:"https://www.google.com/accounts/servicelogin?uilel=3&service=youtube",name:"Youtube",icon:"youtube-32x32.png",logo_key:"youtube"},Paypal:{matchDomain:"paypal.com$",url:"http://www.paypal.com/",name:"Paypal",icon:"paypal-32x32.png",logo_key:"paypal"},Gmail:{matchDomain:"gmail.com$",url:"http://accounts.google.com/",name:"Gmail",icon:"gmail-32x32.png",logo_key:"gmail"},Yahoo:{matchDomain:"yahoo.com$",url:"https://login.yahoo.com/config/login",name:"Yahoo",icon:"yahoo-32x32.png",logo_key:"yahoo"},Aol:{matchDomain:"aol.com$",url:"https://my.screenname.aol.com/",name:"Aol",icon:"aol-32x32.png",logo_key:"aol"},Hotmail:{matchDomain:"hotmail.com$",url:"http://www.hotmail.com/",name:"Hotmail",icon:"hotmail-32x32.png",logo_key:"hotmail"},Me:{matchDomain:"me.com$",url:"https://www.me.com/",name:"Me",icon:"me-32x32.png",logo_key:"mobileme"},Blogger:{matchDomain:"google.com$",url:"https://www.google.com/accounts/servicelogin?service=blogger",name:"Blogger",icon:"blogger-32x32.png",logo_key:"blogger"},Tumblr:{matchDomain:"tumblr.com$",url:"http://www.tumblr.com/login",name:"Tumblr",icon:"tumblr-32x32.png",logo_key:"tumblr"},Wordpress:{matchDomain:"wordpress.org$",url:"http://www.wordpress.org",name:"Wordpress",icon:"wordpress-32x32.png",logo_key:"wordpress"},Typepad:{matchDomain:"typepad.com$",url:"https://www.typepad.com/secure/services/signin?to=%2fdashboard",name:"Typepad",icon:"typepad-32x32.png",logo_key:"typepad"},Live:{matchDomain:"live.com$",url:"https://login.live.com/login.srf",name:"Live",icon:"live-32x32.png",logo_key:"live"},Imdb:{matchDomain:"imdb.com$",url:"https://secure.imdb.com/register-imdb/login",name:"Imdb",icon:"imdb-32x32.png",logo_key:"imdb"},Yelp:{matchDomain:"yelp.com$",url:"https://www.yelp.com/login?return_url=%2f",name:"Yelp",icon:"yelp-32x32.png",logo_key:"yelp"},Myspace:{matchDomain:"myspace.com$",url:"https://www.myspace.com/auth/form",name:"MySpace",icon:"myspace-32x32.png",logo_key:"myspace"},Digg:{matchDomain:"digg.com$",url:"http://digg.com/login",name:"Digg",icon:"digg-32x32.png",logo_key:"digg"},Xing:{matchDomain:"xing.com$",url:"http://www.xing.com/",name:"Xing",icon:"xing-32x32.png",logo_key:"xing"},Orkut:{matchDomain:"google.com$",url:"https://www.google.com/accounts/servicelogin?service=orkut",name:"Orkut",icon:"orkut-32x32.png",logo_key:"orkut"},Hi5:{matchDomain:"hi5.com$",url:"http://hi5.com/friend/displaylogin.do",name:"Hi5",icon:"hi5-32x32.png",logo_key:"hi5"},Friendster:{matchDomain:"friendster.com$",url:"http://www.friendster.com/",name:"Friendster",icon:"friendster-32x32.png",logo_key:"friendster"},Bebo:{matchDomain:"bebo.com$",url:"http://www.bebo.com/signin.jsp",name:"Bebo",icon:"bebo-32x32.png",logo_key:"bebo"},Delicious:{matchDomain:"delicious.com$",url:"https://secure.delicious.com/login?jump=ub",name:"Delicious",icon:"delicious-32x32.png",logo_key:"delicious"},Ning:{matchDomain:"ning.com$",url:"https://www.ning.com/main/signin?target=http%3a%2f%2fwww.ning.com%2f",name:"Ning",icon:"ning-32x32.png",logo_key:"ning"},Reddit:{matchDomain:"reddit.com$",url:"http://www.reddit.com/",name:"Reddit",icon:"reddit-32x32.png",logo_key:"reddit"},Stumbleupon:{matchDomain:"stumbleupon.com$",url:"http://www.stumbleupon.com/login.php",name:"StumbleUpon",icon:"stumbleupon-32x32.png",logo_key:"stumbleupon"},Technorati:{matchDomain:"technorati.com$",url:"http://technorati.com/account/login/",name:"Technorati",icon:"technorati-32x32.png",logo_key:"technorati"},Dropbox:{matchDomain:"dropbox.com$",url:"https://www.dropbox.com/login",name:"Dropbox",icon:"dropbox-32x32.png",logo_key:"dropbox"},Picasa:{matchDomain:"google.com$",url:"http://picasaweb.google.com",name:"Picasa",icon:"picasa-32x32.png",logo_key:"picasa"},Youtube:{matchDomain:"google.com$",url:"https://www.google.com/accounts/servicelogin?uilel=3&service=youtube",name:"Youtube",icon:"youtube-32x32.png",logo_key:"youtube"},Netflix:{matchDomain:"netflix.com$",url:"https://signup.netflix.com/login",name:"Netflix",icon:"netflix-32x32.png",logo_key:"netflix"},Flickr:{matchDomain:"flickr.com$",url:"http://www.flickr.com/signin/",name:"Flickr",icon:"flickr-32x32.png",logo_key:"flickr"},Itunes:{matchDomain:"apple.com$",url:"http://www.apple.com",name:"Itunes",icon:"itunes-32x32.png",logo_key:"itunes"},Photobucket:{matchDomain:"photobucket.com$",url:"http://photobucket.com/login",name:"Photobucket",icon:"photobucket-32x32.png",logo_key:"photobucket"},Pandora:{matchDomain:"pandora.com$",url:"http://www.pandora.com/login.vm?target=",name:"Pandora",icon:"pandora-32x32.png",logo_key:"pandora"},Vimeo:{matchDomain:"vimeo.com$",url:"http://vimeo.com/log_in",name:"Vimeo",icon:"vimeo-32x32.png",logo_key:"vimeo"},Lastfm:{matchDomain:"last.fm$",url:"https://www.last.fm/login",name:"last.fm",icon:"lastfm-32x32.png",logo_key:"lastfm"},Paypal:{matchDomain:"paypal.com$",url:"http://www.paypal.com/",name:"Paypal",icon:"paypal-32x32.png",logo_key:"paypal"},Bmo:{matchDomain:"bmo.com$",url:"https://www13.bmo.com/cgi-bin/netbnx/nbmain?product=1",name:"BMO",icon:"bmo-32x32.png",logo_key:"bmo"},Caissesdesjardins:{matchDomain:"desjardins.com$",url:"https://accesd.desjardins.com/",name:"Desjardins",icon:"caissesdesjardins-32x32.png",logo_key:"desjardins"},Cibc:{matchDomain:"cibc.com$",url:"https://www.cibconline.cibc.com/olbtxn/authentication/presignon.cibc",name:"CIBC",icon:"cibc-32x32.png",logo_key:"cibc"},Hsbc:{matchDomain:"hsbc.ca$",url:"https://www.hsbc.ca/1/2/pib_hub_idv_hidden/pib_hubidvprecustomermigration_hidden?__iwlang=en&__iwcountry=us",name:"HSBC",icon:"hsbc-32x32.png",logo_key:"hsbc"},Laurentian:{matchDomain:"banquelaurentienne.ca$",url:"https://www.banquelaurentienne.ca",name:"Laurentian",icon:"laurentian-32x32.png",logo_key:"laurentian_bank"},Nationalbank:{matchDomain:"bnc.ca$",url:"https://bvi.bnc.ca/auth/login",name:"National Bank",icon:"nationalbank-32x32.png",logo_key:"nationalbank"},Royalbank:{matchDomain:"royalbank.com$",url:"https://www1.royalbank.com/cgi-bin/rbaccess/rbunxcgi?f6=1&f7=ib&f21=ib&f22=ib&request=clientsignin",name:"Royal Bank",icon:"royalbank-32x32.png",logo_key:"rbc"},Scotiabank:{matchDomain:"scotiabank.com$",url:"https://www.scotiaonline.scotiabank.com/online/start.jsp?language=",name:"Scotia Bank",icon:"scotiabank-32x32.png",logo_key:"scotiabank"},Tdbank:{matchDomain:"td.com$",url:"https://easywebcpo.td.com/waw/idp/login.htm",name:"TD Bank",icon:"tdbank-32x32.png",logo_key:"td"},Ing:{matchDomain:"ing.us$",url:"http://ing.us/account-login",name:"ING",icon:"ing-32x32.png",logo_key:"ing"},Bankamerica:{matchDomain:"bankofamerica.com$",url:"https://sitekey.bankofamerica.com/sas/signonscreen.do?state=ga",name:"Bank of America",icon:"bankamerica-32x32.png",logo_key:"bankofamerica"},Jpmorganchase:{matchDomain:"jpmorganchase.com$",url:"http://www.jpmorganchase.com/",name:"Chase",icon:"jpmorganchase-32x32.png",logo_key:"jpmorgan"},Citi:{matchDomain:"citibank.com$",url:"https://online.citibank.com/us/jps/portal/index.do",name:"Citigroup",icon:"citi-32x32.png",logo_key:"citi"},Wellsfargo:{matchDomain:"wellsfargo.com$",url:"https://online.wellsfargo.com/signon?lob=cons",name:"Wells Fargo",icon:"wellsfargo-32x32.png",logo_key:"wellsfargo"},Goldmansachs:{matchDomain:"goldmansachs.com$",url:"http://www2.goldmansachs.com",name:"Goldman Sachs",icon:"goldmansachs-32x32.png",logo_key:"goldmansachs"},Morganstanley:{matchDomain:"morganstanleyclientserv.com$",url:"https://www.morganstanleyclientserv.com/",name:"Morgan Stanley",icon:"morganstanley-32x32.png",logo_key:"morganstanley"},Metlife:{matchDomain:"metlife.com$",url:"http://www.metlife.com",name:"Metlife",icon:"metlife-32x32.png",logo_key:"metlife"},Barclays:{matchDomain:"barclaycardus.com$",url:"https://www.barclaycardus.com/app/ccsite/logon/loginuserdyn.jsp",name:"Barclays Group",icon:"barclays-32x32.png",logo_key:"barclays"},Adsense:{matchDomain:"google.com$",url:"https://www.google.com/adsense/",name:"AdSense",icon:"adsense-32x32.png",logo_key:"googleadsense"},Amazon:{matchDomain:"amazon.com$",url:"https://www.amazon.com/ap/signin?_encoding=UTF8&openid.assoc_handle=usflex&openid.claimed_id=http%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select&openid.identity=http%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select&openid.mode=checkid_setup&openid.ns=http%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0&openid.ns.pape=http%3A%2F%2Fspecs.openid.net%2Fextensions%2Fpape%2F1.0&openid.pape.max_auth_age=0&openid.return_to=https%3A%2F%2Fwww.amazon.com%2Fgp%2Fyourstore%2Fhome%3Fie%3DUTF8%26ref_%3Dgno_signin",name:"Amazon",icon:"amazon-32x32.png",logo_key:"amazon"},Godaddy:{matchDomain:"godaddy.com$",url:"http://www.godaddy.com/",name:"Godaddy",icon:"godaddy-32x32.png",logo_key:"godaddy"},Craigslist:{matchDomain:"craigslist.org$",url:"https://accounts.craigslist.org/",name:"Craigslist",icon:"craigslist-32x32.png",logo_key:"craigslist"}},getSite:function(e){return this.allSites[e]},getCategories:function(){return{Popular:["Facebook","Google","Linkedin","Ebay","Twitter","Skype","Itunes","Youtube","Paypal"],Social:["Facebook","Twitter","Blogger","Tumblr","Wordpress","Typepad","Live","Linkedin","Imdb","Yelp","Myspace","Digg","Xing","Skype","Orkut","Hi5","Friendster","Bebo","Delicious","Ning","Reddit","Stumbleupon","Technorati"],Media:["Dropbox","Picasa","Youtube","Netflix","Flickr","Itunes","Photobucket","Pandora","Vimeo","Lastfm"],Business:["Adsense","Amazon","Ebay","Godaddy","Craigslist"],Email:["Gmail","Yahoo","Aol","Hotmail","Me"]}}},FA.Models.Asset=Backbone.Model.extend({cpassword:null,initialize:function(){this.initializeSettings();var e=PB.Meta.manageGoogleServices(this.get("url"));if(e&&(this.set({url:e.url}),new RegExp(/google.(ca|com|co.nz|co.uk|es|de|fr)/).test(this.get("name"))&&this.set({name:e.title})),this.initializeMeta(),this.bind("change",this.initializeMeta),this.get("memo_k")&&"null"!=this.get("memo_k"))try{var t=FA.Background.decryptWithAES(this.get("memo_k"));this.details=t}catch(o){this.details=""}else this.details=this.get("details");var n=this.get("url");n&&n.indexOf("www.amazon.")>=0&&n.indexOf("/ap/signin")>0&&this.set({url:PB.utils.standardizeProtocol(PB.utils.getUrlHostname(n))})},initializeMeta:function(){this.get("url")&&"undefined"!=typeof PB.Meta.data&&(this.meta=PB.Meta.getMeta(this.get("url")))},getMeta:function(){var e=this.meta;if(e)return e;var t=PB.Meta.getMeta(this.get("url"));return t?(this.meta=t,t):!1},initializeSettings:function(){var e=this.get("settings");if(""==e||null==e||"null"==e)e={};else try{"string"==typeof e&&(e=JSON.parse(e))}catch(t){e={}}this.get("member_id")!=FA.Background.fa_member_id&&(e={}),("undefined"==typeof e.autologin||""==e.autologin)&&(e.autologin="1"),"always"==e.autologin&&(e.autologin="1"),"never"==e.autologin&&(e.autologin="0"),"0"!==e.autologin&&"1"!==e.autologin&&(e.autologin="1"),"undefined"==typeof e.password_reprompt&&(e.password_reprompt="0"),"undefined"==typeof e.subdomain_only&&(e.subdomain_only="0"),e.autologin=String(e.autologin),e.password_reprompt=String(e.password_reprompt),e.subdomain_only=String(e.subdomain_only),this.set({settings:e})},url:function(){return modelUrl=FA_Config_urlApi+"assets",this.isNew()||(modelUrl+="/"+this.id),modelUrl},validate:function(e){return""===e.name?{faError:"Name should not be empty"}:""==e.url?{faError:"Url should not be empty"}:e.url&&"string"==typeof e.url&&!FA.isValidAssetUrl(e.url.toLowerCase())?{faError:"Invalid Url"}:void 0},escape:function(e){return"number"==typeof this[e]?Backbone.Model.prototype.get.call(this,e):"url"==e?this.get("url"):"function"==typeof this[e]&&"url"!=e?Backbone.Model.prototype.get.call(this,e):_.escape(Backbone.Model.prototype.get.call(this,e))},get:function(e){var t=["name","login","id","details","member_fullname","title"];return t.indexOf(e)>=0?_.escape(Backbone.Model.prototype.get.call(this,e)):Backbone.Model.prototype.get.call(this,e)},getAutoLoginUrl:function(){var e=Backbone.Model.prototype.get.call(this,"url");return e+=e.split("?").length>1?"&pb_login":"?pb_login"},domain:function(){return null!=this.get("domain")&&this.get("domain").length>5?this.get("domain"):this.get("url")?FA.getDomainFromUrl(this.get("url")):this.get("url")},getCPassword:function(){if(!this.belongsToMe()&&!FA.Background.fa_member.hasRSAKeys)return null;if("undefined"!=typeof this.cpassword&&null!=this.cpassword)return this.cpassword;if(null==this.cpassword&&null!=this.get("password_k")&&""!=this.get("password_k"))this.cpassword=FA.Background.decryptWithAES(this.get("password_k"));else if(null==this.cpassword&&this.get("member_id")!=FA.Background.fa_member_id){var e=FA.Background.contacts.find_by_member_id(this.get("member_id"));e&&(shared_secret=e.getSharedSecret(),this.cpassword=PB.crypto.AES.decrypt(this.get("password"),shared_secret,256))}else this.cpassword=null;return this.cpassword},belongsToMe:function(){return this.get("member_id")==FA.Background.fa_member_id},get_img:function(e,t){var o=t?t:FA.Background._detectAssetType(this.domain()),n=FA.Categories.allSites[o];if("undefined"==typeof n)return null;switch(e){case"icon":return"build/images/assets/"+n.icon;case"logo":return PB.loadedLogos[n.logo_key]}return null},has_doublon:function(e){if("google.com"==PB.utils.getUrlBaseDomain(e.url))return!1;if(e&&PB.Utility.getObjectSize(e)&&e.url){var t=this,o=FA.Background.assets.getForDomain(e.url),n=!1;return o.each(function(o){if(o==t)return!0;try{var a=o.get("login"),r=FA.Background.decryptWithAES(o.get("password_k"));o.get("id")!=t.get("id")&&a==e.login&&r==t.cpassword&&(n=!0)}catch(i){}}),n}return!1},save:function(e,t){if(this.cpassword){this.set({password:null,password_k:FA.Background.encryptWithAES(this.cpassword,null),virtual_password:FA.getVirtualPassword(this.cpassword)});var o=t.success,n=this,a=e.details;t.success=function(){n.details=a;var e=n.get("settings");"string"==typeof e&&(e=JSON.parse(e)),n.set({settings:e});var t=PB.Meta.manageGoogleServices(n.get("url"));t&&n.set(t);var r=o(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]);return PB.sharing.recryptSecrets(n),r}}else(""===this.cpassword||null===this.cpassword)&&(this.set({password:null,password_k:null,virtual_password:null}),-1!=PB.config.target.indexOf("desktop-extension")&&this.set({settings:e.settings}));if(("ex.: http://www.facebook.com"==e.url||""==e.url)&&(e.url="http://www.facebook.com"),e.url){var r=e.url.replace(/\ /g,"");e.url=r,this.set({url:r})}e.settings?e.settings=JSON.stringify(e.settings):e.settings=JSON.stringify(this.get("settings")),e.details&&(e.memo_k=FA.Background.encryptWithAES(e.details),e.details=null);var i=t.doublon;return t.doublon=null,this.has_doublon(e)?i?i():t.error?t.error():function(){}:Backbone.Model.prototype.save.call(this,e,t)},hasSecrets:function(){return FA.Background.secrets.any(function(e){return this.get("id")==e.get("asset_id")&&1==e.get("shared")?!0:!1},this)},isProtected:function(){return FA.Background.secrets.any(function(e){return this.get("id")==e.get("asset_id")?!0:!1},this)},emptyPassword:function(){return null==this.get("password")||""==this.get("password")?!0:!1},emptyPassword_k:function(){return null==this.get("password_k")||""==this.get("password_k")?!0:!1}}),FA.Collections.Assets=Backbone.Collection.extend({initialize:function(){var e=this,t=function(t){e.collectionChanged=!0};this.bind("add",t),this.bind("remove",t),this.bind("change",t)},model:FA.Models.Asset,url:function(){return FA_Config_urlApi+"assets"},comparator:function(e){return e.get("domain")},getMostRecent:function(){return 0==this.models.length?void 0:_.max(this.models,function(e){return e.get("id")})},getAllDomains:function(e){e(_.uniq(FA.Background.assets.map(function(e){var t=PB.Meta.getException(e.get("url"));if(t){var o=t.login_override||t.url;return o}return e.get("domain")})))},getForDomain:function(e){e=PB.utils.addProtocol(e);var t=FA.getDomainFromUrl(e),o=new Backbone.Collection;return FA.Background.assets.each(function(e){var n=e.get("settings");"1"==n.subdomain_only?t==FA.getDomainFromUrl(e.get("url"))&&o.add(e):FA.isDomainInTopDomain(t,e.get("domain"))&&o.add(e)}),o},getForUrlOrDomainCache:{},getForUrlOrDomain:function(e){var t=PB.utils.standardizeProtocol(e),o=FA.getDomainFromUrl(t),n=new Backbone.Collection,a=PB.Meta.getException(t);return FA.Background.assets.each(function(e){var t=PB.utils.standardizeProtocol(e.get("url")),r=FA.isDomainInTopDomain(o,e.get("domain")),i=PB.Meta.getException(t);if(r&&a){var s=t==PB.utils.standardizeProtocol(a.url)||t==PB.utils.standardizeProtocol(a.login_override);s&&n.add(e)}else r&&!i&&n.add(e)}),n},shared:function(){return this.filter(function(e){return e.get("member_id")!=FA.Background.fa_member_id})},mine:function(){return this.filter(function(e){return e.get("member_id")==FA.Background.fa_member_id})},im_sharing:function(e){var t="live"==e?!0:!1;return this.filter(function(e){var o=e.id,n=!1;return FA.Background.secrets.each(function(e){e.get("asset_id")==o&&t==e.get("shared")&&(n=!0)}),n})},waiting_shared:function(){return this.filter(function(e){return e.get("member_id")!=FA.Background.fa_member_id&&!FA.Background.contacts.find_by_member_id(e.get("member_id"))})},search:function(e){if(""==e)return this;var t=new RegExp(e,"gi"),o=new Backbone.Collection;return FA.Background.assets.each(function(e){(t.test(e.escape("domain"))||t.test(e.escape("login"))||t.test(e.escape("name")))&&o.add(e)}),o},getAllNonConfirmed:function(){var e=FA.Background.assets.filter(function(e){return e.get("member_id")!=FA.Background.fa_member_id&&!e.get("confirmed")});return"undefined"==typeof e&&(e=[]),e},get_all_non_confirmed_by_member_id:function(e){return this.filter(function(t){return t.get("member_id")==e&&!t.get("confirmed")})}}),FA.Models.BlockedItem=Backbone.Model.extend({url:function(){return modelUrl=FA_Config_urlApi+"blocked_items",this.isNew()||(modelUrl+="/"+this.id),modelUrl}}),FA.Collections.BlockedItems=Backbone.Collection.extend({model:FA.Models.BlockedItem,url:function(){return FA_Config_urlApi+"blocked_items"},has:function(e){return this.any(function(t){return"domain"==t.get("kind")&&FA.isUrlInTopDomain(e,t.get("domain"))?!0:"page"==t.get("kind")&&e==t.get("path")?!0:!1},{url:e})},comparator:function(e){return e.get("path")},getForDomain:function(e){var t=e,o=FA.getDomainFromUrl(e),n=new Backbone.Collection;return FA.Background.blockedItems.each(function(e){"domain"==e.get("kind")&&FA.isDomainInTopDomain(o,e.get("domain"))&&n.add(e),"page"==e.get("kind")&&t==e.get("path")&&n.add(e)}),n}}),FA.Models.Contact=Backbone.Model.extend({sharedSecret:null,initialize:function(){function e(e){var o=PB.crypto.AES.encrypt(e,FA.Background.fa_member.key,256);t.save({secret_member_k:o},{success:function(){},error:function(e,t,o){console.error("Contact saving error")}})}var t=this;try{if(this.get("public_key")&&this.set({public_key:JSON.parse(this.get("public_key"))}),null==this.get("secret_contact_pub")&&this.get("public_key")&&this.getSharedSecret()){var o=PB.crypto.RSA.encrypt(this.getSharedSecret(),this.get("public_key"));this.save({secret_contact_pub:o},{success:function(){},error:function(e,t,o){console.error("Contact saving error")}})}null!=this.get("secret_contact_pub")&&(null==this.get("secret_member_k")||this.get("secret_member_k").length<1)&&PB.Crypto.RSA.decrypt({cipher:this.get("secret_contact_pub"),key:FA.Background.fa_rsaKey.jsonPrivateKey},e)}catch(n){console.error("[FA.Models.Contact] Unhandled exception2: "+n.message)}},parse:function(e,t){return e.public_key&&(e.public_key=JSON.parse(e.public_key)),e},url:function(){return modelUrl=FA_Config_urlApi+"contacts",this.isNew()||(modelUrl+="/"+this.id),modelUrl},escape:function(e){return"function"==typeof this[e]?this[e]():Backbone.Model.prototype.escape.call(this,e)},pending:function(){return this.get("pending")},toJSON:function(){return{email:this.get("email"),fullname:this.get("fullname"),auto_bequeath:this.get("auto_bequeath"),invitation_text:this.get("invitation_text"),invitation_type:this.get("invitation_type"),secret_member_k:this.get("secret_member_k"),secret_contact_pub:this.get("secret_contact_pub"),id:this.get("id"),accepted_beneficiary:this.get("accepted_beneficiary"),member_id:this.get("member_id"),pending:this.get("pending")}},acceptedInvitation:function(){return!!this.get("accepted_beneficiary")},hasSharedPasswords:function(){var e=!1,t=this.id;return FA.Background.secrets.each(function(o){o.get("contact_id")==t&&1==o.get("shared")&&(e=!0)}),e},getSharedSecret:function(){return"undefined"!=typeof this.sharedSecret&&null!=this.sharedSecret?this.sharedSecret:(null==this.sharedSecret&&null!=this.get("secret_member_k")?this.sharedSecret=PB.crypto.AES.decrypt(this.get("secret_member_k"),FA.Background.fa_member.key,256):this.sharedSecret=null,this.sharedSecret)},fullname:function(){return this.get("fullname")&&this.get("fullname").length>1?_.escape(this.get("fullname")):this.escape("email")}}),FA.Collections.Contacts=Backbone.Collection.extend({model:FA.Models.Contact,url:function(){return FA_Config_urlApi+"contacts"},comparator:function(e){return e.get("fullname")},auto_bequeathing:function(){var e=new Backbone.Collection;return this.each(function(t){1==t.get("auto_bequeath")&&e.add(t)}),e},not_shared:function(e){var t=new Backbone.Collection;return this.each(function(o){potential_secret=FA.Background.secrets.getForContactAsset(o,e),potential_secret&&0!=potential_secret.get("shared")||t.add(o)}),t},find_by_email:function(e){return found=!1,this.each(function(t){t.get("email")==e&&(found=t)}),found},find_by_id:function(e){return found=!1,this.each(function(t){t.id==e&&(found=t)}),found},find_by_member_id:function(e){return found=!1,this.each(function(t){t.get("member_id")==e&&(found=t)}),found}}),FA.Models.DisabledDomain=Backbone.Model.extend({url:function(){return modelUrl=FA_Config_urlApi+"disabled_domain",this.isNew()||(modelUrl+="/"+this.id),modelUrl}}),FA.Collections.DisabledDomains=Backbone.Collection.extend({model:FA.Models.DisabledDomain,url:function(){return FA_Config_urlApi+"disabled_domain"},has:function(e){return this.any(function(t){return"domain"==t.get("kind")&&FA.isUrlInTopDomain(e,t.get("domain"))?!0:"page"==t.get("kind")&&e==t.get("path")?!0:!1},{url:e})},comparator:function(e){return e.get("path")},getForDomain:function(e){var t=e,o=FA.getDomainFromUrl(e),n=new Backbone.Collection;return FA.Background.disabledDomains.each(function(e){"domain"==e.get("kind")&&FA.isDomainInTopDomain(o,e.get("domain"))&&n.add(e),"page"==e.get("kind")&&t==e.get("path")&&n.add(e)}),n}}),FA.Models.Document=Backbone.Model.extend({defaults:{encryption_scheme:"AES"},escape:function(e){return"number"==typeof this[e]?Backbone.Model.prototype.get.call(this,e):_.escape(Backbone.Model.prototype.get.call(this,e))},validate:function(e,t){var o=this.attributes||{};for(var n in e)o[n]=e[n];return o.kind?o.content?o.encryption_scheme?void 0:'Attribute "encryption_scheme" is required':'Attribute "content" is required':'Attribute "kind" is required'},initialize:function(){var e=this;e.decryptContent(),e.bind("change:content",this.decryptContent),"cc"==this.get("kind")&&this.get("verificationNumber")&&(this.unset("verificationNumber"),this.encryptContent(e.save))},save:function(e,t){var o=this;t=t||{};var n=["content","encryption_scheme","id","kind"],a=_.clone(this.attributes);_.each(_.keys(o.attributes),function(e){-1==n.indexOf(e)&&o.unset(e,{silent:!0})}),this.set({encryption_scheme:"aes-ccm-256_v0"},{silent:!0}),Backbone.Model.prototype.save.call(this,o.attributes,_.extend(t,{silent:!0})),this.set(a,{silent:!0})},url:function(){return modelUrl=FA_Config_urlApi+"documents",this.isNew()||(modelUrl+="/"+this.id),modelUrl},set:function(e,t,o){var n=this,a=o;return t=t||{},"number"!=typeof e.type&&"undefined"!=typeof e.type&&delete e.type,Backbone.Model.prototype.set.call(this,e,t),t.silent||n.encryptContent(function(){n.attributes.content&&"function"==typeof a&&a.call(n)}),"function"!=typeof a?this:void 0},encryptContent:function(e){var t,o=this.get("encryption_scheme"),n=this.toJSON();delete n.content;var a=this.get("document_content");switch(a&&(n.content=a,delete n.document_content),o){case"AES":case"aes-ccm-256_v0":if(!FA.Background.fa_member&&!FA.Background.fa_member.key)throw new Error("Cannot encrypt content: Master key not found");n.encryption_scheme="AES",t=PB.crypto.AES.encrypt(JSON.stringify(n),FA.Background.fa_member.key),this.set({content:t},{silent:!0}),"function"==typeof e&&e.call(this);break;default:throw new Error('Cannot encrypt content: Unsupported encryption "'+o+"'")}a&&(n.document_content=a,delete n.content)},decryptContent:function(){var e,t=this.get("encryption_scheme");switch(t){case"AES":case"aes":case"aes-ccm-256_v0":e=PB.crypto.AES.decrypt;break;case"none":e=function(e){return e}}if("function"!=typeof e)return console.error('Cannot decrypt content: unsupported encryption "'+t+'"',this),void(this.clearContent=void 0);if(!FA.Background.fa_member||!FA.Background.fa_member.key)return void console.error("Cannot decrypt content: Master key not found",this);var o=this.get("content");if(o)try{var n=e(o,FA.Background.fa_member.key),a=JSON.parse(n);a.document_content=a.content,delete a.content,this.set(a)}catch(r){console.error("Error decrypting document content: ",r.message),this.set({content:!1})}}}),FA.Collections.Documents=Backbone.Collection.extend({model:FA.Models.Document,url:FA_Config_urlApi+"documents",types:["cc","drivers","identity","membership","passport","ssn","note"],initialize:function(){var e=this;this.bind("add",function(t){e.groupByKind()}),this.bind("remove",function(t){e.groupByKind()}),this.bind("reset",function(t){e.groupByKind()}),e.groupByKind()},groupByKind:function(){var e=this;this.byKind=this.groupBy(function(e){return e.get("kind")}),_.each(this.types,function(t){"undefined"==typeof e.byKind[t]&&(e.byKind[t]=[])})},searchBlacklist:["content","created_at","encryption","encryption_scheme","id","memberId","member_id","updated_at"],
search:function(e){return new Backbone.Collection(this.filter(function(t){return _.find(t.attributes,function(t,o){return new RegExp(e,"gi").test(t)&&-1==_.indexOf(this.searchBlacklist,o)})})).groupBy(function(e){return e.get("kind")})}}),FA.Models.GeneratedPassword=Backbone.Model.extend({cpassword:null,initialize:function(){},validate:function(e){},url:"/",sync:function(e,t,o){o.success.apply()}}),FA.Collections.GeneratedPasswords=Backbone.Collection.extend({initialize:function(){if(FA.Background.fa_member){var e=this;this.storage=new LocalData("pb-generatedPasswords",!0);var t=this.storage.get("passwords")||[];_.each(t,function(t){e.create(t)}),this.bind("add",this.onNewModel)}},model:FA.Models.GeneratedPassword,url:"/",sync:function(e,t,o){o.success.apply()},comparator:function(e){return-new Date(e.get("date")).getTime()},onNewModel:function(e,t,o){var n=this.storage.get("passwords")||[];n.push(e.attributes),this.storage.set("passwords",n)},removeAll:function(){this.reset(),this.storage.set("passwords",[])}}),FA.Models.Member=Backbone.Model.extend({hasRSAKeys:!1,url:function(){return modelUrl=FA_Config_urlApi+"members",this.isNew()||(modelUrl+="/"+this.id),modelUrl},initialize:function(){},isFreeForLife:function(){var e=FA.Background.fa_member.get("plan");return e?"free-unlimited"==e.name:!1},checkEmailVerification:function(){var e={type:"get",url:FA_Config_urlApi+"members/"+FA.Background.fa_member_id,success:function(e){e&&null!=e.email_verification.verified_at&&FA.Background.fa_member.set({email_verification:e.email_verification})}};$.ajax({type:e.type,url:e.url,success:e.success})},isFreemiumViral:function(){return this.get("outstanding_bonus_flag")},freemium_over:function(){return this.get("trial")&&this.assets_limit_reached()},assets_left:function(){var e=FA.Background.fa_member.get("assets_limit")-FA.Background.assets.mine().length;return 0>e&&(e=0),e},assets_limit_reached:function(){return FA.Background.assets.mine().length>=this.get("assets_limit")},get_one_click_count:function(){return+localStorage.getItem("oneclick_count")||0},increment_one_click_count:function(){var e=this.get_one_click_count();localStorage.setItem("oneclick_count",e+1)},get_box_opens_count:function(){return+localStorage.getItem("box_open_count")||0},increment_box_opens_count:function(){var e=this.get_box_opens_count();localStorage.setItem("box_open_count",e+1)},get_premium_link:function(e){var t=PB.Config.URL_GO_PREMIUM,o=FA.Background.fa_member.get("assets_limit"),n=FA.Background.fa_member.get_box_fullness();return t+="?box_full="+n,t+="&assets_limit="+o,t+="&click_source="+e},get_box_fullness:function(){return Math.round(FA.Background.assets.mine().length/FA.Background.fa_member.get("assets_limit")*100)/100},escape:function(e){return"number"==typeof this[e]?Backbone.Model.prototype.get.call(this,e):_.escape(Backbone.Model.prototype.get.call(this,e))}}),FA.Models.Secret=Backbone.Model.extend({url:function(){return modelUrl=FA_Config_urlApi+"secrets",this.isNew()||(modelUrl+="/"+this.id),modelUrl}}),FA.Collections.Secrets=Backbone.Collection.extend({initialize:function(){var e=this,t=function(t){e.collectionChanged=!0};this.bind("add",t),this.bind("remove",t),this.bind("change",t)},model:FA.Models.Secret,url:function(){return FA_Config_urlApi+"secrets"},clearSecretsForAsset:function(e){try{var t=e.get("id");return secrets_to_clear=this.filter(function(e){return e.get("asset_id")==t}),this.remove(secrets_to_clear)}catch(o){console.error(o)}},getForContact:function(e){var t=e.id,o=new Backbone.Collection;return FA.Background.secrets.each(function(e){e.get("contact_id")==t&&o.add(e)}),o},getForAsset:function(e,t){var o=e.id,n="live"==t?!0:!1,a=new Backbone.Collection;return this.each(function(e){e.get("asset_id")==o&&n==e.get("shared")&&a.add(e)}),a},getForContactAsset:function(e,t,o){var n=t.id,a=e.id,r=!1;return o=o||null,this.each(function(e){e.get("asset_id")==n&&e.get("contact_id")==a&&(null==o||e.get("shared")==o)&&(r=e)}),r},checkEmptySecrets:function(){this.each(function(e){(null==e.get("crypted_key")||0==e.get("crypted_key").length)&&(contact=FA.Background.contacts.get(e.escape("contact_id")),contact&&contact.get("public_key")&&(asset=FA.Background.assets.get(e.escape("asset_id")),cryptedKey=FA.Background.encryptWithRSA(asset.getCPassword(),contact.get("public_key")),e.save({crypted_key:cryptedKey})))})}}),FA.Collections.TempAssets=Backbone.Collection.extend({}),!function(e,t){PB.utils.setNamespace(e,t)}("PB.LoginDetect",function(){function e(e,t,o){this.html=e,this.url=t,this.hints=o||{},this.reasons=[],this.flags={hasLoginOrSignupForm:!1,hasTwoFactorForm:!1,hasLoginLink:!1,hasLogoutLinkOrInput:!1,hasLogoutLinkOrInputAndLoginOrSignupForm:!1,hasLoginAttribute:!1,hasLogoutAttribute:!1,hasLoginUrl:!1,hasLoginValidationError:!1}}var t=PB.debug("login-detect");return e.prototype.isLoginPage=function(){return this.score()>2},e.prototype.score=function(){return this._score||(this._score=0,(this.hasLoginForm()||this.hasSignupForm())&&(this.addReason("has a login or signup form +2","hasLoginOrSignupForm"),this._score+=2),this.hasTwoFactorForm()&&(this.addReason("has a two factor form -2","hasTwoFactorForm"),this._score-=2),this.hasLoginLink()&&(this.addReason("has a login link +1","hasLoginLink"),this._score+=1),this.hasLogoutLink()||this.hasLogoutInput()?(this.addReason("has a logout link or input -2","hasLogoutLinkOrInput"),this._score-=2):(this.addReason("does not have a logout link or input +1"),this._score+=1),(this.hasNonHiddenLogoutLink()||this.hasNonHiddenLogoutInput())&&(this.addReason("has a non hidden logout link or input -3","hasNoneHiddenLogoutLinkOrInput"),this._score-=3),(this.hasLogoutLink()||this.hasLogoutInput())&&(this.hasLoginForm()||this.hasSignupForm())&&(this.addReason("has a logout link and login/signup form +1","hasLogoutLinkOrInputAndLoginOrSignupForm"),this._score+=2),(this.hasNonHiddenLogoutLink()||this.hasNonHiddenLogoutInput())&&(this.hasLoginForm()||this.hasSignupForm())&&(this.addReason("has both logout and login/signup, but logout is not hidden -5","hasNonHiddenLogoutLinkorInputAndLoginOrSignupForm"),this._score-=5),this.hasLoginAttribute()&&(this.addReason("has a login attribute +1","hasLoginAttribute"),this._score+=1),this.hasLogoutAttribute()&&(this.addReason("has a logout attribute -1","hasLogoutAttribute"),this._score-=1),this.hasNonHiddenLogoutAttribute()&&(this.addReason("has non hidden logout attribute -2","hasNonHiddenLogoutAttribute"),this._score-=2),this.hasLoginUrl()&&(this.addReason("has a login url +1","hasLoginUrl"),this._score+=1),this.hasLoginValidationError()&&(this.addReason("has a validation error +1","hasLoginValidationError"),this._score+=1)),this._score},e.prototype.addReason=function(e,o){t(e),this.reasons.push(e),o&&(this.flags[o]=!0)},e.prototype.hasLoginForm=function(){return Boolean(this.hints.hasLoginForm)},e.prototype.hasTwoFactorForm=function(){return Boolean(this.hints.hasTwoFactorForm)},e.prototype.hasSignupForm=function(){return Boolean(this.hints.hasSignupForm)},e.prototype.hasLoginLink=function(){var e=/(sign|log)(.?)(in|on)/i,t=$("a,btn",this.html);return t.toArray().some(function(t){return $(t).text().match(e)})},e.prototype.hasLogoutLink=function(){var e=/(sign|log)(.?)(out|off)/i,t=$("a,btn",this.html);return t.toArray().some(function(t){var o=$(t).find("img").attr("alt");return $(t).text().match(e)||o&&o.match(e)})},e.prototype.hasNonHiddenLogoutLink=function(){var e=/(sign|log)(.?)(out|off)/i,t=$("a,btn",this.html);return t.toArray().some(function(t){var o=$(t).find("img").attr("alt");return PB.contentscript.isVisible(t)&&($(t).text().match(e)||o&&o.match(e))})},e.prototype.hasLogoutInput=function(){var e=/(sign|log)(.?)(out|off)/i,t=$("input",this.html);return t.toArray().some(function(t){return $(t).val().match(e)})},e.prototype.hasNonHiddenLogoutInput=function(){var e=/(sign|log)(.?)(out|off)/i,t=$("input",this.html);return t.toArray().some(function(t){return!(!PB.contentscript.isVisible(t)||!$(t).val().match(e))})},e.prototype.hasLoginAttribute=function(){var e="[class*=login],[id*=login],[class*=signin],[id*=signin],[class*=Login],[id*=Login],[class*=Signin],[id*=Signin]",t=$(e,this.html);return t.toArray().some(function(e){return e.innerHTML.length})},e.prototype.hasLogoutAttribute=function(){var e="[class*=logout],[id*=logout],[class*=signout],[id*=signout],[class*=Logout],[id*=Logout],[class*=Signout],[id*=Signout]",t=$(e,this.html);return t.toArray().some(function(e){return e.innerHTML.length})},e.prototype.hasNonHiddenLogoutAttribute=function(){var e="[class*=logout],[id*=logout],[class*=signout],[id*=signout],[class*=Logout],[id*=Logout],[class*=Signout],[id*=Signout]",t=$(e,this.html);return t.toArray().some(function(e){return!(!PB.contentscript.isVisible(e)||!e.innerHTML.length)})},e.prototype.hasLoginUrl=function(){var e=/(sign|log)(.?)(in|on)/i;return this.url&&Boolean(this.url.match(e))},e.prototype.hasLoginValidationError=function(){if(!this.loginFailedRegExp){var e="(id|name|username|nick|screen name|handle|e-?mail( address)?|password|user id|login|account)",t=["enter (a|an|your)?\\s?(valid)?\\s?"+e,"(forgot|reset) (your )?"+e,e+" (you entered )?(is|were|was|are)?\\s?(locked|incorrect|invalid|missing|unknown|do not match)",e+" was entered incorrectly","(incorrect|invalid|unknown|wrong|not a valid) (avatar )?"+e,"enter a (value for|valid|correct) "+e,e+"(is|has been) (temporarily )?(disabled|blocked|de-activated)","(sign|signing|log|loging)(s|-)?(in|on)? failed","unable to (sign|signing|log|loging)(s|-)?(in|on)?",e+" (doesn't|does not) exist","(does not|doesn't) match (an account|our records)","the "+e+" or password (you) entered is not correct"];t=t.map(function(e){return"("+e+")"}),this.loginFailedRegExp=new RegExp(t.join("|"),"gi")}var o=$("div, span, p, section, h1, h2, h3, h4, li, article, nav, main, form",this.html).text();return Boolean(this.loginFailedRegExp.test(o))},e}),!function(e,t){PB.utils.setNamespace(e,t)}("PB.WebsiteFlows",function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function t(){return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}function o(e){var t=o.resolve(e),n=o.modules[t];if(!n)throw new Error('failed to req "'+e+'"');return n.exports||(n.exports={},n.call(n.exports,n,n.exports,o.relative(t))),n.exports}o.modules={},o.resolve=function(e){var t=e,n=e+".js",a=e+"/index.js";return o.modules[n]&&n||o.modules[a]&&a||t},o.register=function(e,t){o.modules[e]=t},o.relative=function(e){return function(t){if("."!=t.charAt(0))return o(t);var n=e.split("/"),a=t.split("/");n.pop();for(var r=0;r<a.length;r++){var i=a[r];".."==i?n.pop():"."!=i&&n.push(i)}return o(n.join("/"))}},o.alias=function(e,t){var n=o.modules[e];o.modules[t]=n},o.register("WebsiteFlowStep.js",function(e,t,o){function n(e){var t={completed:!1,blockFillForms:!1};this.attributes=_.extend(t,e||{})}e.exports=n}),o.register("WebsiteFlowModel.js",function(e,o,n){function a(e,o){var n=this,a={currentStep:0,type:"welcomeFlow",steps:[],id:t()};switch(o=o,this.attributes=_.extend(a,e||{}),this.attributes.type){case"welcomeFlow":this.attributes.steps=[new r({id:"highlightLogin",eventToComplete:"login:success",blockFillForms:!0,cancelIfNoForms:!0}),new r({id:"loginSuccessful",eventToComplete:"step:loginSuccessful:complete"}),new r({id:"try1click",eventToComplete:"login:success",forceSubmit:!0,blockLoadingOverlay:!0}),new r({id:"welcomeFlowDone",eventToComplete:"step:welcomeFlowDone:complete"})];break;case"addNew":this.attributes.steps=[new r({id:"highlightLogin",eventToComplete:"login:success",blockFillForms:!0,cancelIfNoForms:!0}),new r({id:"addNewLoginSuccessful",eventToComplete:"step:loginSuccessful:complete"})]}this.destroy=function(){return o.destroy(n.attributes.id),n}}e.exports=a;var r=n("WebsiteFlowStep");a.prototype.stepCompleted=function(){return this.attributes.currentStep++,this.attributes.currentStep==this.attributes.steps.length&&this.destroy(),this},a.prototype.toJSON=function(){return this.attributes}}),o.register("WebsiteFlowCollection.js",function(e,t,o){function n(){this.flows=[]}e.exports=n;var a=o("WebsiteFlowModel");n.prototype.create=function(e){var t=this.findByUrl(e.url);return t&&this.destroy(t.attributes.id),e.domain=PB.utils.getUrlBaseDomain(e.url),this.flows.push(new a(e,this)),this},n.prototype.findByUrl=function(e){if(e||console.log("Attempt to find a Website Flow without a URL."),e.indexOf(".passwordbox.com")>=0)try{e=FA.Background.tempAssets.last().get("url")}catch(t){}var o=PB.utils.getUrlBaseDomain(e);return _.find(this.flows,function(e,t,n){return e.attributes.domain==o})},n.prototype.destroy=function(e){return _.find(this.flows,function(t,o,n){var a=t.attributes.id==e;return a&&(t=null,n.splice(o,1)),a}),this},n.prototype.destroyAll=function(){return _.each(this.flows,function(e,t,o){e=null,o.splice(t,1)}),this},n.prototype.report=function(e,t){var o=this.findByUrl(t.tab.url);if(!o)return!1;var n=o.attributes,a=n.steps[n.currentStep];a.attributes.eventToComplete==e&&(a.completed=!0,o.stepCompleted())}}),o.alias("./WebsiteFlowCollection.js","WebsiteFlowCollection");var n=o("WebsiteFlowCollection");return new n}),FA.Background={create_asset:function(){return new FA.Models.Asset},create_document:function(){return new FA.Models.Document},fa_login:null,fa_cpassword:null,fa_rsaKey:{},fa_member_id:null,fa_member_name:null,welcome:null,fa_member:null,assets:new FA.Collections.Assets,tempAssets:new FA.Collections.TempAssets,blockedItems:new FA.Collections.BlockedItems,secrets:new FA.Collections.Secrets,contacts:new FA.Collections.Contacts,documents:new FA.Collections.Documents,saveQueue:new Array,requests:new Array,counting:new Array,isBrowserOpen:!0,startpageTrackedEvents:{startpageImAliveTracked:!1,startpageInstallTracked:!1},websiteFlowSites:["facebook.com","twitter.com","paypal.com","dropbox.com","linkedin.com","netflix.com","pinterest.com","skype.com","apple.com","evernote.com","tumblr.com","vimeo.com","accounts.google.com"],copyToClipboard:function(e,t){PB.Utility.setClipboardText(e.string)},setLanguage:async(function(e){FA.Background.setLocalStorageItem("language",e),"desktop-extension-chrome"==PB.config.target?chrome.cookies.set({name:"lang",value:e,url:"http://passwordbox.com",domain:".passwordbox.com"}):"desktop-extension-safari"!=PB.config.target&&$.cookie("lang",e,{domain:"passwordbox.com",expires:365})}),prod:function(){return FA_Config_env&&"production"==FA_Config_env&&7752!=FA.Background.fa_member_id&&1!=FA.Background.fa_member_id?!0:!1},resendEmailVerification:function(){$.ajax({type:"GET",url:FA_Config_urlApi+"resend_verification_email.json",complete:function(e){}})},disableWebsiteFeedback:function(e){console.log("disableWebsiteFeedback",e)},openLoginPrompt:function(){var e=FA.Background.getLocalStorageItem("language");e&&"en_US"!=e||"desktop-extension-chrome"!=PB.config.target||!(PB.user_activity.list_users().length>0)||this.getLocalStorageItem("loginPromptDisabled")||chrome.tabs.create({url:"https://accounts.passwordbox.com"})},openWelcomeFlowAfter7Days:function(){var e=FA.Background.getLocalStorageItem("extensionInstalledTimestamp"),t=604800,o=FA.Background.getLocalStorageItem("hasSeenWelcomeFlowAfter7Days");!o&&"desktop-extension-chrome"==PB.config.target&&0===PB.user_activity.list_users().length&&e+t<new Date/1e3&&(FA.Background.setLocalStorageItem("hasSeenWelcomeFlowAfter7Days",!0),chrome.tabs.create({url:"https://www.passwordbox.com/welcome"}))},tAddToIgnoredNeverSignedUp:function(e,t,o){var n=PB.utils.removeSubdomain(PB.utils.getUrlBaseDomain(e.url));this.ignoredNeverSignedUp.push(n),localStorage.setItem("ignoreNeverSignedUp",JSON.stringify(this.ignoredNeverSignedUp))},sendSyncSMS:function(e,t){$.ajax({url:PB.Config.URL_API+"/sync/sms.json",crossDomain:!0,type:"POST",data:{phone_number:e},success:function(e){t(!0,e)},error:function(e){var o;try{o=JSON.parse(e.responseText)}catch(n){o={}}t(!1,o)}})},sendSyncEmail:function(e,t){$.ajax({url:PB.Config.URL_API+"/sync/email.json",crossDomain:!0,type:"POST",data:{email:e},success:function(e){t(!0,e)},error:function(e){var o;try{o=JSON.parse(e.responseText)}catch(n){o={}}t(!1,o)}})},isBlockedUrl:function(e){return FA.isUrlInTopDomain(e,"foreveralive.com")||FA.isUrlInTopDomain(e,"passwordbox.com")?!0:PB.WebsiteFlows.findByUrl(e)?!1:FA.Background.blockedItems.has(e)},clearNeverSave:function(){FA.Background.blockedItems.each(function(e){e.destroy()})},_addTempAsset:function(e,t,o){if(!FA.Background.isBlockedUrl(e)&&o.allowAutosave){var n=PB.utils.getUrlBaseDomain(e).replace(/^www\./,"");if("desktop-extension-firefox"!=PB.config.target&&navigator.userAgent.match(/Trident.*rv\:11\./)){var a=/\{\"message\":"triggerEvent","event.*$/;e=e.replace(a,"")}var r=PB.Meta.getLoginUrl(e),s=_.find(t,function(e){return"username"==e.role}),c=_.find(t,function(e){return"password"==e.role});"undefined"==typeof s&&(s=FA.getLoginFromForm(t)),"undefined"==typeof c&&(c=FA.getPasswordFromForm(t));var l=null,u=!1,d=_.filter(t,function(e){return"pbIsSignupForm"==e.name}).length>0;if(d&&(e.indexOf("accounts.google.com/SignUp")>-1&&-1==s.value.indexOf("@gmail.com")&&(s.value=s.value+"@gmail.com"),e!=r&&(e=r)),new RegExp(/(personal|investor).vanguard/).test(n)){var m=_.find(t,function(e){return"username"==e.role});if(m.length>0)return void localStorage.setItem("PB_vanguardUsername",m.value);var g=_.filter(t,function(e){return"password"==e.name});g.length>0&&(s={name:"vanguardFakedUsername",type:"text",value:localStorage.getItem("PB_vanguardUsername")})}var p=o.form||{},f="standard";if(p.technique&&~p.technique.indexOf("atlas")){var h=Url.parse(e).domain;if(s&&!c)return void(PB.multistep.tempUsername[h]=s.value);if(c&&!s){var v=PB.multistep.tempUsername[h];s={name:"twoStepUsername",type:"text",value:v},f="partial-form"}}if(n&&e&&s&&c&&"undefined"!=typeof s.value&&s.value.length>0&&"undefined"!=typeof c.value&&c.value.length>0){var b=c.value,y=s.value;for(FA.Background.tempAssets.each(function(e){e.get("domain")==n&&e.get("login")==y&&e.get("cpassword")==b?(u=!0,o.token&&(e.set({token:o.token}),e.set({domain:o.domain}))):e.get("domain")==n&&FA.Background.tempAssets.remove(e)}),i=0;i<t.length;i++)"password"==t[i].type&&(t[i].value=null);if(assets=FA.Background.assets.getForDomain(e),assets.each(function(e){u||(y==e.get("login")&&b==e.getCPassword()?u=!0:y==e.get("login")&&e.get("member_id")==FA.Background.fa_member_id&&(l=e.escape("id")))}),!u){e.indexOf("accounts.google.com/ServiceLogin?service=mail")>-1&&(e="https://accounts.google.com/ServiceLogin?service=mail"),tempAsset={asset_id:l,domain:o.domain,url:e,login:y,cpassword:b,loginType:d?"signup":"login"},o.token&&(tempAsset.token=o.token,tempAsset.domain=o.domain),tempAsset.form=p,tempAsset.tabId=o.tabId,FA.Background.tempAssets.reset();var k=FA.Background.tempAssets.add(tempAsset).last();return PB.SessionData.queueTempAssetRemoval=!1,k.mixpanel_data={mixpanel_event:"create_password",mixpanel_params:{location:"in-page",state:"logged_out",type:"auto_save",website_url:e,domain:o.domain,asset_title:n,saving_type:f}},localStorage.setItem("try_autosave","true"),k}}}},tAutosaveWelcomeFlow:function(e,t){if(e.url&&FA.Background.clearCookies("single",e.url),PB.WebsiteFlows.create({type:e.type,url:e.url}),e.newTab){var o=e.newTab;t&&(o.openerTabId=FA.Background.get_tab_id(t),o.index=t.tab.index+1),chrome.tabs.create(e.newTab,function(e){})}},tAutoLoginFromWelcome:function(e,t,o){if(e.url){{FA.Background.get_tab_id(t)}FA.Background.clearCookies("single",e.url),o({faCallback:"tLaunchUrl",url:e.url})}},_saveAsset:function(e,t,o,n){var a=FA.Background.tempAssets.getByCid(e);if(FA.Background.saveQueue.indexOf(a.cid)>=0)return void FA.Background.tempAssets.remove(a);FA.Background.saveQueue.push(e);var t=a.escape("domain");assetType=FA.Background._detectAssetType(a.get("domain"));var r={type:assetType,url:a.get("url"),name:t,login:a.escape("login")};r.url.indexOf("accounts.google.com/ServiceLogin?service=mail")>-1&&(r.name="Gmail, Google Mail"),asset=new FA.Models.Asset,asset.cpassword=a.get("cpassword"),asset.save(r,{doublon:function(){FA.Background.tempAssets.reset()},success:function(n,r){a.mixpanel_data?FA.Background.mixpanel_activity(a.mixpanel_data):PB.mixpanel.track("create_password",{type:"auto-save",state:"logged_in",website_url:r.url,asset_title:r.name,domain:Url.parse(r.url).domain}),FA.Background.saveQueue.indexOf(a.cid)>=0&&FA.Background.saveQueue.splice(FA.Background.saveQueue.indexOf(a.cid),1),FA.Background.assets.add(n),FA.Background.tempAssets.remove(a),"undefined"!=typeof PB.user_activity&&PB.user_activity.add_domain_for_user(FA.Background.fa_login,t),o&&chrome.tabs.sendMessage(o.tab.id,{faTrigger:"tAskToShare",faMemberName:FA.Background.fa_member_name,faAssetId:n.escape("id"),faExp:localStorage.getItem("experiment")}),chrome.tabs.query({},function(t){_.each(t,function(t){chrome.tabs.sendMessage(t.id,{faTrigger:"tTempRemoved",faTmpId:e})})});try{"desktop-extension-firefox"==PB.config.target&&FA.resync()}catch(i){}PB.lastSavedId=n.get("id")},error:function(e,t,o){FA.Background.saveQueue.indexOf(a.cid)>=0&&FA.Background.saveQueue.splice(FA.Background.saveQueue.indexOf(a.cid),1)}})},_updateAsset:function(e){try{var t;t=e?FA.Background.tempAssets.getByCid(e):FA.Background.tempAssets.last();var o=this.assets.get(t.escape("asset_id"));o.cpassword=t.get("cpassword"),o.save({},{success:function(t,o){var n=t.get("url");PB.mixpanel.track("edit_password",{type:"auto_update",website_url:n,asset_title:t.get("name"),domain:Url.parse(n).domain}),PB.sharing.recryptSecrets(t),chrome.tabs.query({},function(t){_.each(t,function(t){chrome.tabs.sendMessage(t.id,{faTrigger:"tTempRemoved",faTmpId:e})})})},error:function(e,t,o){e.fetch()}}),FA.Background.tempAssets.remove(t)}catch(n){console.error(n)}},_removeTemp:function(e){try{var t;t=e?FA.Background.tempAssets.getByCid(e):FA.Background.tempAssets.first(),FA.Background.tempAssets.remove(t),"desktop-extension-firefox"!=PB.config.target&&chrome.tabs.query({},function(t){_.each(t,function(t){chrome.tabs.sendMessage(t.id,{faTrigger:"tTempRemoved",faTmpId:e})})})}catch(o){console.error(o)}},_blockItem:function(e,t){try{var o=FA.Background.tempAssets.getByCid(e),n=o.get("url");"domain"==t&&(n=o.get("url"));var a=new FA.Models.BlockedItem({path:n,kind:t});a.save(),FA.Background.blockedItems.add(a),FA.Background.tempAssets.remove(o),chrome.tabs.query({},function(t){_.each(t,function(t){chrome.tabs.sendMessage(t.id,{faTrigger:"tTempRemoved",faTmpId:e})})})}catch(r){console.error(r)}},_detectAssetType:function(e){var t="Other",o=!1;return _.each(FA.Categories.allSites,function(n,a){o||(regex=new RegExp(n.matchDomain,"i"),regex.test(e)&&(t=a,o=!0))}),t},hasCredentials:function(){return FA.Background.fa_login&&FA.Background.fa_cpassword?!0:FA.Background.hasProfilePicture()?!0:(FA.Background.animation=!0,!1)},check_connection:function(){if(navigator.connection){var e=navigator.connection.type;return"none"==e||"unknown"==e?!1:!0}return navigator.onLine?!0:!1},set_secret_visibility:function(e,t){return e.set({visible:t}),e.save(),!0},confirm_assets:function(e,t){"desktop-extension-firefox"==PB.config.target&&_.each(e,function(t,o){e[o]=new FA.Models.Asset(e[o])});for(var o=0;o<e.length;o++){var n=e[o],a=n.get("secret_id"),r={url:FA_Config_urlApi+"secrets/"+a+"/confirm",type:"POST",data:{},success:function(e){"string"==typeof e&&(e=JSON.parse(e)),FA.Background.assets.get(e.id).set({confirmed:!0}),FA.Background.extensionBadge.updateState(),t&&t()},error:function(e,t,o){console.error("Failed to create key: "+JSON.stringify(e))}};$.ajax(r)}},setCredentials:function(e,t,o,n,a){FA.Background.fa_login=e,FA.Background.fa_cpassword=t,FA.Background.fa_member_id=o,FA.Background.fa_member_name=n,FA.Background.fa_rsaKey=a},updateCredentials:function(e,t){FA.Background[e]=t},lastPageWithSubmit:function(e){var t=FA.Background.get_tab_id(e),o=FA.Background.submits&&FA.Background.submits[t],n=o&&o.form&&o.form.partial;return{wasSubmit:!!o,previousFormPartialType:n,data:o}},secondBackgroundQuery:function(e,t,o){if(e.isInpage)return!1;if(o&&this.__creatingTempAsset)return setTimeout(function(){secondBackgroundQuery(e,t,o)},100);var n={faCallback:"secondBackgroundResponse",faMemberName:FA.Background.fa_member_name,faDefaultEmail:PB.settings.cachedEmail.get(),user_activity:PB.user_activity.obj,websiteFlow:PB.WebsiteFlows.findByUrl(t.tab.url)};if(e.hasOwnProperty("loginResult")){var a=FA.Background.get_tab_id(t),r=FA.Background.submits[a];r?(FA.Background.reportLoginSuccess(e,r,t),delete FA.Background.submits[a],r.login_type&&!~r.login_type.indexOf("manual")&&(n.loginSuccess={status:e.loginResult.isLoginPage?"f":"s"}),PB.multistep&&"password"===PB.multistep[a]?delete PB.multistep[a]:PB.multistep&&"username"===PB.multistep[a]&&e.loginResult.isLoginPage&&FA.Background.isTabIgnored(t,!1)):PB.debug("pb:bg:secondBackgroundQuery")("WARN: the sender provided a loginResult, but there is no cache submit. iframes conflict?")}if(e.refreshAssets&&(n.refreshedAssets=this.getAssetsForCurrentWebsite(e,t)),FA.Background.tempAssets.length>0){PB.SessionData.queueTempAssetRemoval&&(FA.Background.tempAssets.reset(),PB.SessionData.queueTempAssetRemoval=!1);var i=FA.Background.tempAssets.filter(function(e){return e.get("tabId")==FA.Background.get_tab_id(t)});i.forEach(function(t){var o=t.get("loginSuccess");"undefined"==typeof o&&(o=e.loginResult&&!e.loginResult.isLoginPage,t.set({loginSuccess:o})),PB.Authentication.isAuthenticated()?-1==FA.Background.saveQueue.indexOf(t.cid)&&_.extend(n,{nextCall:"needValidation",faIdToValidate:t.cid,tempAssetFormType:t.get("form").formType,tempAssetFormTechnique:t.get("form").technique,faUpdate:t.get("asset_id")?!0:!1,faDomainToValidate:t.escape("domain"),aid:t.get("asset_id"),loginSuccess:o,assetTitle:t.get("title")}):(_.extend(n,{nextCall:"needLoginToValidate",faIdToValidate:t.cid,faHasPreviousError:e.faHasPreviousError,faDomainToValidate:t.escape("domain"),loginSuccess:o}),null!=t.get("token")&&(n.token=t.get("token")),null!=t.get("domain")&&(n.domain=t.get("domain")))})}return n.loginSuccess&&!e.isIframe&&PB.WebsiteFlows.report("login:success",t),n.websiteFlow=PB.WebsiteFlows.findByUrl(t.tab.url),o&&o(n),"desktop-extension-firefox"==PB.config.target?null!=n?n:!1:void 0},tWebsiteFlowReport:function(e,t){PB.WebsiteFlows.report(e.event,t)},tShareAsset:function(e,t){try{if(!PB.Authentication.isAuthenticated())return!1;chrome.tabs.create({url:chrome.extension.getURL("share.html#assets/"+e.faAssetId+"/secrets/"+e.faShareType),selected:!0,index:t.tab.index+1})}catch(o){console.error(o)}},tValidateTemp:function(e,t,o){return PB.Authentication.isAuthenticated()?(tempCid=e.cid,doAction=e.doAction,PB.multistep.tempUsername={},void("save"==doAction?FA.Background._saveAsset(tempCid,e.pwd_name,t):"notNow"==doAction?FA.Background._removeTemp(tempCid):"neverPage"==doAction?FA.Background._blockItem(tempCid,"page"):"neverDomain"==doAction?FA.Background._blockItem(tempCid,"domain"):"update"==doAction&&FA.Background._updateAsset(tempCid))):!1},tRemoveTemp:function(e,t){FA.Background.tempAssets.reset()},tReportWebsite:function(e,t){},tDisableAutologin:function(e){console.log("tDisableAutologin",e)},tSupportNotificationSeen:function(e,t){PB.BI.addToIgnore(e.id)},tAssetDetection:function(e,t){if(0==PB.user_activity.list_users().length)return!1;var o=null;if(e.token&&(o=e.token),e.form&&e.form.partial){var n=FA.Background.get_tab_id(t);PB.multistep[n]=e.form.partial}try{this.__creatingTempAsset=!0,FA.Background._addTempAsset(e.url,e.faForm,{token:o,is_signed_up:e.is_signed_up,allowAutosave:e.allowAutosave,form:e.form,domain:e.domain,tabId:FA.Background.get_tab_id(t)})}finally{this.__creatingTempAsset=!1}},tGetViralAssets:function(e,t,o){var n=[];_.each(["hotmail.com","yahoo.com","aol.com","rocketmail.com","live.com"],function(e){var t=FA.Background.assets.getForDomain(e);t.length>0&&n.push({url:e,login:t.models[0].escape("login"),password:t.models[0].getCPassword()})}),o({credentials:n,faCallback:"viralAssetsReceived"})},tGetWelcomeSuggestions:function(e,t,o){var n=function(){var t=PB.Browser.getSuggestions(e.options),n=FA.Background.websiteFlowSites,a=t.filter(function(e){return-1!==n.indexOf(PB.utils.getUrlBaseDomain(e.url))});if(a.length<8){var r=a.map(function(e){return PB.utils.getUrlBaseDomain(e.url)}),i=_.difference(n,r).slice(0,8-a.length);i.forEach(function(e){a.push(PB.Meta.getMeta(e))})}o({suggestions:a,faCallback:"suggestionsReceived"})},a=setInterval(function(){void 0!=PB.Meta.data&&(clearInterval(a),n())},200)},tGetSuggestions:function(e,t,o){var n=function(){var t=PB.Browser.getSuggestions(e.options);o({suggestions:t,faCallback:"suggestionsReceived"})},a=setInterval(function(){void 0!=PB.Meta.data&&(clearInterval(a),n())},200)},tGetSuggestions:function(e,t,o){var n=PB.Browser.getSuggestions(e.options);o({suggestions:n,faCallback:"suggestionsReceived"})},getAssetsForCurrentWebsite:function(e,t){!!PB.WebsiteFlows.findByUrl(e.hostname);if(!PB.Authentication.isAuthenticated())return!1;var o=FA.Background.isTabIgnored(t,!0),n=!o&&PB.settings.defaultAutoLogin.isActive(),a="seamless_login",r=FA.Background.assets.getForDomain(e.hostname),i=FA.Background.get_tab_id(t);PB.oneclickAsset=PB.oneclickAsset||{},PB.oneclickAsset[i]&&r.contains(PB.oneclickAsset[i].first())?(a="one_click_login",r=PB.oneclickAsset[i]):PB.AutoLogin.check({assets:r})&&(n=1,a="one_click_login",PB.oneclickAsset[i]=r),1!==n&&(r=r.filter(function(e){return e&&"password_reprompt"in e?"0"==e.password_reprompt:!0}),r=new Backbone.Collection(r));var s=[];return r&&r.length>0&&(r.each(function(e){var t={};try{t={domain:FA.getDomainFromUrl(e.get("url")),login:e.escape("login"),password:e.getCPassword(),owner:e.get("member_id")==FA.Background.fa_member_id?!0:!1,shared:e.isProtected(),faAssetId:e.get("id"),password_reprompt:e.get("settings").password_reprompt,autologin:e.get("settings").autologin,name:e.get("name")};var o=!1;s.length&&_.each(s,function(e){e.login==t.login&&e.password==t.password&&(o=!0)}),o||s.push(t)}catch(n){console.warn("Error reading asset: "+JSON.stringify(t))}}),PB.config.target.match(/desktop-extension/)||PB.mixpanel.track("account_login")),{is_tab_ignored:o,auto_login:n&&1===s.length,auto_login_type:a,faAssets:s,totalAssetCountForCurrentWebsite:FA.Background.assets.getForDomain(t&&t.tab&&t.tab.url).length,faMemberName:FA.Background.fa_member_name}},tIgnoreTab:function(e,t,o){FA.Background.isTabIgnored(t,!1)},isTabIgnored:function(e,t){var o=FA.Background.get_tab_id(e),n=PB.SessionData.autoLoginIgnoredTabIds||{},a=PB.utils.getUrlBaseDomain(e.tab.url),r=!1;"desktop-extension-firefox"==PB.config.target&&(o=workers.indexOf(e.tab.id)),n[a]||(n[a]=[]);var i=_.findWhere(n[a],{id:o});return i&&i.ignored?r=!0:i&&!t?i.ignored=!0:t||n[a].push({id:o,ignored:!PB.multistep[o]}),PB.SessionData.autoLoginIgnoredTabIds=n,r},initRegistration:function(e,t){PB.Authentication.register(e,t)},cancelAutoSave:function(e){var t=FA.Background.assets.get(PB.lastSavedId);t.destroy(function(){"desktop-extension-firefox"==PB.config.target&&FA.resync()})},neverSave:function(){var e=FA.Background.assets.get(PB.lastSavedId),t=new FA.Models.BlockedItem({path:e.get("url"),kind:"domain"});t.save(),FA.Background.blockedItems.add(t),e.destroy(function(){"desktop-extension-firefox"==PB.config.target&&FA.resync()})},tDoLogin:function(e,t,o){var n={email:e.faEmail,cpassword:e.faCpassword,source:e.source,login_context:e.login_context};this.doLogin(n,function(o){o&&(e.mixpanel_data&&FA.Background.mixpanel_activity(e.mixpanel_data),FA.Background.tempAssets.each(function(e){broke=!1,FA.Background.assets.getForDomain(e.get("url")).each(function(t){broke||(e.get("login")==t.get("login")&&e.get("cpassword")==t.getCPassword()?(FA.Background.tempAssets.remove(e),broke=!0):e.get("login")==t.get("login")&&t.get("member_id")==FA.Background.fa_member_id&&(e.attributes.asset_id=t.escape("id")))})}),FA.Background.tempAssets.length&&FA.Background.tempAssets.each(function(e){
FA.Background._saveAsset(e.cid,"",t)})),e.inpage&&"desktop-extension-firefox"==PB.config.target&&FA.resync(),o&&"desktop-extension-firefox"!=PB.config.target||FA.Background._sendLoginToPage(o)})},_sendLoginToPage:function(e){chrome.tabs.query({},function(t){_.each(t,function(t){chrome.tabs.sendMessage(t.id,{faTrigger:"tLoginDone",faStatus:e})})})},save_inpage_assets:function(e,t){if(!FA.Background.tempAssets.length)return void(t&&t());var o=!1;FA.Background.tempAssets.each(function(n){var a=n.get("token");if(null!=a&&a==e){o=!0;var r=n.escape("domain");assetType=FA.Background._detectAssetType(n.get("domain"));var i={type:assetType,url:n.get("url"),name:r,login:n.escape("login")};asset=new FA.Models.Asset,asset.cpassword=n.get("cpassword"),asset.save(i,{success:function(e,o){FA.Background.assets.add(e),FA.Background.tempAssets.remove(n);var a=n.get("url"),i={mixpanel_event:"create_password",mixpanel_params:{location:"in-page",state:"never_signed_up",website_url:a,asset_title:r,domain:Url.parse(a).domain}};FA.Background.mixpanel_activity(i),t&&t()},error:function(e,o,n){t&&t()}})}}),!o&&t&&t()},saveMasterPasswordStrength:function(e){if(FA.Background.zxcvbn){var t=FA.Background.zxcvbn(e);PB.UserSettings.set("masterPasswordStrength",t.score)}},tSetUserSettings:function(e,t,o){PB.UserSettings.set(e.args.key,e.args.value)},doLogin:function(e,t,o,n){PB.Authentication.login(e,t,o,!1,n)},doLogout:function(e){try{return hash={url:FA_Config_urlApi+"api_logout.json",type:"GET",_PB:{skipOn401Notify:!0},success:function(){e&&e()},error:function(){e&&e()}},FA.Background.clearSession(),"desktop-extension-firefox"==PB.config.target&&FA.resync(),chrome.tabs.query({},function(e){_.each(e,function(e){chrome.tabs.sendMessage(e.id,{faTrigger:"tLogoutDone"})})}),PB.WebsiteFlows.destroyAll(),FA.Background.extensionBadge.setState({state:"off"}),PB.Authentication.logout(),PB.API.isDown()?e&&e():$.ajax(hash),!1}catch(t){console.error(t)}},clearSession:function(){PB.settings.profile.reset(),PB.settings.key.reset(),PB.SessionData={},FA.Background.setCredentials(null,null,null,null,null),FA.Background.resetCollections(),FA.Background.fa_member=null,FA.Background.member_id=null,FA.Background.member_cid=null,FA.Background.member_key=null,FA.Background.offline_key=null},log:function(e){console.error(e)},resetCollections:function(){try{FA.Background.assets=new FA.Collections.Assets,FA.Background.blockedItems=new FA.Collections.BlockedItems,FA.Background.secrets=new FA.Collections.Secrets,FA.Background.generatedPasswords=new FA.Collections.GeneratedPasswords,FA.Background.contacts=new FA.Collections.Contacts,FA.Background.requests=new Array,FA.Background.counting=new Array,FA.Background.documents=new FA.Collections.Documents}catch(e){console.error(e)}},initCollections:function(e,t){FA.Background.succeedElem=new Array;var o=function(o,n){o.fetch({success:function(){FA.Background.doCallbackLogin(e,n,t)},error:function(t,o,n){e(!1)}})};o(FA.Background.assets,"asset"),o(FA.Background.blockedItems,"blocked"),o(FA.Background.secrets,"secret"),o(FA.Background.contacts,"contact"),o(FA.Background.documents,"document"),PB.sharing.requests(function(o){FA.Background.doCallbackLogin(e,"requests",t)}),PB.sharing.accepted(function(){}),FA.Background.generatedPasswords=new FA.Collections.GeneratedPasswords,PB.reward.getAll({},function(e){var t=[];e&&(_.each(e.data,function(e){e&&e.state&&e.handle&&"completed"==e.state&&t.push(e.handle)}),localStorage.setItem("completedRewards",t))})},doCallbackLogin:function(e,t,o){if(FA.Background.succeedElem[t]=!0,FA.Background.succeedElem.asset&&FA.Background.succeedElem.blocked&&FA.Background.succeedElem.secret&&FA.Background.succeedElem.contact&&FA.Background.succeedElem.requests&&FA.Background.succeedElem.document){FA.Background.assetsLoaded=!0,FA.Background.documents.groupByKind();{({assets:FA.Background.assets,blockedItems:FA.Background.blockedItems,secrets:FA.Background.secrets,contacts:FA.Background.contacts,documents:FA.Background.documents})}"undefined"!=typeof PB.user_activity&&PB.user_activity.import_user_assets(FA.Background.fa_login),!PB.Config.IS_LITE&&PB.settings.rememberPassword.isActive()&&PB.settings.rememberPassword.activate(!0),"desktop-extension-firefox"!=PB.config.target?$(document).trigger("collectionsLoaded"):FA.documentTrigger("collectionsLoaded"),"desktop-extension-firefox"!=PB.config.target&&chrome.extension.sendMessage({faTrigger:"refresh_collection"}),FA.Background.extensionBadge.updateState(),e&&e(!0),o||chrome.tabs.query({},function(e){_.each(e,function(e){chrome.tabs.sendMessage(e.id,{faTrigger:"tLoginDone",faStatus:!0,freemium_over:FA.Background.fa_member.freemium_over()})})})}},isFreemiumOver:function(){return FA.Background.fa_member&&FA.Background.fa_member.freemium_over()},go_premium:function(){"desktop-extension-firefox"==PB.config.target?(FA.Background.fa_member.set({trial:!1,asset_limit:-1}),FA.resync(),FA.refreshPanel()):FA.Background.fa_member.fetch(function(e,t,o){})},refreshCollections:function(e){FA.Background.initCollections(e,!0)},doCallbackRefresh:function(e,t){FA.Background.succeedElem[t]=!0,FA.Background.succeedElem.asset&&FA.Background.succeedElem.document&&FA.Background.succeedElem.blocked&&FA.Background.succeedElem.secret&&FA.Background.succeedElem.contact&&FA.Background.succeedElem.requests&&e(!1)},encryptWithRSA:function(e,t){return null===t&&(t=FA.Background.fa_rsaKey.jsonPublicKey),PB.crypto.RSA.encrypt(e,t)},decryptWithRSA:function(e){return PB.crypto.RSA.decrypt(e,FA.Background.fa_rsaKey.jsonPrivateKey)},encryptWithAES:function(e,t){return(null===t||"undefined"==typeof t)&&(t=FA.Background.fa_member.key),PB.crypto.AES.encrypt(e,t)},decryptWithAES:function(e){return PB.crypto.AES.decrypt(e,FA.Background.fa_member.key)},hasProfilePicture:function(){return PB.settings.profile.isActive()?FA.u():!1},setProfilePicture:function(){try{return PB.settings.rememberPassword.isActive()&&FA.v(!0),!0}catch(e){console.error("Error saving profile",e.message)}return!1},changeMasterPassword:function(e,t){PB.member.changeMasterPassword({oldPassword:e.old_mp,password:e.mp}).then(function(){FA.Background.updateCredentials("fa_cpassword",e.mp),FA.Background.setProfilePicture(),t(!0)},function(){t(!1)})},send_feedback:function(e,t){var o=t,n={url:FA_Config_urlApi+"contact_us",type:"POST",data:{message:e.message,awesome:e.awesome},success:function(e){PB.reward.signalEvent({name:"provide_feedback"},function(e){PB.mixpanel.track("completed_reward_task",{rewards_passwords_earned:FA.Background.fa_member.get("awarded_allowance"),rewards_earned:localStorage.getItem("completedRewards")||void 0,intent_name:"provide_feedback",reward_password_count:e.data.adjustment_value})}),o(!0)},error:function(e,t,n){o(!1)}};$.ajax(n)},send_sync_link:function(e,t){if(!e)var e={from:"",to:""};var o={url:FA_Config_urlApi+"email_sync_link",type:"GET",dataType:"json",data:e,success:function(e){t(!0)},error:function(e){t(!1)}};$.ajax(o)},setExperiment:function(e){var t=0;for(i=0;i<e.length;i++)t+=e.charCodeAt(i);localStorage.setItem("experiment",t)},toggleLoading:function(e){e?send="showRefresh":send="hideRefresh",chrome.extension.sendMessage({faTrigger:send})},tPreserveFromWelcome:function(e,t){var o=e.msg;PB.sharing.create(o,function(){},function(){})},tResetSettings:function(e,t){PB.settings.reset()},tCreateBulkAssets:function(e,t){if(e.data.credsFromLastAsset){var o=FA.Background.assets.get(PB.lastSavedId),n=o&&o.get("login"),a=o&&o.getCPassword();_.each(e.data.assets,function(e){e.login=n,e.cpassword=a})}FA.Background.tCreateAssets(e,t)},tCreateAssets:function(e,t,o){function n(e){o&&o({assets:u.length,duplicates:c,errors:e}),"desktop-extension-firefox"==PB.config.target&&FA.refreshPanel()}function a(e,t,o){for(var n=FA.Background.assets.models,a=0;a<n.length;++a){var r=n[a];if(t===r.get("login")&&o===r.getCPassword()&&e===r.get("url"))return console.warn("Duplicate found",e,t),!0}return!1}for(var r=e.data,i=r.assets,s=r.creds,c=0,l="boolean"==typeof e.bypassError?e.bypassError:!0,u=[],d=0;d<i.length;++d){var m=i[d],g=PB.utils.addProtocol(m.url),p=m.login,f=s?s.cpassword:m.cpassword;a(g,p,f)?c++:u.push({url:g,name:m.name,username:p,password:f})}PB.asset.create({data:u,bypassError:l},n)},tLoginFromBrowser:function(e,t){FA.Background.doLogin(e.data,function(o){PB.settings.rememberEmail.activate(),PB.Config.IS_LITE||(localStorage.setItem("rProfile",!0),PB.settings.rememberPassword.activate(!0)),localStorage.setItem("lastEmail",e.data.email),PB.settings.skipIntro.activate(),chrome.tabs.sendMessage(t.tab.id,{faTrigger:"tLoginFromBrowserDone",loginStatus:o}),"desktop-extension-firefox"==PB.config.target&&FA.refreshPanel()})},mixpanel_activity:function(e,t){PB.mixpanel.track_activity(e.mixpanel_event,e.mixpanel_params)},mixpanel_track:function(e,t){PB.mixpanel.track(e.mixpanel_event,e.mixpanel_params)},setStatus:function(e){if(e)FA.Background.extensionBadge.setState({state:e});else{var t=PB.settings.profile.get();FA.Background.extensionBadge.setState("string"==typeof t&&""!=t?{state:"on"}:{state:"off"})}},get_usernames:function(){var e=[];return FA.Background.assets.each(function(t){var o=t.get("login");e.indexOf(o)<0&&e.push(o)}),e},get_tab_id:function(e){if("undefined"==typeof e.tab)return-1;var t=e.tab.id;if(-1===["number","string"].indexOf(typeof t)&&(t=e.tab.index,-1===["number","string"].indexOf(typeof t)&&(t=-1,"undefined"!=typeof safari))){var o=safari.application.activeBrowserWindow.tabs;_.each(o,function(o,n){o===e.tab.id&&(t=n)})}return t},avgInpageShown:function(){localStorage.setItem("avgAddedInpageShown",!0)},tGetWebsiteFlowState:function(e,t,o){o({faCallback:"cbWebsiteFlowStateReceived",websiteFlow:PB.WebsiteFlows.findByUrl(t.tab.url)})},tCancelWebsiteFlow:function(e,t,o){PB.WebsiteFlows.destroy(e.flowID)},processForms:function(e,t){chrome.tabs.sendMessage(t.tab.id,{faCallback:"processForms",faContentscript:"formManager"})},reload_background_data:function(e,t,o){FA.Background.contentscriptData(e,t,function(e){chrome.tabs.sendMessage(t.tab.id,e)})},firstBackgroundQuery:function(e,t,o){FA.Background.contentscriptData(e,t,function(e){o(e),PB.AutoLoginTimeout.reset_timer()})},contentscriptData:function(e,t,o){var n=FA.Background.get_tab_id(t),a=PB.utils.standardizeProtocol(e.url),r=FA.getDomainFromUrl(a),i=!0,s=FA.Background.getLocalStorageItem("language"),c=localStorage.getItem("experiment_variation")?localStorage.getItem("experiment_variation"):null;"null"==c&&(c=null);var l=localStorage.getItem("network"),u="w_avg"==l||"avg"==l||"avg_u"==l||"avg_exp"==l;u&&-1==e.url.indexOf("passwordbox.com")&&-1==e.url.indexOf("psswrdbx.com")&&-1==e.url.indexOf("0.0.0.0")&&(i=!!localStorage.getItem("avgAddedInpageShown")),u&&null!=c&&"desktop-extension-ie"==PB.config.target&&(c="variation8");var d={};s&&"en_US"!=s||"desktop-extension-chrome"!=PB.config.target||(d=_.extend(d,{exp_delayed_signup_inpage_style:AB.exp_delayed_signup_inpage_style,exp_delayed_signup_modal_inpage_call_to_actions:AB.exp_delayed_signup_modal_inpage_call_to_actions,exp_delayed_signup_tooltip_inpage_color:AB.exp_delayed_signup_tooltip_inpage_color,exp_autosave_inpage_display:AB.exp_autosave_inpage_display,exp_login_prompt_inpage_style:AB.exp_login_prompt_inpage_style}),_.each(_.keys(d),function(e){"undefined"==typeof d[e]&&delete d[e]}));var m=this.getAssetsForCurrentWebsite(e,t);PB.multistep=PB.multistep||{tempUsername:{}};var g={faCallback:"firstBackgroundResponse",obj:PB.user_activity.obj,assets:m,logged_in:null!=FA.Background.fa_login&&"undefined"!=typeof FA.Background.fa_login,fa_welcome_page:PB.Utility.generateWelcomeUrl(localStorage.getItem("network")),tabs:FA.Background.isTabIgnored(t,!0),tab:{id:FA.Background.get_tab_id(t)},is_lite:PB.Config.IS_LITE||AB.protected_partner,startpage_enabled:PB.startpage||!1,startpage_url:PB.startpage_url||"",freemium_over:!1,isBrowserOpen:e.isIframe?!1:FA.Background.isBrowserOpen,AB:"undefined"!=typeof AB?AB:{},intelForUrl:JSON.stringify(PB.BI.getIntelForUrl(e.url)),passgenSettings:PB.UserSettings.get(["passgen.stringLength","passgen.letters","passgen.digits","passgen.capitals","passgen.symbols","passgen.enabled","passgen.stringLength"]),env:PB.Config.env||"production",testRunner:PB.testRunner&&PB.testRunner.firstBackgroundQuery(e,t),extension_version:FA_version,activeExperiments:c?PB.experiments.AVG[c]&&PB.experiments.AVG[c].props:{},experiments:d,misc:{installDate:AB.install_date,assetCount:FA.Background.assets.length,mostRecentUser:Storage.getItem("lastEmail"),hasTried1Click:!!PB.UserSettings.get("try_1click"),isOffline:PB.API.isDown(),showAvgAddedInpage:!i&&PB.hasExtToolbar,signupUrl:PB.Utility.generateWelcomeUrl(localStorage.getItem("network"),"inpage")||PB.Config.URL_WELCOME,language:FA.Background.getLocalStorageItem("language"),isIgnoredNeverSignedUp:_.indexOf(this.ignoredNeverSignedUp,PB.utils.removeSubdomain(PB.utils.getUrlBaseDomain(e.url)))>=0,websiteFlowSites:this.websiteFlowSites,displayNotificationTab:!PB.settings.csLoadCount.get(),mac_address:"undefined"!=typeof AB.mac_address?AB.mac_address:"",invitations:FA.Background.get_sharing_invitations()+FA.Background.get_legacy_invitations(),loginPromptInpageDisabled:localStorage.getItem("loginPromptInpageDisabled"),creditcards:_.map(FA.Background.documents.byKind.cc,function(e){var t=e.get("number")||"",o=e.get("expiryDate"),n=o?moment(e.get("expiryDate")):null;return{id:e.get("id"),cardholder:e.get("cardholder")||"",number:t||"",name:e.get("title")||"Credit Card",expiryYear:n?n.year():void 0,expiryMonth:n?n.month()+1:void 0}}),lastAccountSelected:FA.Background.lastAccountSelected,isInShorttail:FA.Background.isInShorttail(e.url),lastPageWithSubmit:FA.Background.lastPageWithSubmit(t),multistep:PB.multistep[n],tempMultistepUsername:PB.multistep.tempUsername[Url.parse(e.url).domain],boxfullNagDisabled:this._isBoxfullNagDisabled(e.url)}};e.isInpage&&_.extend(g.misc,{meta:PB.Meta.getMeta(e.inpageReferrerUrl)}),u&&"overlayNeverSignedUp2"==g.activeExperiments.neverSignedUpVariation&&"desktop-extension-firefox"==PB.config.target&&(g.activeExperiments.neverSignedUpVariation="none"),e.isIframe||"http://vip.passwordbox.com/"==e.url||"https://vip.passwordbox.com/"==e.url||(FA.Background.isBrowserOpen=!1),FA.Background.hasCredentials()&&FA.Background.fa_member&&(g.freemium_over=FA.Background.fa_member.get("trial")&&FA.Background.fa_member.assets_limit_reached(),g.freemium_url=FA.Background.fa_member.get_premium_link("inpage"),g.box_fullness=FA.Background.fa_member.get_box_fullness(),g.loginsForCurrentUrl=FA.Background.assets.filter(function(e){return"1"==e.get("settings").subdomain_only&&r==FA.getDomainFromUrl(e.get("url"))?!0:FA.isDomainInTopDomain(r,e.get("domain"))?!0:!1}));var p=PB.UserSettings.get("tutorial_1click");"string"==typeof p&&(g.misc.tutorial_1click=p);var f=!1;chrome.cookies.getAll({domain:".passwordbox.com"},function(t){_.each(t,function(e){"p"==e.name?f=!0:"lang"!=e.name||g.misc.language||(g.misc.language=e.value)}),g.misc.language||(g.misc.language="en_US"),g.hasPCookie=f,e.domain&&e.needMetaForUrl?PB.BI.getAtlasMeta(e.domain,function(e,t){e&&(PB.debug("pb:bg:fa_background")("Failed to retrieve atlas data: "+e),g.atlasApiError=!0),t&&(g.atlasMetaForUrl=JSON.stringify(t)),o(g)}):o(g)})},_isBoxfullNagDisabled:function(e){var t=PB.utils.removeSubdomain(PB.utils.getUrlBaseDomain(e)),o=PB.UserSettings.get("boxfull-nag-domains")||[];return o.indexOf(t)>=0},tDisableBoxFullNag:function(e,t,o){var n=PB.utils.removeSubdomain(PB.utils.getUrlBaseDomain(e.url)),a=PB.UserSettings.get("boxfull-nag-domains")||[];a.push(n),PB.UserSettings.set("boxfull-nag-domains",a)},recordSubmit:function(e,t){FA.Background.submits||(FA.Background.submits=[]);var o=FA.Background.get_tab_id(t),n=FA.Background.submits[o];if(!n||"one_click_login"!=n.login_type&&"seamless_login"!=n.login_type){FA.Background.submits[o]={website_url:e.data.url,date:new Date};var a=["tabId"];FA.Background.submits[o]=_.extend(FA.Background.submits[o],_.omit(e.data,a))}},reportLoginSuccess:function(e,t,o){var n=e.loginResult;if(!n.partialLogin){"one_click_login"==t.login_type&&delete PB.oneclickAsset;var a=Url.parse(t.website_url);if(!a.port&&!PB.utils.matchesIPv4(a.hostname)){var r={login_successful:!n.isLoginPage,url_after_submit:o.tab.url,ml_was_crowdsource_form_purged:n.crowdsourcePurge,login_score:n.score,login_detect_reasons:n.login_detect_reasons,has_login_or_signup_form:n.hasLoginOrSignupForm,has_two_factor_form:n.hasTwoFactorForm,has_login_link:n.hasLoginLink,has_logout_link_or_input:n.hasLogoutLinkOrInput,has_logout_link_or_input_and_login_or_signup_form:n.hasLogoutLinkOrInputAndLoginOrSignupForm,has_login_attribute:n.hasLoginAttribute,has_logout_attribute:n.hasLogoutAttribute,has_login_url:n.hasLoginUrl,has_login_validation_error:n.hasLoginValidationError,nb_login_detect_retries:n.nb_login_detect_retries,is_cs_reinit:e.is_cs_reinit},i=_.omit(t,["form","date","url"]);r=_.extend(r,i),PB.mixpanel.track_activity("account_login",r),n.isLoginPage||"fdetect"!=t.form_detection_technique||PB.BI.setMetaForDomain(t.domain,[t.form])}}},syncLogin:function(e,t,o){var n=PB.settings.key.get(),a=PB.settings.profile.get();n&&a&&o({key:n,profile:a,faCallback:"loginSync"})},get_sharing_invitations:function(){var e=FA.Background.requests,t=_.filter(e,function(e){return 1!=e.preserve}).length,o=PB.Public.getAllNonConfirmedSharedAssets();return o="undefined"!=typeof o?o.length:0,t+o},get_legacy_invitations:function(){var e=FA.Background.requests;return _.filter(e,function(e){return 1==e.preserve}).length},isInShorttail:function(e){if(!PB.shorttailWebsites)return!1;var t=PB.utils.removeSubdomain(PB.utils.getUrlBaseDomain(e));return!!~PB.shorttailWebsites.indexOf(t)},incrementCsLoadCount:function(){PB.settings.csLoadCount.increment()},tLoginSync:function(e){FA.Background.doLogin(e.args,function(){"desktop-extension-firefox"==PB.config.target&&FA.refreshPanel()})},getSessionDataDisplayedTab:function(e,t,o){if(!e.args)return void console.error("getSessionDataDisplayedTab() requires args");var n=PB.SessionData.displayedTab;!e.args.selfOnly||!n||t.tab&&n._tabId&&n._tabId==t.tab.id||(n=null),o({faCallback:"gotSessionDataDisplayedTab",value:n})},setSessionDataDisplayedTab:function(e,t){if(!e.args)return void console.error("setSessionDataDisplayedTab() requires args");var o=PB.Utility.parseUrl(t.tab.url);if("dev0.psswrdbx.com"!=o.host){e.args.value&&t.tab&&!isNaN(t.tab.id)&&(e.args.value._tabId=t.tab.id),PB.SessionData.displayedTab=e.args.value;var n=FA.Background.tempAssets.length&&FA.Background.tempAssets.any(function(e){return"reset"==e.get("form").formType});e.args.value||n||(PB.SessionData.queueTempAssetRemoval=!0)}},getAB:function(){return"undefined"!=typeof AB?JSON.stringify(AB):null},savePage:function(e,t){},clearCookies:function(e,t,o){if("desktop-extension-chrome"==PB.config.target)if(t&&0!==t.indexOf("http")&&(t="http://"+t),"all"==e)chrome.cookies.getAll({},function(e){_.each(e,function(e){if(-1==e.domain.indexOf("passwordbox.com")&&-1==e.domain.indexOf("psswrdbx.com")){var t="http://";e.secure&&(t="https://");var o={url:t+e.domain+e.path,name:e.name};chrome.cookies.remove(o)}})}),FA.Background.refreshTabs();else if("vanilla"==e)chrome.cookies.remove(o),FA.Background.refreshTabs();else if("popular"==e)_.each(FA.Background.websiteFlowSites,function(e,t){FA.Background.clearCookies("single","http://"+e)}),FA.Background.refreshTabs();else{var n=PB.utils.removeSubdomain(FA.getDomainFromUrl(t));chrome.cookies.getAll({domain:n},function(e){for(var t=0;t<e.length;t++){var o=e[t];chrome.cookies.remove({url:"http"+(o.secure?"s":"")+"://"+n+o.path,name:o.name}),chrome.cookies.remove({url:"http"+(o.secure?"s":"")+"://www."+n+o.path,name:o.name}),chrome.cookies.remove({url:"http"+(o.secure?"s":"")+"://."+n+o.path,name:o.name})}})}},refreshTabs:function(){chrome.tabs.query({},function(e){_.each(e,function(e){var t="window.location.reload();";chrome.tabs.executeScript&&chrome.tabs.executeScript(e.id,{code:t})})})},tDisableLoginPrompt:function(){this.setLocalStorageItem("loginPromptDisabled","true")},tDisableLoginPromptInpage:function(){this.setLocalStorageItem("loginPromptInpageDisabled","true")},getLocalStorageItem:function(e){var t=localStorage.getItem(e);try{return JSON.parse(t)}catch(o){return t}},setLocalStorageItem:function(e,t){localStorage.setItem(e,t)},keepTempAsset:function(){PB.SessionData.queueTempAssetRemoval=!1},getAllGeneratedPasswords:function(){return _.map(FA.Background.generatedPasswords.models,function(e){return{password:e.get("password"),domain:e.get("domain"),date:e.get("date")}})},tCreateGeneratedPassword:function(e,t){FA.Background.createGeneratedPassword(e.attributes)},createGeneratedPassword:function(e){"psswrdbx.com"!=e.domain&&FA.Background.generatedPasswords.create(e)},removeAllGeneratedPasswords:function(){FA.Background.generatedPasswords.removeAll()},getChromeExtensionID:function(){return"desktop-extension-chrome"==PB.config.target?chrome_extension_id:void 0},setLastAccountSelected:function(e,t,o){FA.Background.lastAccountSelected=e.asset},tDeleteAssetFromCS:function(e,t,o){FA.Background.assets.get(e.assetID).destroy()},tDelayTracking:function(e){localStorage.getItem("timerActive")||(localStorage.setItem("timerActive",!0),setTimeout(function(){PB.mixpanel.track(e.mixpanel_event,e.mixpanel_params),localStorage.removeItem("timerActive")},e.delay))}},localStorage&&localStorage.getItem("pb_log")&&localStorage.removeItem("pb_log"),chrome.extension.onMessage.addListener(function(e,t,o){try{if("desktop-extension-safari"==PB.config.target){var n=(e.target.page,e.message.contextID);o=function(e){_msg=JSON.stringify(e),e=JSON.parse(_msg),e.contextID=n,t.tab.id.page.dispatchMessage("from_bg",e)},t={tab:{url:e.target.url,id:e.target.browserWindow.activeTab}},e=e.message}else"string"==typeof e&&(e=JSON.parse(e));var a=null;switch(e.faTrigger){case"fetchContentScript":if("desktop-extension-ie"==PB.config.target){var r,i=passwordBoxObj.homeDir+"build\\js\\content-script.js",s=new AxADODBStream;s.CharSet="utf-8",s.Open();try{s.LoadFromFile(i),r=s.ReadText()}catch(c){console.error("Cannot read file: "+c.message,i)}finally{s.Close()}o(r)}else{var l=chrome.extension.getURL("build/js/content-script.js");$.get(l,function(e){o(e)})}break;case"copyToClipboard":a=FA.Background.copyToClipboard(e,t);break;case"tAddToIgnoredNeverSignedUp":a=FA.Background.tAddToIgnoredNeverSignedUp(e,t);break;case"tCancelWebsiteFlow":a=FA.Background.tCancelWebsiteFlow(e,t);break;case"tWebsiteFlowReport":a=FA.Background.tWebsiteFlowReport(e,t);break;case"tAssetDetection":a=FA.Background.tAssetDetection(e,t);break;case"tGetViralAssets":a=FA.Background.tGetViralAssets(e,t,o);break;case"tGetSuggestions":a=FA.Background.tGetSuggestions(e,t,o);break;case"tIgnoreTab":a=FA.Background.tIgnoreTab(e,t,o);break;case"secondBackgroundQuery":a=FA.Background.secondBackgroundQuery(e,t,o);break;case"tValidateTemp":a=FA.Background.tValidateTemp(e,t);break;case"tRemoveTemp":a=FA.Background.tRemoveTemp(e,t);break;case"tReportWebsite":a=FA.Background.tReportWebsite(e,t);break;case"tDisableAutologin":a=FA.Background.tDisableAutologin(e,t);break;case"tShareAsset":a=FA.Background.tShareAsset(e,t);break;case"tDoLogin":a=FA.Background.tDoLogin(e,t,o);break;case"tWelcomeSignup":FA.Background.tWelcomeSignup(e,t);break;case"tLoginFromBrowser":FA.Background.tLoginFromBrowser(e,t);break;case"tLoginSync":FA.Background.doLogin(e.args,function(){});break;case"tPreserveFromWelcome":FA.Background.tPreserveFromWelcome(e,t);break;case"tCreateAssets":FA.Background.tCreateAssets(e,t,o);break;case"tCreateBulkAssets":FA.Background.tCreateBulkAssets(e,t);break;case"tResetSettings":FA.Background.tResetSettings(e,t);break;case"tLogout":FA.Background.doLogout();break;case"tClearCookies":FA.Background.clearCookies(e.scope,e.url);break;case"tGetWebsiteFlowState":FA.Background.tGetWebsiteFlowState(e,t,o);break;case"tLoginDetection":a=FA.Background.tLoginDetection(e,t,o);break;case"mixpanel":FA.Background.mixpanel(e,t);break;case"mixpanel_activity":FA.Background.mixpanel_activity(e,t);break;case"mixpanel_track":FA.Background.mixpanel_track(e,t);break;case"cancelAutoSave":FA.Background.cancelAutoSave(e,t);break;case"neverSave":FA.Background.neverSave();break;case"firstBackgroundQuery":FA.Background.firstBackgroundQuery(e,t,o);break;case"setLastAccountSelected":FA.Background.setLastAccountSelected(e,t,o);break;case"getWelcomeFlowState":FA.Background.getWelcomeFlowState(e,t,o);break;case"reload_background_data":FA.Background.reload_background_data(e,t,o);break;case"processForms":FA.Background.processForms(e,t,o);break;case"avgInpageShown":FA.Background.avgInpageShown();break;case"go_premium":FA.Background.go_premium();break;case"syncLogin":FA.Background.syncLogin(e,t,o);break;case"recordSubmit":FA.Background.recordSubmit(e,t);break;case"tSupportNotificationSeen":a=FA.Background.tSupportNotificationSeen(e,t);break;case"getSessionDataDisplayedTab":FA.Background.getSessionDataDisplayedTab(e,t,o);break;case"setSessionDataDisplayedTab":FA.Background.setSessionDataDisplayedTab(e,t,o);break;case"incrementCsLoadCount":FA.Background.incrementCsLoadCount(e,t,o);break;case"savePage":FA.Background.savePage(e,t,o);break;case"tAutosaveWelcomeFlow":FA.Background.tAutosaveWelcomeFlow(e,t,o);break;case"tAutoLoginFromWelcome":FA.Background.tAutoLoginFromWelcome(e,t,o);break;case"tDisableLoginPrompt":FA.Background.tDisableLoginPrompt(e,t,o);break;case"tDisableLoginPromptInpage":FA.Background.tDisableLoginPromptInpage(e,t,o);break;case"enableStartpage":chrome.cookies.getAll({domain:"passwordbox.com"},function(e){_.each(e,function(e){"p"==e.name&&localStorage.setItem("force_enable_startpage",!0)})});break;case"keepTempAsset":FA.Background.keepTempAsset(e,t,o);break;case"tSetUserSettings":FA.Background.tSetUserSettings(e,t,o);break;case"tCreateGeneratedPassword":FA.Background.tCreateGeneratedPassword(e,t,o);break;case"tDeleteAssetFromCS":FA.Background.tDeleteAssetFromCS(e,t,o);break;case"tDisableBoxFullNag":FA.Background.tDisableBoxFullNag(e,t,o)}return a&&o(a),!0}catch(c){console.error("error in listener",c,e,t)}}),FA.Background.fetchLocale=function(){FA.Background.locale=localStorage.getItem("pb_locale"),null==FA.Background.locale&&$.ajax({url:FA_Config_urlApi+"request/show/country",type:"GET",dataType:"json",error:function(){console.log("Locale error: could not fetch user locale")},success:function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(t){return console.log("Unable to parse locale")}if(e&&e.request&&e.request.country_code){var o=e.request.country_code;localStorage.setItem("pb_locale",o),FA.Background.locale=o}}})},FA.Background.documents=new FA.Collections.Documents,FA.Background.documents.bind("reset",function(e,t){FA.Background.documents.each(function(e){e.decryptContent()})}),FA.Background.extensionBadge=function(){function e(e){if(e&&e.state){switch(n=e.state.toLowerCase()){case"off":a=i.black,r="OFF";break;case"on":a=i.green,r="ON";break;case"alert":a=i.red,r=e.text||"1";break;default:throw"FA.Background.extensionBadge: Trying to set undefined state"}o()}}function t(){var t=FA.Background.get_sharing_invitations()+FA.Background.get_legacy_invitations();e(t>0?{state:"alert",text:String(t)}:{state:"on"})}function o(){if("desktop-extension-chrome"==PB.config.target)chrome.browserAction.setBadgeBackgroundColor({color:a}),chrome.browserAction.setBadgeText({text:r});else{var e;"on"==n?e="build/images/ext/on.png":"off"==n?e="build/images/ext/off.png":"alert"==n&&(e="desktop-extension-safari"==PB.config.target?"build/images/ext/on.png":"build/images/ext/new.png"),chrome.browserAction&&chrome.browserAction.setIcon({path:e}),FA.setIconListener&&FA.setIconListener(e)}}var n,a,r,i=(FA.Background,{black:"#222222",green:"#5b8802",red:"#c60a06"});return{setState:e,updateState:t}}(),!function(e,t){e.PB||(e.PB={}),e.PB.testRunner=t()}(this,function(){function e(e,t){clearTimeout(a);var o=FA.Background.get_tab_id(t);return r[o]}function t(e){var t=FA.Background.get_tab_id(e);r[t].events=[]}function o(e,t){if(e){var o=FA.Background.get_tab_id(t);switch(r[o]||(r[o]={}),r[o].events||(r[o].events=[]),r[o].events.push(e),e.name){case"submit form":a=setTimeout(function(){"desktop-extension-chrome"===PB.config.target&&chrome.extension.sendMessage({type:"testRunner",faTrigger:"request background data"})},1500)}}}function n(){chrome.tabs.create({url:"test/index.html"})}var a,r={};return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.extension&&chrome.extension.onMessage.addListener(function(e,n,a){if("testRunner"===e.type)switch(e.faTrigger){case"check successful login":a(PB.LD.checkLoginSuccess(n));break;case"record event":o(e.event,n);break;case"reset events":t(n)}}),{firstBackgroundQuery:e,launch:n}});var cachedMeta,META_PATH="http://a0.psswrdbx.com/tmp/m3/",message2Handlers={getUser:function(e,t){var o=null;null!=FA.Background.fa_member&&(o=FA.Background.fa_member.toJSON(),o.assets=_.map(FA.Background.assets.models,function(e){return e.toJSON()})),t(o)},login:function(e,t){FA.Background.doLogin(e,t)},logout:function(e,t){FA.Background.doLogout(),t(!0)},register:function(e,t){console.log("bg register",e),FA.Background.initRegistration(e,t)},getMeta:function(e,t){var o=META_PATH+"meta.txt",n=PB.Public.getMetaCache();return null==n?("undefined"==typeof $.ajax?doGetRequest(o,function(e,o){PB.Public.setMetaCache(o),t(n)}):$.ajax({url:o,dataType:"text",mimeType:"text/plain",cache:!0,success:function(e){n=e,t(n)}}),!0):void t(n)},setSettings:function(e,t){var o=e.namespace||"",n=BackgroundSettings.get(o);_.extend(n,e.values),BackgroundSettings.set(o,n),t({})},getSettings:function(e,t){var o=e.namespace||"",n=BackgroundSettings.get(o);t(n)},getBrowserSites:function(e,t){message2Handlers.getHistory({},function(e){message2Handlers.getBookmarks({},function(o){t({bookmarks:o,history:e})})})},getHistory:function(e,t){},getBookmarks:function(e,t){},getSuggestions:function(e,t){var o=(_.extend(e.limit,{prepend:["ebay.com","amazon.com","facebook.com"]}),PB.Browser.getSuggestions(e));t(o)},getPersonalizedSites:function(e,t){PB.Browser.getBookmarks(function(e){console.log(e),PB.Browser.getMostVisitedDomains(function(o){var n=PB.Algorithms.Favorites.get([],o,e);t(n)})})},autoLoginQueue:function(e){PB.AutoLogin.queue({assetId:e.assetId})}};"undefined"!=typeof chrome&&"undefined"!=typeof chrome.extension&&chrome.extension.onMessage.addListener(function(e,t,o){if("undefined"!=typeof e.message2&&null!=e.message2){var n=message2Handlers[e.message2];return n?void n(e.args,o):console.error("No handler for",e.message2)}});var BackgroundSettings={set:function(e,t){localStorage.setItem("bgsettings_"+e,JSON.stringify(t))},get:function(e){var t=localStorage.getItem("bgsettings_"+e);if(!t)return{};try{return JSON.parse(t)||{}}catch(o){return{}}}};PB="undefined"==typeof PB?{}:PB,PB.message2Handlers=message2Handlers,"undefined"==typeof PB&&(PB={}),PB.shorttailWebsites=["facebook.com","google.com","live.com","yahoo.com","odnoklassniki.ru","vk.com","paypal.com","twitter.com","chase.com","wellsfargo.com","aol.com","linkedin.com","ebay.com","amazon.com","americanexpress.com","mail.ru","dropbox.com","comcast.net","reddit.com","seznam.cz","yandex.ru","irctc.co.in","pof.com","aliexpress.com","zing.vn","draugiem.lv","capitalone.com","td.com","abv.bg","daum.net","ebay.de","ncore.cc","gameforge.com","att.com","salesforce.com","netflix.com","ask.fm","icloud.com","secureserver.net","ok.ru","att.net","ebay.co.uk","naver.com","schwab.com","tiberiumalliances.com","fc2.com","bigpoint.com","bookoffonline.co.jp","intuit.com","craigslist.org","mailchimp.com","rutracker.org","gmx.net","evernote.com","booking.com","rakuten.co.jp","box.com","apple.com","mail.com","stardoll.com","instagram.com","oasgames.com","adam4adam.com","fidelity.com","gametwist.com","etsy.com","lloydsbank.co.uk","ing.nl","prodigy.co.id","skype.com","regions.com","delta.com","bnc.ca","bell.ca","freemail.hu","videotron.com","usaa.com","azet.sk","0.1","badoo.com","citibank.com","etrade.com","amazon.co.jp","suntrust.com","one.com","1.1","southwest.com","pinterest.com","imperiaonline.org","wordpress.com","rr.com","mint.com","accountonline.com","113.com.tw","manhunt.net","halifax-online.co.uk","lacaixa.es","creditkarma.com","blackboard.com","onliner.by","edmodo.com","uol.com.br","united.com","omnivox.ca","iebschool.com","grepolis.com","olx.bg","sbisec.co.jp","citromail.hu","bankleumi.co.il","nexon.com","cox.net","roblox.com","bluehost.com","1und1.de","filelist.ro","wargaming.net","xero.com","bankofamerica.com","amazon.co.uk","inbox.lv","phoenix.edu","sfimg.com","videotron.ca","gmx.com","godaddy.com","virginmedia.com","tripleclicks.com","shaw.ca","360game.vn","commerzbank.de","mixi.jp","web.de","xing.com","reseaucontact.com","scottrade.com","lectio.dk","usherbrooke.ca","miramagia.com","free.fr","airdroid.com","rackspace.com","samsung.com","wp.pl","gm99.com","amazon.de","ulaval.ca","pandora.com","zendesk.com","pixiv.net","tiscali.it","laposte.net","sfr.fr","boerse.bz","etorrent.co.kr","timewarnercable.com","fetc.net.tw","ups.com","livejournal.com","usps.com","bt.com","osullivan-quebec.qc.ca","royalgames.com","sky.com","earthlink.net","mypearson.com","thesettlersonline.ru","onlinelic.in","mundogaturro.com","deviantart.com","qiwi.ru","naukri.com","rallydev.com","twitch.tv","networksolutionsemail.com","ukr.net","banquelaurentienne.ca","odesk.com","leboncoin.fr","onlinesbi.com","planb4you.eu","travian.com","fnb.co.za","qiwi.com","jalf.com","go.com","va.gov","logmein.com","playforia.net","fiducia.de","dmm.com","t411.me","globallshare.com","k12.com","suvidhaa.com","i.ua","yad2.co.il","tdc.dk","gayromeo.com","clien.net","ebay.com.au","expediapartnercentral.com","kaiserpermanente.org","chess.com","poste.it","diepkhuc.com","barebackrt.com","infusionsoft.com","itslearning.com","marriott.com","rakuten-card.co.jp","op.fi","downparadise.ws","ownersleague.jp","renren.com","secondlife.com","nate.com","play4free.com","slrclub.com","11st.co.kr","gsis.gr","garmin.com","privatbank.ua","centris.ca","fedex.com","kohls.com","alibaba.com","orange.fr","avanza.se","minecraft.net","statcounter.com","myherbalife.com","logme.in","baidu.com","elance.com","ebay.it","telekom.com","hp.com","hattrick.org","concursolutions.com","creditonebank.com","amazon.ca","cox.com","flexmls.com","stargames.com","ruten.com.tw","torrentleech.org","99designs.com","atlassian.net","pogo.com","1and1.com","futballkupa.hu","meetme.com","fpts.com.vn","onetrail.net","statefarm.com","leisertv.com","recon.com","telenet.be","nnm-club.me","smartresponder.ru","hootsuite.com","booksecure.net","okta.com","olx.hu","earthlinktele.com:8008","milanuncios.com","goldenbirds.biz","jappy.de","netsuite.com","thailovelinks.com","ivegan.it","tunisia-sat.com","walgreens.com","netteller.com","losrios.edu","animaljam.com","rambler.ru","ipko.pl","libertagia.com","veikkaus.fi","rediff.com","docusign.net","drummerworld.com","cic.fr","mcgill.ca","bigpond.com","safe-mail.net","netspend.com","charter.net","brazzers.com","thwebgame.com","taleo.net","thecloudnetwork.net","probux.com","bpiexpressonline.com","forgeofempires.com","mysurvey.com","sharebuilder.com","paymentech.com","segelbekleidung-nord.de","constantcontact.com","dishnetwork.com","adobe.com","diablotorrent.net","aweber.com","directv.com","billmelater.com","zoho.com","mynet.com","tamo.lt","shareyt.com","addmefast.com","rogers.com","hydroquebec.com","cashtasks.com","onlinesoccermanager.com","weebly.com","juno.com","trademe.co.nz","seafight.com","montrealwebcam.com","nazwa.pl","yahoo.co.jp","iplt20.com","karvy.com","elmaz.com","fleecysgame.com","chaturbate.com","todayhumor.co.kr","mizrahi-tefahot.co.il","angieslist.com","rapidgator.net","dkb.de","pof.com.br","shutterfly.com","fastmail.fm","sonyentertainmentnetwork.com","efunfun.com","klikbca.com","netbk.co.jp","tdbank.com","marktplaats.nl","mtatar.com","maccabi4u.co.il","walla.co.il","hec.ca","tagged.com","ziggo.nl","manjam.com","buysmart.co.in","hostgator.com:2083","github.com","fabswingers.com","mydocomo.com","anno-online.com","cryptsy.com","libraryreserve.com","kfu.edu.sa","sprint.com","feide.no","saunalahti.fi","onet.pl","orange.co.uk","ibm.com","garanti.com.tr","banquepopulaire.fr","ameba.jp","groupon.com","gsn.com","hushmail.com","rdslink.ro","dsebd.org","uquebec.ca","adultfriendfinder.com","travian.co.id","nab.com.au","walmart.com","netzero.net","myadvertisingpays.com","hi-bogo.net","enkicsitanyam.hu","erepublik.com","nk.pl","way2sms.com","lds.org","jackpotjoy.com","purdue.edu","bankmandiri.co.id","rs.ge","lyoness.net","optimum.net","risingcities.com","kyk.gov.tr","discovery.com","twoo.com","mlgame.ru","huayugame.com","seniorpeoplemeet.com","mygully.com","macromill.com","ebay.fr","usg.edu","bwin.com","match.com","earthlinktele.com","barnesandnoble.com","telus.com","ipage.com","ojooo.com","monclasseur.com","ebay.in","clegc-gckey.gc.ca","sapo.pt","beeline.ru","magtifun.ge","amazon.fr","disqus.com","kabeldeutschland.de","montrealamateur.com","g66.eu","kiwibank.co.nz","freshbooks.com","homeaway.com","freenet.de","ebay.ca","cogeco.ca","idbibank.co.in","deutsche-bank.de","thesettlersonline.fr","asana.com","ezjoy.com.my","force.com","lindoamor.lt","westpac.co.nz","jcb.co.jp","serpfox.com","onlineaccess1.com","sat.gob.mx","telia.com","ourtime.com","eharmony.com","adjarabet.com","wmtransfer.com","2.100","anthem.com","deped.gov.ph","starbucks.com","sagaauto.com.pl","inven.co.kr","garena.in.th","socialadr.com","procreditbank.bg","csabitasboljeles.hu","airg.com","content-square.fr","loquax.co.uk","swefilmer.com","ma-bimbo.com","autotask.net","teamviewer.com","desk.com","fibi-online.co.il","centrum.cz","usajobs.gov","webgame.in.th","ashford.edu","planetromeo.com","getpocket.com","evsc.k12.in.us","dnevnik.ru","ongame.vn","agenziaentrate.gov.it","frontier.com","yandex.ua","wmmail.ru","stargames.net","41.14","connexus.com","gametwist.net","biatnet.com.tn","amazon.it","numericable.fr","vimeo.com","gunii.us","szn.cz","cspl.ru","zulutrade.com","jw.org","qualys.com","corrlinks.com","adp.com","pearson.com","lendingclub.com","smartschool.be","infoq.jp","gametwist.nl","50.1","zoznam.sk","aa.com","neteller.com","moi.gov.sa","jkforum.net","iiserpune.ac.in","arubanetworks.com","equator.com","nicovideo.jp","meraki.com","gittigidiyor.com","bouyguestelecom.fr","ea.com","digitalocean.com","jvzoo.com","frenchtorrentdb.com","bpinet.pt","epost.ca","narmobile.az","avito.ru","vn-zoom.com","travian.fr","utexas.edu","instructure.com","fio.cz","leagueoflegends.com","ptasp.com","gouv.qc.ca","gov.ar","waldenu.edu","csn.qc.ca","squareup.com","gov.hu","otto.de","national-lottery.co.uk","a8.net","sgcpanel.com:2096","gotomypc.com","myshopify.com","sahibinden.com","telecom.pt","onelogin.com","pmang.com","airbnb.com","serve.com","lumosity.com","t-home.mk","cztorrent.net","unibet.com","smartsheet.com","alpha.gr","rummycircle.com","centrelink.gov.au","manilla.com","myfreefarm.de","univ-nantes.fr","xda-developers.com","1and1.es","centurylink.com","symbaloo.com","kpnmail.nl","bovada.lv","vodafone.in","istockphoto.com","premierleague.com","oursogo.com","lycos.com","utopia-game.com","etsmtl.ca","lablue.de","mts.ru","soundcloud.com","clubforeplay.com","o2.pl","tvtorrents.com","basecamphq.com","umontreal.ca","wordpress.org","bahn.de","ganjawars.ru","webassign.net","caremark.com","canoe.ca","vatera.hu","mashreqtrade.com","fundsxpress.com","ml.com","1.16","mbank.pl","mpay.co.th","playneverwinter.com","westcall.spb.ru","camcontacts.com","xtube.com","skill7.com","familysearch.org","anidub.com","net.hr","auction.co.kr","elpais.com","bodybuilding.com","cathaypacific.com","ca.gov","centurylink.net","icicibank.co.in","livemaster.ru","banggood.com","midco.net","mocospace.com","bitly.com","dskdirect.bg","kw.com","chatango.com","etipos.sk","arcor.de","inps.it","charter.com","pru-ga.com.vn","tradera.com","one.lt","pop.in.th","adclickxpress.com","santander.cl","cue-monitor.jp","anadolu.edu.tr","aleks.com","vorteile.net","wisc.edu","ntu.edu.tw","steamcommunity.com","online.nl","westnet.com.au","seed.net.tw","bluebird.com","ebay.be","hockeysfuture.com","tipico.de","ust.hk","hilton.com","tf2017.com","hobbyking.com","jacquielawson.com","mindbodyonline.com","walmartmoneycard.com","skijumpmania.com","kuronekoyamato.co.jp","harvestapp.com","difesa.it","uqam.ca","healthcare.gov","einkabanki.is","techdata.com","postovabanka.sk","safemls.net","jawwal.ps","nexon.co.jp","squirt.org","bodycontact.com","nike.com","kroger.com","ford.com","inchallah.com","limundo.com","supershoot.eu","ppomppu.co.kr","worldwinner.com","hl.co.uk","target.com","fitbit.com","epicube.fr","jouve-si.fr","ricardo.ch","dudesnude.com","53.228:8080","farmerama.gr","callofgods.com","turnitin.com","kijiji.ca","authorize.net","zynga.com","12.com.ua","everyone.net","amateri.cz","advisorservices.com","exist.ru","monex.co.jp","r2games.com","agoda.com","safeway.com","iforex.com","citi.com","5giay.vn","happypancake.com","edline.net","gamyun.net","bwin.es","getresponse.com","travian.asia","starwoodhotels.com","talktalk.co.uk","tradevine.com","cra-arc.gc.ca","equideow.com","arise.com","vgs.gr","createspace.com","sgeb.bg","harvard.edu","ovh.net","digid.nl","gov.md","autodiagnostyk.com.pl","smbc-card.com","snai.it","ebay.es","cal-online.co.il","1and1.fr","aarinfantasy.com","cozi.com","tbconline.ge","castleagegame.com","verizon.net","ipggroup.eu","desire2learn.com","myuhc.com","asu.edu","mt.gov","delugerpg.com","chess.no","roadrunner.com","smartcloudserver.com","partis.si","mydlink.com","progetticustom.it","virgilio.it","xhamster.com","hostmonster.com","paragonrels.com","ncsecu.org","ecnavi.jp","newinsane.info","10.250:8888","islandluck.com","xvideos.com","bsnl.in","bet-at-home.com","tut.by","djelfa.info","uottawa.ca","uamulet.com","strato.de","dhs.gov","state.tx.us","utoronto.ca","darkorbit.com","eurogsm.ro","powerhosting.dk","lsu.edu","goo.ne.jp","europe-bet.com","jatheon.com","clickbank.com","primewire.ag","adf.ly","molten-wow.com","ucla.edu","timeweb.ru","men.gov.ma","rustorka.com","merrickbank.com","webmoney.ru","indamail.hu","iweb.com","banesconline.com","cybermail.jp","cscapitale.qc.ca","jdream.fr","standardchartered.com","gamer.com.tw","upjers.com","sports-inter.com","geico.com","hover.com","promotionmarkets.com","anz.co.nz","mcgraw-hill.com","travian.com.tr","imvu.com","powerschool.com","inbank.it","fccaccessonline.com","hdfcbank.com","devero.com","gmail.hu","backlog.jp","simple.com","sparda.de","dmm.co.jp","research-panel.jp","stoiximan.gr","10.1","silverpop.com","in.gov","pole-emploi.fr","vid.gov.lv","flydubai.com","lordofultima.com","bangkokbank.com","zamunda.net","carparts-cat.com","serverdata.net","gogecapital.com","vauner.pt","lostfilm.tv","gmx.fr","uscourts.gov","capitalonecardservice.com","cbssports.com","jeuxvideo.com","avast.com","bancsabadell.com","ssa.gov","gay.com","acanthus.be","erstebank.hu","sada-sso.appspot.com","wix.com","deezer.com","izicontact.com","mail.pt","omniture.com","uchicago.edu","fatcow.com","mos.ru","wellsfargodealerservices.com","vente-privee.com","uncommondescent.com","torrentrg.com","catalunyacaixa.com","bigtorrent.eu","interia.pl","dropcam.com","studyisland.com","cisco.com","shop-pro.jp","seao.ca","uploaded.net","mnscu.edu","sportal.bg","yorkbbs.ca","rikstoto.no","cocokarada.jp","mingle2.com","ameriprise.com","mail.bg","bpd.com.do","cex.io","supersport.hr","chomikuj.pl","coinbase.com","labcorp.com","dateinasia.com","progressive.com","ucoz.ru","skrill.com","humana.com","sccu.com","aukro.ua","monsterindia.com","mail2web.com","cityu.edu.hk","demandforced3.com","cvs.com","battle.net","hostgator.com","pex.jp","britishairways.com","gay-torrents.net","freebox.fr","warez-bb.org","tataprojects.com","named.com","standardchartered.com.hk","ft.com","bankwest.com.au","officegeteasy.com","netechangisme.com","workflowmax.com","rechargenestham.com","patelco.org","marmara.edu.tr","travian.com.br","tatasky.com","schoolsoft.se","fineco.it","comdirect.de","dell.com","lifelock.com","state.pa.us","ownpages.com","discover.com","uhauldealer.com","empornium.me","asbbank.co.nz","cgpeers.com","ravelry.com","autopartners.net","waveapps.com","foodcanmakeyouhappy.com","ccnm.edu","webtop.co.il","netlog.com","ifttt.com","wind.gr","telenor.no","loveplanet.ru","bankhapoalim.co.il","ziraatbank.com.tr","macquarie.com.au","upc.biz","atlas.sk","heartlandinfocentral.com","postini.com","panerabread.com","entropay.com","gaysir.no","rt.ru","myhermes.co.uk","pokemon-vortex.com","engarde-acd.com","zippyshare.com","wgu.edu","uitm.edu.my","sammobile.com","hafiz.gov.sa","vilayer.com","entergy.com","cgd.pt","nbo-global.com","citrixonline.com","vanguard.com","siberalem.com","clixsense.com","unisa.ac.za","pinnaclesports.com","tokobagus.com","wlu.edu","aui.ma","pipedrive.com","clamcase.com","amway.in","aeriagames.com","vmd.ca","rmit.edu.au","webcams.com","all-in-one-shop.com","fieldglass.net","1.254","top-page.ru","vmware.com","orange.ro","globalewallet.com","wcdchhattisgarh.co.in","hawaii.edu","115.com","copy.com","istekhatti.com","label-worx.com","williamhill.com","tsb.co.uk","taringa.net","elearning.jo","uksw.edu","plex.tv","rushcard.com","163.com","banglalionwimax.com","mycci.net","liveinternet.ru","adobeconnect.com","wpengine.com","igg.com","salliemae.com","arablounge.com","acclipse.com","forumotion.com","drtax.ca","ankhet.com","muhlenberg.edu","ekool.eu","karatbars.com","639evolution.com","devry.edu","save.tv","globaladshare.com","iptorrents.com","rabbittvgo.com","bakerhughes.com","upc.nl","cableone.net","tistory.com","mlc.com.au"];
