function BigInteger(t,e,r){null!=t&&("number"==typeof t?this.fromNumber(t,e,r):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function nbi(){return new BigInteger(null)}function am1(t,e,r,i,n,s){for(;--s>=0;){var o=e*this[t++]+r[i]+n;n=Math.floor(o/67108864),r[i++]=67108863&o}return n}function am2(t,e,r,i,n,s){for(var o=32767&e,a=e>>15;--s>=0;){var c=32767&this[t],h=this[t++]>>15,l=a*c+h*o;c=o*c+((32767&l)<<15)+r[i]+(1073741823&n),n=(c>>>30)+(l>>>15)+a*h+(n>>>30),r[i++]=1073741823&c}return n}function am3(t,e,r,i,n,s){for(var o=16383&e,a=e>>14;--s>=0;){var c=16383&this[t],h=this[t++]>>14,l=a*c+h*o;c=o*c+((16383&l)<<14)+r[i]+n,n=(c>>28)+(l>>14)+a*h,r[i++]=268435455&c}return n}function int2char(t){return BI_RM.charAt(t)}function intAt(t,e){var r=BI_RC[t.charCodeAt(e)];return null==r?-1:r}function bnpCopyTo(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s}function bnpFromInt(t){this.t=1,this.s=0>t?-1:0,t>0?this[0]=t:-1>t?this[0]=t+DV:this.t=0}function nbv(t){var e=nbi();return e.fromInt(t),e}function bnpFromString(t,e){var r;if(16==e)r=4;else if(8==e)r=3;else if(256==e)r=8;else if(2==e)r=1;else if(32==e)r=5;else{if(4!=e)return void this.fromRadix(t,e);r=2}this.t=0,this.s=0;for(var i=t.length,n=!1,s=0;--i>=0;){var o=8==r?255&t[i]:intAt(t,i);0>o?"-"==t.charAt(i)&&(n=!0):(n=!1,0==s?this[this.t++]=o:s+r>this.DB?(this[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this[this.t++]=o>>this.DB-s):this[this.t-1]|=o<<s,s+=r,s>=this.DB&&(s-=this.DB))}8==r&&0!=(128&t[0])&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),n&&BigInteger.ZERO.subTo(this,this)}function bnpClamp(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t}function bnToString(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var r,i=(1<<e)-1,n=!1,s="",o=this.t,a=this.DB-o*this.DB%e;if(o-->0)for(a<this.DB&&(r=this[o]>>a)>0&&(n=!0,s=int2char(r));o>=0;)e>a?(r=(this[o]&(1<<a)-1)<<e-a,r|=this[--o]>>(a+=this.DB-e)):(r=this[o]>>(a-=e)&i,0>=a&&(a+=this.DB,--o)),r>0&&(n=!0),n&&(s+=int2char(r));return n?s:"0"}function bnNegate(){var t=nbi();return BigInteger.ZERO.subTo(this,t),t}function bnAbs(){return this.s<0?this.negate():this}function bnCompareTo(t){var e=this.s-t.s;if(0!=e)return e;var r=this.t;if(e=r-t.t,0!=e)return e;for(;--r>=0;)if(0!=(e=this[r]-t[r]))return e;return 0}function nbits(t){var e,r=1;return 0!=(e=t>>>16)&&(t=e,r+=16),0!=(e=t>>8)&&(t=e,r+=8),0!=(e=t>>4)&&(t=e,r+=4),0!=(e=t>>2)&&(t=e,r+=2),0!=(e=t>>1)&&(t=e,r+=1),r}function bnBitLength(){return this.t<=0?0:this.DB*(this.t-1)+nbits(this[this.t-1]^this.s&this.DM)}function bnpDLShiftTo(t,e){var r;for(r=this.t-1;r>=0;--r)e[r+t]=this[r];for(r=t-1;r>=0;--r)e[r]=0;e.t=this.t+t,e.s=this.s}function bnpDRShiftTo(t,e){for(var r=t;r<this.t;++r)e[r-t]=this[r];e.t=Math.max(this.t-t,0),e.s=this.s}function bnpLShiftTo(t,e){var r,i=t%this.DB,n=this.DB-i,s=(1<<n)-1,o=Math.floor(t/this.DB),a=this.s<<i&this.DM;for(r=this.t-1;r>=0;--r)e[r+o+1]=this[r]>>n|a,a=(this[r]&s)<<i;for(r=o-1;r>=0;--r)e[r]=0;e[o]=a,e.t=this.t+o+1,e.s=this.s,e.clamp()}function bnpRShiftTo(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t)return void(e.t=0);var i=t%this.DB,n=this.DB-i,s=(1<<i)-1;e[0]=this[r]>>i;for(var o=r+1;o<this.t;++o)e[o-r-1]|=(this[o]&s)<<n,e[o-r]=this[o]>>i;i>0&&(e[this.t-r-1]|=(this.s&s)<<n),e.t=this.t-r,e.clamp()}function bnpSubTo(t,e){for(var r=0,i=0,n=Math.min(t.t,this.t);n>r;)i+=this[r]-t[r],e[r++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i-=t.s;r<this.t;)i+=this[r],e[r++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;r<t.t;)i-=t[r],e[r++]=i&this.DM,i>>=this.DB;i-=t.s}e.s=0>i?-1:0,-1>i?e[r++]=this.DV+i:i>0&&(e[r++]=i),e.t=r,e.clamp()}function bnpMultiplyTo(t,e){var r=this.abs(),i=t.abs(),n=r.t;for(e.t=n+i.t;--n>=0;)e[n]=0;for(n=0;n<i.t;++n)e[n+r.t]=r.am(0,i[n],e,n,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&BigInteger.ZERO.subTo(e,e)}function bnpSquareTo(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t[r]=0;for(r=0;r<e.t-1;++r){var i=e.am(r,e[r],t,2*r,0,1);(t[r+e.t]+=e.am(r+1,2*e[r],t,2*r+1,i,e.t-r-1))>=e.DV&&(t[r+e.t]-=e.DV,t[r+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(r,e[r],t,2*r,0,1)),t.s=0,t.clamp()}function bnpDivRemTo(t,e,r){var i=t.abs();if(!(i.t<=0)){var n=this.abs();if(n.t<i.t)return null!=e&&e.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=nbi());var s=nbi(),o=this.s,a=t.s,c=this.DB-nbits(i[i.t-1]);c>0?(i.lShiftTo(c,s),n.lShiftTo(c,r)):(i.copyTo(s),n.copyTo(r));var h=s.t,l=s[h-1];if(0!=l){var u=l*(1<<this.F1)+(h>1?s[h-2]>>this.F2:0),f=this.FV/u,p=(1<<this.F1)/u,d=1<<this.F2,g=r.t,m=g-h,b=null==e?nbi():e;for(s.dlShiftTo(m,b),r.compareTo(b)>=0&&(r[r.t++]=1,r.subTo(b,r)),BigInteger.ONE.dlShiftTo(h,b),b.subTo(s,s);s.t<h;)s[s.t++]=0;for(;--m>=0;){var v=r[--g]==l?this.DM:Math.floor(r[g]*f+(r[g-1]+d)*p);if((r[g]+=s.am(0,v,r,m,0,h))<v)for(s.dlShiftTo(m,b),r.subTo(b,r);r[g]<--v;)r.subTo(b,r)}null!=e&&(r.drShiftTo(h,e),o!=a&&BigInteger.ZERO.subTo(e,e)),r.t=h,r.clamp(),c>0&&r.rShiftTo(c,r),0>o&&BigInteger.ZERO.subTo(r,r)}}}function bnMod(t){var e=nbi();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(BigInteger.ZERO)>0&&t.subTo(e,e),e}function Classic(t){this.m=t}function cConvert(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function cRevert(t){return t}function cReduce(t){t.divRemTo(this.m,null,t)}function cMulTo(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function cSqrTo(t,e){t.squareTo(e),this.reduce(e)}function bnpInvDigit(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return e=e*(2-(15&t)*e)&15,e=e*(2-(255&t)*e)&255,e=e*(2-((65535&t)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function Montgomery(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function montConvert(t){var e=nbi();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(BigInteger.ZERO)>0&&this.m.subTo(e,e),e}function montRevert(t){var e=nbi();return t.copyTo(e),this.reduce(e),e}function montReduce(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=32767&t[e],i=r*this.mpl+((r*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t[r]+=this.m.am(0,i,t,e,0,this.m.t);t[r]>=t.DV;)t[r]-=t.DV,t[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function montSqrTo(t,e){t.squareTo(e),this.reduce(e)}function montMulTo(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function bnpIsEven(){return 0==(this.t>0?1&this[0]:this.s)}function bnpExp(t,e){if(t>4294967295||1>t)return BigInteger.ONE;var r=nbi(),i=nbi(),n=e.convert(this),s=nbits(t)-1;for(n.copyTo(r);--s>=0;)if(e.sqrTo(r,i),(t&1<<s)>0)e.mulTo(i,n,r);else{var o=r;r=i,i=o}return e.revert(r)}function bnModPowInt(t,e){var r;return r=256>t||e.isEven()?new Classic(e):new Montgomery(e),this.exp(t,r)}function bnClone(){var t=nbi();return this.copyTo(t),t}function bnIntValue(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function bnByteValue(){return 0==this.t?this.s:this[0]<<24>>24}function bnShortValue(){return 0==this.t?this.s:this[0]<<16>>16}function bnpChunkSize(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function bnSigNum(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function bnpToRadix(t){if(null==t&&(t=10),0==this.signum()||2>t||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),i=nbv(r),n=nbi(),s=nbi(),o="";for(this.divRemTo(i,n,s);n.signum()>0;)o=(r+s.intValue()).toString(t).substr(1)+o,n.divRemTo(i,n,s);return s.intValue().toString(t)+o}function bnpFromRadix(t,e){this.fromInt(0),null==e&&(e=10);for(var r=this.chunkSize(e),i=Math.pow(e,r),n=!1,s=0,o=0,a=0;a<t.length;++a){var c=intAt(t,a);0>c?"-"==t.charAt(a)&&0==this.signum()&&(n=!0):(o=e*o+c,++s>=r&&(this.dMultiply(i),this.dAddOffset(o,0),s=0,o=0))}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(o,0)),n&&BigInteger.ZERO.subTo(this,this)}function bnpFromNumber(t,e,r){if("number"==typeof e)if(2>t)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(BigInteger.ONE.shiftLeft(t-1),op_or,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(BigInteger.ONE.shiftLeft(t-1),this);else{var i=new Array,n=7&t;i.length=(t>>3)+1,e.nextBytes(i),n>0?i[0]&=(1<<n)-1:i[0]=0,this.fromString(i,256)}}function bnToByteArray(){var t=this.t,e=new Array;e[0]=this.s;var r,i=this.DB-t*this.DB%8,n=0;if(t-->0)for(i<this.DB&&(r=this[t]>>i)!=(this.s&this.DM)>>i&&(e[n++]=r|this.s<<this.DB-i);t>=0;)8>i?(r=(this[t]&(1<<i)-1)<<8-i,r|=this[--t]>>(i+=this.DB-8)):(r=this[t]>>(i-=8)&255,0>=i&&(i+=this.DB,--t)),0!=(128&r)&&(r|=-256),0==n&&(128&this.s)!=(128&r)&&++n,(n>0||r!=this.s)&&(e[n++]=r);return e}function bnEquals(t){return 0==this.compareTo(t)}function bnMin(t){return this.compareTo(t)<0?this:t}function bnMax(t){return this.compareTo(t)>0?this:t}function bnpBitwiseTo(t,e,r){var i,n,s=Math.min(t.t,this.t);for(i=0;s>i;++i)r[i]=e(this[i],t[i]);if(t.t<this.t){for(n=t.s&this.DM,i=s;i<this.t;++i)r[i]=e(this[i],n);r.t=this.t}else{for(n=this.s&this.DM,i=s;i<t.t;++i)r[i]=e(n,t[i]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function op_and(t,e){return t&e}function bnAnd(t){var e=nbi();return this.bitwiseTo(t,op_and,e),e}function op_or(t,e){return t|e}function bnOr(t){var e=nbi();return this.bitwiseTo(t,op_or,e),e}function op_xor(t,e){return t^e}function bnXor(t){var e=nbi();return this.bitwiseTo(t,op_xor,e),e}function op_andnot(t,e){return t&~e}function bnAndNot(t){var e=nbi();return this.bitwiseTo(t,op_andnot,e),e}function bnNot(){for(var t=nbi(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t}function bnShiftLeft(t){var e=nbi();return 0>t?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function bnShiftRight(t){var e=nbi();return 0>t?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function lbit(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function bnGetLowestSetBit(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+lbit(this[t]);return this.s<0?this.t*this.DB:-1}function cbit(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function bnBitCount(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=cbit(this[r]^e);return t}function bnTestBit(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)}function bnpChangeBit(t,e){var r=BigInteger.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function bnSetBit(t){return this.changeBit(t,op_or)}function bnClearBit(t){return this.changeBit(t,op_andnot)}function bnFlipBit(t){return this.changeBit(t,op_xor)}function bnpAddTo(t,e){for(var r=0,i=0,n=Math.min(t.t,this.t);n>r;)i+=this[r]+t[r],e[r++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i+=t.s;r<this.t;)i+=this[r],e[r++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;r<t.t;)i+=t[r],e[r++]=i&this.DM,i>>=this.DB;i+=t.s}e.s=0>i?-1:0,i>0?e[r++]=i:-1>i&&(e[r++]=this.DV+i),e.t=r,e.clamp()}function bnAdd(t){var e=nbi();return this.addTo(t,e),e}function bnSubtract(t){var e=nbi();return this.subTo(t,e),e}function bnMultiply(t){var e=nbi();return this.multiplyTo(t,e),e}function bnSquare(){var t=nbi();return this.squareTo(t),t}function bnDivide(t){var e=nbi();return this.divRemTo(t,e,null),e}function bnRemainder(t){var e=nbi();return this.divRemTo(t,null,e),e}function bnDivideAndRemainder(t){var e=nbi(),r=nbi();return this.divRemTo(t,e,r),new Array(e,r)}function bnpDMultiply(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function bnpDAddOffset(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}}function NullExp(){}function nNop(t){return t}function nMulTo(t,e,r){t.multiplyTo(e,r)}function nSqrTo(t,e){t.squareTo(e)}function bnPow(t){return this.exp(t,new NullExp)}function bnpMultiplyLowerTo(t,e,r){var i=Math.min(this.t+t.t,e);for(r.s=0,r.t=i;i>0;)r[--i]=0;var n;for(n=r.t-this.t;n>i;++i)r[i+this.t]=this.am(0,t[i],r,i,0,this.t);for(n=Math.min(t.t,e);n>i;++i)this.am(0,t[i],r,i,0,e-i);r.clamp()}function bnpMultiplyUpperTo(t,e,r){--e;var i=r.t=this.t+t.t-e;for(r.s=0;--i>=0;)r[i]=0;for(i=Math.max(e-this.t,0);i<t.t;++i)r[this.t+i-e]=this.am(e-i,t[i],r,0,0,this.t+i-e);r.clamp(),r.drShiftTo(1,r)}function Barrett(t){this.r2=nbi(),this.q3=nbi(),BigInteger.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function barrettConvert(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=nbi();return t.copyTo(e),this.reduce(e),e}function barrettRevert(t){return t}function barrettReduce(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function barrettSqrTo(t,e){t.squareTo(e),this.reduce(e)}function barrettMulTo(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function bnModPow(t,e){var r,i,n=t.bitLength(),s=nbv(1);if(0>=n)return s;r=18>n?1:48>n?3:144>n?4:768>n?5:6,i=8>n?new Classic(e):e.isEven()?new Barrett(e):new Montgomery(e);var o=new Array,a=3,c=r-1,h=(1<<r)-1;if(o[1]=i.convert(this),r>1){var l=nbi();for(i.sqrTo(o[1],l);h>=a;)o[a]=nbi(),i.mulTo(l,o[a-2],o[a]),a+=2}var u,f,p=t.t-1,d=!0,g=nbi();for(n=nbits(t[p])-1;p>=0;){for(n>=c?u=t[p]>>n-c&h:(u=(t[p]&(1<<n+1)-1)<<c-n,p>0&&(u|=t[p-1]>>this.DB+n-c)),a=r;0==(1&u);)u>>=1,--a;if((n-=a)<0&&(n+=this.DB,--p),d)o[u].copyTo(s),d=!1;else{for(;a>1;)i.sqrTo(s,g),i.sqrTo(g,s),a-=2;a>0?i.sqrTo(s,g):(f=s,s=g,g=f),i.mulTo(g,o[u],s)}for(;p>=0&&0==(t[p]&1<<n);)i.sqrTo(s,g),f=s,s=g,g=f,--n<0&&(n=this.DB-1,--p)}return i.revert(s)}function bnGCD(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var i=e;e=r,r=i}var n=e.getLowestSetBit(),s=r.getLowestSetBit();if(0>s)return e;for(s>n&&(s=n),s>0&&(e.rShiftTo(s,e),r.rShiftTo(s,r));e.signum()>0;)(n=e.getLowestSetBit())>0&&e.rShiftTo(n,e),(n=r.getLowestSetBit())>0&&r.rShiftTo(n,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function bnpModInt(t){if(0>=t)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(0==e)r=this[0]%t;else for(var i=this.t-1;i>=0;--i)r=(e*r+this[i])%t;return r}function bnModInverse(t){var e=t.isEven();if(this.isEven()&&e||0==t.signum())return BigInteger.ZERO;for(var r=t.clone(),i=this.clone(),n=nbv(1),s=nbv(0),o=nbv(0),a=nbv(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),e?(n.isEven()&&s.isEven()||(n.addTo(this,n),s.subTo(t,s)),n.rShiftTo(1,n)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;i.isEven();)i.rShiftTo(1,i),e?(o.isEven()&&a.isEven()||(o.addTo(this,o),a.subTo(t,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);r.compareTo(i)>=0?(r.subTo(i,r),e&&n.subTo(o,n),s.subTo(a,s)):(i.subTo(r,i),e&&o.subTo(n,o),a.subTo(s,a))}return 0!=i.compareTo(BigInteger.ONE)?BigInteger.ZERO:a.compareTo(t)>=0?a.subtract(t):a.signum()<0?(a.addTo(t,a),a.signum()<0?a.add(t):a):a}function bnIsProbablePrime(t){var e,r=this.abs();if(1==r.t&&r[0]<=lowprimes[lowprimes.length-1]){for(e=0;e<lowprimes.length;++e)if(r[0]==lowprimes[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<lowprimes.length;){for(var i=lowprimes[e],n=e+1;n<lowprimes.length&&lplim>i;)i*=lowprimes[n++];for(i=r.modInt(i);n>e;)if(i%lowprimes[e++]==0)return!1}return r.millerRabin(t)}function bnpMillerRabin(t){var e=this.subtract(BigInteger.ONE),r=e.getLowestSetBit();if(0>=r)return!1;var i=e.shiftRight(r);t=t+1>>1,t>lowprimes.length&&(t=lowprimes.length);for(var n=nbi(),s=0;t>s;++s){n.fromInt(lowprimes[Math.floor(Math.random()*lowprimes.length)]);var o=n.modPow(i,this);if(0!=o.compareTo(BigInteger.ONE)&&0!=o.compareTo(e)){for(var a=1;a++<r&&0!=o.compareTo(e);)if(o=o.modPowInt(2,this),0==o.compareTo(BigInteger.ONE))return!1;if(0!=o.compareTo(e))return!1}}return!0}function Arcfour(){this.i=0,this.j=0,this.S=new Array}function ARC4init(t){var e,r,i;for(e=0;256>e;++e)this.S[e]=e;for(r=0,e=0;256>e;++e)r=r+this.S[e]+t[e%t.length]&255,i=this.S[e],this.S[e]=this.S[r],this.S[r]=i;this.i=0,this.j=0}function ARC4next(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]}function prng_newstate(){return new Arcfour}function rng_seed_int(t){rng_pool[rng_pptr++]^=255&t,rng_pool[rng_pptr++]^=t>>8&255,rng_pool[rng_pptr++]^=t>>16&255,rng_pool[rng_pptr++]^=t>>24&255,rng_pptr>=rng_psize&&(rng_pptr-=rng_psize)}function rng_seed_time(){rng_seed_int((new Date).getTime())}function rng_get_byte(){if(null==rng_state){for(rng_seed_time(),rng_state=prng_newstate(),rng_state.init(rng_pool),rng_pptr=0;rng_pptr<rng_pool.length;++rng_pptr)rng_pool[rng_pptr]=0;rng_pptr=0}return rng_state.next()}function rng_get_bytes(t){var e;for(e=0;e<t.length;++e)t[e]=rng_get_byte()}function SecureRandom(){}function parseBigInt(t,e){return new BigInteger(t,e)}function linebrk(t,e){for(var r="",i=0;i+e<t.length;)r+=t.substring(i,i+e)+"\n",i+=e;return r+t.substring(i,t.length)}function byte2Hex(t){return 16>t?"0"+t.toString(16):t.toString(16)}function pkcs1pad2(t,e){if(e<t.length+11)return alert("Message too long for RSA"),null;for(var r=new Array,i=t.length-1;i>=0&&e>0;){var n=t.charCodeAt(i--);128>n?r[--e]=n:n>127&&2048>n?(r[--e]=63&n|128,r[--e]=n>>6|192):(r[--e]=63&n|128,r[--e]=n>>6&63|128,r[--e]=n>>12|224)}r[--e]=0;for(var s=new SecureRandom,o=new Array;e>2;){for(o[0]=0;0==o[0];)s.nextBytes(o);r[--e]=o[0]}return r[--e]=2,r[--e]=0,new BigInteger(r)}function RSAKey(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function RSASetPublic(t,e){null!=t&&null!=e&&t.length>0&&e.length>0?(this.n=parseBigInt(t,16),this.e=parseInt(e,16)):alert("Invalid RSA public key")}function RSADoPublic(t){return t.modPowInt(this.e,this.n)}function RSAEncrypt(t){var e=pkcs1pad2(t,this.n.bitLength()+7>>3);if(null==e)return null;var r=this.doPublic(e);if(null==r)return null;var i=r.toString(16);return 0==(1&i.length)?i:"0"+i}function pkcs1unpad2(t,e){for(var r=t.toByteArray(),i=0;i<r.length&&0==r[i];)++i;if(r.length-i!=e-1||2!=r[i])return null;for(++i;0!=r[i];)if(++i>=r.length)return null;for(var n="";++i<r.length;){var s=255&r[i];128>s?n+=String.fromCharCode(s):s>191&&224>s?(n+=String.fromCharCode((31&s)<<6|63&r[i+1]),++i):(n+=String.fromCharCode((15&s)<<12|(63&r[i+1])<<6|63&r[i+2]),i+=2)}return n}function RSASetPrivate(t,e,r){null!=t&&null!=e&&t.length>0&&e.length>0?(this.n=parseBigInt(t,16),this.e=parseInt(e,16),this.d=parseBigInt(r,16)):alert("Invalid RSA private key")}function RSASetPrivateEx(t,e,r,i,n,s,o,a){null!=t&&null!=e&&t.length>0&&e.length>0?(this.n=parseBigInt(t,16),this.e=parseInt(e,16),this.d=parseBigInt(r,16),this.p=parseBigInt(i,16),this.q=parseBigInt(n,16),this.dmp1=parseBigInt(s,16),this.dmq1=parseBigInt(o,16),this.coeff=parseBigInt(a,16)):alert("Invalid RSA private key")}function RSAGenerate(t,e){var r=new SecureRandom,i=t>>1;this.e=parseInt(e,16);for(var n=new BigInteger(e,16);;){for(;this.p=new BigInteger(t-i,1,r),0!=this.p.subtract(BigInteger.ONE).gcd(n).compareTo(BigInteger.ONE)||!this.p.isProbablePrime(10););for(;this.q=new BigInteger(i,1,r),0!=this.q.subtract(BigInteger.ONE).gcd(n).compareTo(BigInteger.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var s=this.p;this.p=this.q,this.q=s}var o=this.p.subtract(BigInteger.ONE),a=this.q.subtract(BigInteger.ONE),c=o.multiply(a);if(0==c.gcd(n).compareTo(BigInteger.ONE)){this.n=this.p.multiply(this.q),this.d=n.modInverse(c),this.dmp1=this.d.mod(o),this.dmq1=this.d.mod(a),this.coeff=this.q.modInverse(this.p);break}}}function RSADoPrivate(t){if(null==this.p||null==this.q)return t.modPow(this.d,this.n);for(var e=t.mod(this.p).modPow(this.dmp1,this.p),r=t.mod(this.q).modPow(this.dmq1,this.q);e.compareTo(r)<0;)e=e.add(this.p);return e.subtract(r).multiply(this.coeff).mod(this.p).multiply(this.q).add(r)}function RSADecrypt(t){var e=parseBigInt(t,16),r=this.doPrivate(e);return null==r?null:pkcs1unpad2(r,this.n.bitLength()+7>>3)}function alert(t){throw{message:t}}var Aes={};Aes.cipher=function(t,e){for(var r=4,i=e.length/r-1,n=[[],[],[],[]],s=0;4*r>s;s++)n[s%4][Math.floor(s/4)]=t[s];n=Aes.addRoundKey(n,e,0,r);for(var o=1;i>o;o++)n=Aes.subBytes(n,r),n=Aes.shiftRows(n,r),n=Aes.mixColumns(n,r),n=Aes.addRoundKey(n,e,o,r);n=Aes.subBytes(n,r),n=Aes.shiftRows(n,r),n=Aes.addRoundKey(n,e,i,r);for(var a=new Array(4*r),s=0;4*r>s;s++)a[s]=n[s%4][Math.floor(s/4)];return a},Aes.keyExpansion=function(t){for(var e=4,r=t.length/4,i=r+6,n=new Array(e*(i+1)),s=new Array(4),o=0;r>o;o++){var a=[t[4*o],t[4*o+1],t[4*o+2],t[4*o+3]];n[o]=a}for(var o=r;e*(i+1)>o;o++){n[o]=new Array(4);for(var c=0;4>c;c++)s[c]=n[o-1][c];if(o%r==0){s=Aes.subWord(Aes.rotWord(s));for(var c=0;4>c;c++)s[c]^=Aes.rCon[o/r][c]}else r>6&&o%r==4&&(s=Aes.subWord(s));for(var c=0;4>c;c++)n[o][c]=n[o-r][c]^s[c]}return n},Aes.subBytes=function(t,e){for(var r=0;4>r;r++)for(var i=0;e>i;i++)t[r][i]=Aes.sBox[t[r][i]];return t},Aes.shiftRows=function(t,e){for(var r=new Array(4),i=1;4>i;i++){for(var n=0;4>n;n++)r[n]=t[i][(n+i)%e];for(var n=0;4>n;n++)t[i][n]=r[n]}return t},Aes.mixColumns=function(t,e){for(var r=0;4>r;r++){for(var i=new Array(4),n=new Array(4),s=0;4>s;s++)i[s]=t[s][r],n[s]=128&t[s][r]?t[s][r]<<1^283:t[s][r]<<1;t[0][r]=n[0]^i[1]^n[1]^i[2]^i[3],t[1][r]=i[0]^n[1]^i[2]^n[2]^i[3],t[2][r]=i[0]^i[1]^n[2]^i[3]^n[3],t[3][r]=i[0]^n[0]^i[1]^i[2]^n[3]}return t},Aes.addRoundKey=function(t,e,r,i){for(var n=0;4>n;n++)for(var s=0;i>s;s++)t[n][s]^=e[4*r+s][n];return t},Aes.subWord=function(t){for(var e=0;4>e;e++)t[e]=Aes.sBox[t[e]];return t},Aes.rotWord=function(t){for(var e=t[0],r=0;3>r;r++)t[r]=t[r+1];return t[3]=e,t},Aes.sBox=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],Aes.rCon=[[0,0,0,0],[1,0,0,0],[2,0,0,0],[4,0,0,0],[8,0,0,0],[16,0,0,0],[32,0,0,0],[64,0,0,0],[128,0,0,0],[27,0,0,0],[54,0,0,0]],Aes.Ctr={},Aes.Ctr.encrypt=function(t,e,r){var i=16;if(128!=r&&192!=r&&256!=r)return"";t=Utf8.encode(t),e=Utf8.encode(e);for(var n=r/8,s=new Array(n),o=0;n>o;o++)s[o]=isNaN(e.charCodeAt(o))?0:e.charCodeAt(o);var a=Aes.cipher(s,Aes.keyExpansion(s));a=a.concat(a.slice(0,n-16));for(var c=new Array(i),h=(new Date).getTime(),l=h%1e3,u=Math.floor(h/1e3),f=Math.floor(65535*Math.random()),o=0;2>o;o++)c[o]=l>>>8*o&255;for(var o=0;2>o;o++)c[o+2]=f>>>8*o&255;for(var o=0;4>o;o++)c[o+4]=u>>>8*o&255;for(var p="",o=0;8>o;o++)p+=String.fromCharCode(c[o]);for(var d=Aes.keyExpansion(a),g=Math.ceil(t.length/i),m=new Array(g),b=0;g>b;b++){for(var v=0;4>v;v++)c[15-v]=b>>>8*v&255;for(var v=0;4>v;v++)c[15-v-4]=b/4294967296>>>8*v;for(var y=Aes.cipher(c,d),_=g-1>b?i:(t.length-1)%i+1,B=new Array(_),o=0;_>o;o++)B[o]=y[o]^t.charCodeAt(b*i+o),B[o]=String.fromCharCode(B[o]);m[b]=B.join("")}var w=p+m.join("");return w=Base64.encode(w)},Aes.Ctr.decrypt=function(t,e,r){var i=16;if(128!=r&&192!=r&&256!=r)return"";t=Base64.decode(t),e=Utf8.encode(e);for(var n=r/8,s=new Array(n),o=0;n>o;o++)s[o]=isNaN(e.charCodeAt(o))?0:e.charCodeAt(o);var a=Aes.cipher(s,Aes.keyExpansion(s));a=a.concat(a.slice(0,n-16));var c=new Array(8);ctrTxt=t.slice(0,8);for(var o=0;8>o;o++)c[o]=ctrTxt.charCodeAt(o);for(var h=Aes.keyExpansion(a),l=Math.ceil((t.length-8)/i),u=new Array(l),f=0;l>f;f++)u[f]=t.slice(8+f*i,8+f*i+i);t=u;for(var p=new Array(t.length),f=0;l>f;f++){for(var d=0;4>d;d++)c[15-d]=f>>>8*d&255;for(var d=0;4>d;d++)c[15-d-4]=(f+1)/4294967296-1>>>8*d&255;for(var g=Aes.cipher(c,h),m=new Array(t[f].length),o=0;o<t[f].length;o++)m[o]=g[o]^t[f].charCodeAt(o),m[o]=String.fromCharCode(m[o]);p[f]=m.join("")}var b=p.join("");return b=Utf8.decode(b)};var Base64={};Base64.code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Base64.encode=function(t,e){e="undefined"==typeof e?!1:e;var r,i,n,s,o,a,c,h,l,u,f,p=[],d="",g=Base64.code;if(u=e?t.encodeUTF8():t,l=u.length%3,l>0)for(;l++<3;)d+="=",u+="\x00";for(l=0;l<u.length;l+=3)r=u.charCodeAt(l),i=u.charCodeAt(l+1),n=u.charCodeAt(l+2),s=r<<16|i<<8|n,o=s>>18&63,a=s>>12&63,c=s>>6&63,h=63&s,p[l/3]=g.charAt(o)+g.charAt(a)+g.charAt(c)+g.charAt(h);return f=p.join(""),f=f.slice(0,f.length-d.length)+d},Base64.decode=function(t,e){e="undefined"==typeof e?!1:e;var r,i,n,s,o,a,c,h,l,u,f=[],p=Base64.code;u=e?t.decodeUTF8():t;for(var d=0;d<u.length;d+=4)s=p.indexOf(u.charAt(d)),o=p.indexOf(u.charAt(d+1)),a=p.indexOf(u.charAt(d+2)),c=p.indexOf(u.charAt(d+3)),h=s<<18|o<<12|a<<6|c,r=h>>>16&255,i=h>>>8&255,n=255&h,f[d/4]=String.fromCharCode(r,i,n),64==c&&(f[d/4]=String.fromCharCode(r,i)),64==a&&(f[d/4]=String.fromCharCode(r));return l=f.join(""),e?l.decodeUTF8():l};var Utf8={};Utf8.encode=function(t){var e=t.replace(/[\u0080-\u07ff]/g,function(t){var e=t.charCodeAt(0);return String.fromCharCode(192|e>>6,128|63&e)});return e=e.replace(/[\u0800-\uffff]/g,function(t){var e=t.charCodeAt(0);return String.fromCharCode(224|e>>12,128|e>>6&63,128|63&e)})},Utf8.decode=function(t){var e=t.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(t){var e=(15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2);return String.fromCharCode(e)});return e=e.replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(t){var e=(31&t.charCodeAt(0))<<6|63&t.charCodeAt(1);return String.fromCharCode(e)})};var dbits,canary=0xdeadbeefcafe,j_lm=15715070==(16777215&canary);"undefined"!=typeof PB&&PB.config&&"desktop-extension-firefox"==PB.config.target&&(navigator={appName:"Firefox"}),j_lm&&"Microsoft Internet Explorer"==navigator.appName?(BigInteger.prototype.am=am2,dbits=30):j_lm&&"Netscape"!=navigator.appName?(BigInteger.prototype.am=am1,dbits=26):(BigInteger.prototype.am=am3,dbits=28),BigInteger.prototype.DB=dbits,BigInteger.prototype.DM=(1<<dbits)-1,BigInteger.prototype.DV=1<<dbits;var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP),BigInteger.prototype.F1=BI_FP-dbits,BigInteger.prototype.F2=2*dbits-BI_FP;var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz",BI_RC=new Array,rr,vv;for(rr="0".charCodeAt(0),vv=0;9>=vv;++vv)BI_RC[rr++]=vv;for(rr="a".charCodeAt(0),vv=10;36>vv;++vv)BI_RC[rr++]=vv;for(rr="A".charCodeAt(0),vv=10;36>vv;++vv)BI_RC[rr++]=vv;Classic.prototype.convert=cConvert,Classic.prototype.revert=cRevert,Classic.prototype.reduce=cReduce,Classic.prototype.mulTo=cMulTo,Classic.prototype.sqrTo=cSqrTo,Montgomery.prototype.convert=montConvert,Montgomery.prototype.revert=montRevert,Montgomery.prototype.reduce=montReduce,Montgomery.prototype.mulTo=montMulTo,Montgomery.prototype.sqrTo=montSqrTo,BigInteger.prototype.copyTo=bnpCopyTo,BigInteger.prototype.fromInt=bnpFromInt,BigInteger.prototype.fromString=bnpFromString,BigInteger.prototype.clamp=bnpClamp,BigInteger.prototype.dlShiftTo=bnpDLShiftTo,BigInteger.prototype.drShiftTo=bnpDRShiftTo,BigInteger.prototype.lShiftTo=bnpLShiftTo,BigInteger.prototype.rShiftTo=bnpRShiftTo,BigInteger.prototype.subTo=bnpSubTo,BigInteger.prototype.multiplyTo=bnpMultiplyTo,BigInteger.prototype.squareTo=bnpSquareTo,BigInteger.prototype.divRemTo=bnpDivRemTo,BigInteger.prototype.invDigit=bnpInvDigit,BigInteger.prototype.isEven=bnpIsEven,BigInteger.prototype.exp=bnpExp,BigInteger.prototype.toString=bnToString,BigInteger.prototype.negate=bnNegate,BigInteger.prototype.abs=bnAbs,BigInteger.prototype.compareTo=bnCompareTo,BigInteger.prototype.bitLength=bnBitLength,BigInteger.prototype.mod=bnMod,BigInteger.prototype.modPowInt=bnModPowInt,BigInteger.ZERO=nbv(0),BigInteger.ONE=nbv(1),NullExp.prototype.convert=nNop,NullExp.prototype.revert=nNop,NullExp.prototype.mulTo=nMulTo,NullExp.prototype.sqrTo=nSqrTo,Barrett.prototype.convert=barrettConvert,Barrett.prototype.revert=barrettRevert,Barrett.prototype.reduce=barrettReduce,Barrett.prototype.mulTo=barrettMulTo,Barrett.prototype.sqrTo=barrettSqrTo;var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],lplim=(1<<26)/lowprimes[lowprimes.length-1];BigInteger.prototype.chunkSize=bnpChunkSize,BigInteger.prototype.toRadix=bnpToRadix,BigInteger.prototype.fromRadix=bnpFromRadix,BigInteger.prototype.fromNumber=bnpFromNumber,BigInteger.prototype.bitwiseTo=bnpBitwiseTo,BigInteger.prototype.changeBit=bnpChangeBit,BigInteger.prototype.addTo=bnpAddTo,BigInteger.prototype.dMultiply=bnpDMultiply,BigInteger.prototype.dAddOffset=bnpDAddOffset,BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo,BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo,BigInteger.prototype.modInt=bnpModInt,BigInteger.prototype.millerRabin=bnpMillerRabin,BigInteger.prototype.clone=bnClone,BigInteger.prototype.intValue=bnIntValue,BigInteger.prototype.byteValue=bnByteValue,BigInteger.prototype.shortValue=bnShortValue,BigInteger.prototype.signum=bnSigNum,BigInteger.prototype.toByteArray=bnToByteArray,BigInteger.prototype.equals=bnEquals,BigInteger.prototype.min=bnMin,BigInteger.prototype.max=bnMax,BigInteger.prototype.and=bnAnd,BigInteger.prototype.or=bnOr,BigInteger.prototype.xor=bnXor,BigInteger.prototype.andNot=bnAndNot,BigInteger.prototype.not=bnNot,BigInteger.prototype.shiftLeft=bnShiftLeft,BigInteger.prototype.shiftRight=bnShiftRight,BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit,BigInteger.prototype.bitCount=bnBitCount,BigInteger.prototype.testBit=bnTestBit,BigInteger.prototype.setBit=bnSetBit,BigInteger.prototype.clearBit=bnClearBit,BigInteger.prototype.flipBit=bnFlipBit,BigInteger.prototype.add=bnAdd,BigInteger.prototype.subtract=bnSubtract,BigInteger.prototype.multiply=bnMultiply,BigInteger.prototype.divide=bnDivide,BigInteger.prototype.remainder=bnRemainder,BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder,BigInteger.prototype.modPow=bnModPow,BigInteger.prototype.modInverse=bnModInverse,BigInteger.prototype.pow=bnPow,BigInteger.prototype.gcd=bnGCD,BigInteger.prototype.isProbablePrime=bnIsProbablePrime,BigInteger.prototype.square=bnSquare;var CryptoJS=CryptoJS||function(t,e){var r={},i=r.lib={},n=i.Base=function(){function t(){}return{extend:function(e){t.prototype=this;var r=new t;return e&&r.mixIn(e),r.$super=this,r},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.$super.extend(this)}}}(),s=i.WordArray=n.extend({init:function(t,r){t=this.words=t||[],
this.sigBytes=r!=e?r:4*t.length},toString:function(t){return(t||a).stringify(this)},concat:function(t){var e=this.words,r=t.words,i=this.sigBytes,t=t.sigBytes;if(this.clamp(),i%4)for(var n=0;t>n;n++)e[i+n>>>2]|=(r[n>>>2]>>>24-8*(n%4)&255)<<24-8*((i+n)%4);else if(65535<r.length)for(n=0;t>n;n+=4)e[i+n>>>2]=r[n>>>2];else e.push.apply(e,r);return this.sigBytes+=t,this},clamp:function(){var e=this.words,r=this.sigBytes;e[r>>>2]&=4294967295<<32-8*(r%4),e.length=t.ceil(r/4)},clone:function(){var t=n.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var r=[],i=0;e>i;i+=4)r.push(4294967296*t.random()|0);return s.create(r,e)}}),o=r.enc={},a=o.Hex={stringify:function(t){for(var e=t.words,t=t.sigBytes,r=[],i=0;t>i;i++){var n=e[i>>>2]>>>24-8*(i%4)&255;r.push((n>>>4).toString(16)),r.push((15&n).toString(16))}return r.join("")},parse:function(t){for(var e=t.length,r=[],i=0;e>i;i+=2)r[i>>>3]|=parseInt(t.substr(i,2),16)<<24-4*(i%8);return s.create(r,e/2)}},c=o.Latin1={stringify:function(t){for(var e=t.words,t=t.sigBytes,r=[],i=0;t>i;i++)r.push(String.fromCharCode(e[i>>>2]>>>24-8*(i%4)&255));return r.join("")},parse:function(t){for(var e=t.length,r=[],i=0;e>i;i++)r[i>>>2]|=(255&t.charCodeAt(i))<<24-8*(i%4);return s.create(r,e)}},h=o.Utf8={stringify:function(t){try{return decodeURIComponent(escape(c.stringify(t)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(t){return c.parse(unescape(encodeURIComponent(t)))}},l=i.BufferedBlockAlgorithm=n.extend({reset:function(){this._data=s.create(),this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=h.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var r=this._data,i=r.words,n=r.sigBytes,o=this.blockSize,a=n/(4*o),a=e?t.ceil(a):t.max((0|a)-this._minBufferSize,0),e=a*o,n=t.min(4*e,n);if(e){for(var c=0;e>c;c+=o)this._doProcessBlock(i,c);c=i.splice(0,e),r.sigBytes-=n}return s.create(c,n)},clone:function(){var t=n.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});i.Hasher=l.extend({init:function(){this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize(),this._hash},clone:function(){var t=l.clone.call(this);return t._hash=this._hash.clone(),t},blockSize:16,_createHelper:function(t){return function(e,r){return t.create(r).finalize(e)}},_createHmacHelper:function(t){return function(e,r){return u.HMAC.create(t,r).finalize(e)}}});var u=r.algo={};return r}(Math);!function(){var t=CryptoJS,e=t.lib,r=e.WordArray,e=e.Hasher,i=[],n=t.algo.SHA1=e.extend({_doReset:function(){this._hash=r.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var r=this._hash.words,n=r[0],s=r[1],o=r[2],a=r[3],c=r[4],h=0;80>h;h++){if(16>h)i[h]=0|t[e+h];else{var l=i[h-3]^i[h-8]^i[h-14]^i[h-16];i[h]=l<<1|l>>>31}l=(n<<5|n>>>27)+c+i[h],l=20>h?l+((s&o|~s&a)+1518500249):40>h?l+((s^o^a)+1859775393):60>h?l+((s&o|s&a|o&a)-1894007588):l+((s^o^a)-899497514),c=a,a=o,o=s<<30|s>>>2,s=n,n=l}r[0]=r[0]+n|0,r[1]=r[1]+s|0,r[2]=r[2]+o|0,r[3]=r[3]+a|0,r[4]=r[4]+c|0},_doFinalize:function(){var t=this._data,e=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;e[i>>>5]|=128<<24-i%32,e[(i+64>>>9<<4)+15]=r,t.sigBytes=4*e.length,this._process()}});t.SHA1=e._createHelper(n),t.HmacSHA1=e._createHmacHelper(n)}(),function(){var t=CryptoJS,e=t.enc.Utf8;t.algo.HMAC=t.lib.Base.extend({init:function(t,r){t=this._hasher=t.create(),"string"==typeof r&&(r=e.parse(r));var i=t.blockSize,n=4*i;r.sigBytes>n&&(r=t.finalize(r));for(var s=this._oKey=r.clone(),o=this._iKey=r.clone(),a=s.words,c=o.words,h=0;i>h;h++)a[h]^=1549556828,c[h]^=909522486;s.sigBytes=o.sigBytes=n,this.reset()},reset:function(){var t=this._hasher;t.reset(),t.update(this._iKey)},update:function(t){return this._hasher.update(t),this},finalize:function(t){var e=this._hasher,t=e.finalize(t);return e.reset(),e.finalize(this._oKey.clone().concat(t))}})}(),function(){var t=CryptoJS,e=t.lib,r=e.Base,i=e.WordArray,e=t.algo,n=e.HMAC,s=e.PBKDF2=r.extend({cfg:r.extend({keySize:4,hasher:e.SHA1,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){for(var r=this.cfg,s=n.create(r.hasher,t),o=i.create(),a=i.create([1]),c=o.words,h=a.words,l=r.keySize,r=r.iterations;c.length<l;){var u=s.update(e).finalize(a);s.reset();for(var f=u.words,p=f.length,d=u,g=1;r>g;g++){d=s.finalize(d),s.reset();for(var m=d.words,b=0;p>b;b++)f[b]^=m[b]}o.concat(u),h[0]++}return o.sigBytes=4*l,o}});t.PBKDF2=function(t,e,r){return s.create(r).compute(t,e)}}(),Arcfour.prototype.init=ARC4init,Arcfour.prototype.next=ARC4next;var rng_psize=256,rng_state,rng_pool,rng_pptr;if(null==rng_pool){rng_pool=new Array,rng_pptr=0;var t;if("Netscape"==navigator.appName&&navigator.appVersion<"5"&&window.crypto){var z=window.crypto.random(32);for(t=0;t<z.length;++t)rng_pool[rng_pptr++]=255&z.charCodeAt(t)}for(;rng_psize>rng_pptr;)t=Math.floor(65536*Math.random()),rng_pool[rng_pptr++]=t>>>8,rng_pool[rng_pptr++]=255&t;rng_pptr=0,rng_seed_time()}SecureRandom.prototype.nextBytes=rng_get_bytes,RSAKey.prototype.doPublic=RSADoPublic,RSAKey.prototype.setPublic=RSASetPublic,RSAKey.prototype.encrypt=RSAEncrypt,RSAKey.prototype.doPrivate=RSADoPrivate,RSAKey.prototype.setPrivate=RSASetPrivate,RSAKey.prototype.setPrivateEx=RSASetPrivateEx,RSAKey.prototype.generate=RSAGenerate,RSAKey.prototype.decrypt=RSADecrypt;var sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(t){this.toString=function(){return"CORRUPT: "+this.message},this.message=t},invalid:function(t){this.toString=function(){return"INVALID: "+this.message},this.message=t},bug:function(t){this.toString=function(){return"BUG: "+this.message},this.message=t},notReady:function(t){this.toString=function(){return"NOT READY: "+this.message},this.message=t}}};"undefined"!=typeof module&&module.exports&&(module.exports=sjcl),sjcl.cipher.aes=function(t){this._tables[0][0][0]||this._precompute();var e,r,i,n,s,o=this._tables[0][4],a=this._tables[1],c=t.length,h=1;if(4!==c&&6!==c&&8!==c)throw new sjcl.exception.invalid("invalid aes key size");for(this._key=[n=t.slice(0),s=[]],e=c;4*c+28>e;e++)i=n[e-1],(e%c===0||8===c&&e%c===4)&&(i=o[i>>>24]<<24^o[i>>16&255]<<16^o[i>>8&255]<<8^o[255&i],e%c===0&&(i=i<<8^i>>>24^h<<24,h=h<<1^283*(h>>7))),n[e]=n[e-c]^i;for(r=0;e;r++,e--)i=n[3&r?e:e-4],4>=e||4>r?s[r]=i:s[r]=a[0][o[i>>>24]]^a[1][o[i>>16&255]]^a[2][o[i>>8&255]]^a[3][o[255&i]]},sjcl.cipher.aes.prototype={encrypt:function(t){return this._crypt(t,0)},decrypt:function(t){return this._crypt(t,1)},_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],_precompute:function(){var t,e,r,i,n,s,o,a,c,h=this._tables[0],l=this._tables[1],u=h[4],f=l[4],p=[],d=[];for(t=0;256>t;t++)d[(p[t]=t<<1^283*(t>>7))^t]=t;for(e=r=0;!u[e];e^=i||1,r=d[r]||1)for(o=r^r<<1^r<<2^r<<3^r<<4,o=o>>8^255&o^99,u[e]=o,f[o]=e,s=p[n=p[i=p[e]]],c=16843009*s^65537*n^257*i^16843008*e,a=257*p[o]^16843008*o,t=0;4>t;t++)h[t][e]=a=a<<24^a>>>8,l[t][o]=c=c<<24^c>>>8;for(t=0;5>t;t++)h[t]=h[t].slice(0),l[t]=l[t].slice(0)},_crypt:function(t,e){if(4!==t.length)throw new sjcl.exception.invalid("invalid aes block size");var r,i,n,s,o=this._key[e],a=t[0]^o[0],c=t[e?3:1]^o[1],h=t[2]^o[2],l=t[e?1:3]^o[3],u=o.length/4-2,f=4,p=[0,0,0,0],d=this._tables[e],g=d[0],m=d[1],b=d[2],v=d[3],y=d[4];for(s=0;u>s;s++)r=g[a>>>24]^m[c>>16&255]^b[h>>8&255]^v[255&l]^o[f],i=g[c>>>24]^m[h>>16&255]^b[l>>8&255]^v[255&a]^o[f+1],n=g[h>>>24]^m[l>>16&255]^b[a>>8&255]^v[255&c]^o[f+2],l=g[l>>>24]^m[a>>16&255]^b[c>>8&255]^v[255&h]^o[f+3],f+=4,a=r,c=i,h=n;for(s=0;4>s;s++)p[e?3&-s:s]=y[a>>>24]<<24^y[c>>16&255]<<16^y[h>>8&255]<<8^y[255&l]^o[f++],r=a,a=c,c=h,h=l,l=r;return p}},sjcl.bitArray={bitSlice:function(t,e,r){return t=sjcl.bitArray._shiftRight(t.slice(e/32),32-(31&e)).slice(1),void 0===r?t:sjcl.bitArray.clamp(t,r-e)},extract:function(t,e,r){var i,n=Math.floor(-e-r&31);return i=-32&(e+r-1^e)?t[e/32|0]<<32-n^t[e/32+1|0]>>>n:t[e/32|0]>>>n,i&(1<<r)-1},concat:function(t,e){if(0===t.length||0===e.length)return t.concat(e);var r=t[t.length-1],i=sjcl.bitArray.getPartial(r);return 32===i?t.concat(e):sjcl.bitArray._shiftRight(e,i,0|r,t.slice(0,t.length-1))},bitLength:function(t){var e,r=t.length;return 0===r?0:(e=t[r-1],32*(r-1)+sjcl.bitArray.getPartial(e))},clamp:function(t,e){if(32*t.length<e)return t;t=t.slice(0,Math.ceil(e/32));var r=t.length;return e=31&e,r>0&&e&&(t[r-1]=sjcl.bitArray.partial(e,t[r-1]&2147483648>>e-1,1)),t},partial:function(t,e,r){return 32===t?e:(r?0|e:e<<32-t)+1099511627776*t},getPartial:function(t){return Math.round(t/1099511627776)||32},equal:function(t,e){if(sjcl.bitArray.bitLength(t)!==sjcl.bitArray.bitLength(e))return!1;var r,i=0;for(r=0;r<t.length;r++)i|=t[r]^e[r];return 0===i},_shiftRight:function(t,e,r,i){var n,s,o=0;for(void 0===i&&(i=[]);e>=32;e-=32)i.push(r),r=0;if(0===e)return i.concat(t);for(n=0;n<t.length;n++)i.push(r|t[n]>>>e),r=t[n]<<32-e;return o=t.length?t[t.length-1]:0,s=sjcl.bitArray.getPartial(o),i.push(sjcl.bitArray.partial(e+s&31,e+s>32?r:i.pop(),1)),i},_xor4:function(t,e){return[t[0]^e[0],t[1]^e[1],t[2]^e[2],t[3]^e[3]]}},sjcl.codec.utf8String={fromBits:function(t){var e,r,i="",n=sjcl.bitArray.bitLength(t);for(e=0;n/8>e;e++)0===(3&e)&&(r=t[e/4]),i+=String.fromCharCode(r>>>24),r<<=8;return decodeURIComponent(escape(i))},toBits:function(t){t=unescape(encodeURIComponent(t));var e,r=[],i=0;for(e=0;e<t.length;e++)i=i<<8|t.charCodeAt(e),3===(3&e)&&(r.push(i),i=0);return 3&e&&r.push(sjcl.bitArray.partial(8*(3&e),i)),r}},sjcl.codec.hex={fromBits:function(t){var e,r="";for(e=0;e<t.length;e++)r+=((0|t[e])+0xf00000000000).toString(16).substr(4);return r.substr(0,sjcl.bitArray.bitLength(t)/4)},toBits:function(t){var e,r,i=[];for(t=t.replace(/\s|0x/g,""),r=t.length,t+="00000000",e=0;e<t.length;e+=8)i.push(0^parseInt(t.substr(e,8),16));return sjcl.bitArray.clamp(i,4*r)}},sjcl.codec.base64={_chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(t,e,r){var i,n="",s=0,o=sjcl.codec.base64._chars,a=0,c=sjcl.bitArray.bitLength(t);for(r&&(o=o.substr(0,62)+"-_"),i=0;6*n.length<c;)n+=o.charAt((a^t[i]>>>s)>>>26),6>s?(a=t[i]<<6-s,s+=26,i++):(a<<=6,s-=6);for(;3&n.length&&!e;)n+="=";return n},toBits:function(t,e){t=t.replace(/\s|=/g,"");var r,i,n=[],s=0,o=sjcl.codec.base64._chars,a=0;for(e&&(o=o.substr(0,62)+"-_"),r=0;r<t.length;r++){if(i=o.indexOf(t.charAt(r)),0>i)throw new sjcl.exception.invalid("this isn't base64!");s>26?(s-=26,n.push(a^i>>>s),a=i<<32-s):(s+=6,a^=i<<32-s)}return 56&s&&n.push(sjcl.bitArray.partial(56&s,a,1)),n}},sjcl.codec.base64url={fromBits:function(t){return sjcl.codec.base64.fromBits(t,1,1)},toBits:function(t){return sjcl.codec.base64.toBits(t,1)}},sjcl.codec.bytes={fromBits:function(t){var e,r,i=[],n=sjcl.bitArray.bitLength(t);for(e=0;n/8>e;e++)0===(3&e)&&(r=t[e/4]),i.push(r>>>24),r<<=8;return i},toBits:function(t){var e,r=[],i=0;for(e=0;e<t.length;e++)i=i<<8|t[e],3===(3&e)&&(r.push(i),i=0);return 3&e&&r.push(sjcl.bitArray.partial(8*(3&e),i)),r}},sjcl.hash.sha256=function(t){this._key[0]||this._precompute(),t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},sjcl.hash.sha256.hash=function(t){return(new sjcl.hash.sha256).update(t).finalize()},sjcl.hash.sha256.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(t){"string"==typeof t&&(t=sjcl.codec.utf8String.toBits(t));var e,r=this._buffer=sjcl.bitArray.concat(this._buffer,t),i=this._length,n=this._length=i+sjcl.bitArray.bitLength(t);for(e=512+i&-512;n>=e;e+=512)this._block(r.splice(0,16));return this},finalize:function(){var t,e=this._buffer,r=this._h;for(e=sjcl.bitArray.concat(e,[sjcl.bitArray.partial(1,1)]),t=e.length+2;15&t;t++)e.push(0);for(e.push(Math.floor(this._length/4294967296)),e.push(0|this._length);e.length;)this._block(e.splice(0,16));return this.reset(),r},_init:[],_key:[],_precompute:function(){function t(t){return 4294967296*(t-Math.floor(t))|0}var e,r=0,i=2;t:for(;64>r;i++){for(e=2;i>=e*e;e++)if(i%e===0)continue t;8>r&&(this._init[r]=t(Math.pow(i,.5))),this._key[r]=t(Math.pow(i,1/3)),r++}},_block:function(t){var e,r,i,n,s=t.slice(0),o=this._h,a=this._key,c=o[0],h=o[1],l=o[2],u=o[3],f=o[4],p=o[5],d=o[6],g=o[7];for(e=0;64>e;e++)16>e?r=s[e]:(i=s[e+1&15],n=s[e+14&15],r=s[15&e]=(i>>>7^i>>>18^i>>>3^i<<25^i<<14)+(n>>>17^n>>>19^n>>>10^n<<15^n<<13)+s[15&e]+s[e+9&15]|0),r=r+g+(f>>>6^f>>>11^f>>>25^f<<26^f<<21^f<<7)+(d^f&(p^d))+a[e],g=d,d=p,p=f,f=u+r|0,u=l,l=h,h=c,c=r+(h&l^u&(h^l))+(h>>>2^h>>>13^h>>>22^h<<30^h<<19^h<<10)|0;o[0]=o[0]+c|0,o[1]=o[1]+h|0,o[2]=o[2]+l|0,o[3]=o[3]+u|0,o[4]=o[4]+f|0,o[5]=o[5]+p|0,o[6]=o[6]+d|0,o[7]=o[7]+g|0}},sjcl.hash.sha512=function(t){this._key[0]||this._precompute(),t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},sjcl.hash.sha512.hash=function(t){return(new sjcl.hash.sha512).update(t).finalize()},sjcl.hash.sha512.prototype={blockSize:1024,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(t){"string"==typeof t&&(t=sjcl.codec.utf8String.toBits(t));var e,r=this._buffer=sjcl.bitArray.concat(this._buffer,t),i=this._length,n=this._length=i+sjcl.bitArray.bitLength(t);for(e=1024+i&-1024;n>=e;e+=1024)this._block(r.splice(0,32));return this},finalize:function(){var t,e=this._buffer,r=this._h;for(e=sjcl.bitArray.concat(e,[sjcl.bitArray.partial(1,1)]),t=e.length+4;31&t;t++)e.push(0);for(e.push(0),e.push(0),e.push(Math.floor(this._length/4294967296)),e.push(0|this._length);e.length;)this._block(e.splice(0,32));return this.reset(),r},_init:[],_initr:[12372232,13281083,9762859,1914609,15106769,4090911,4308331,8266105],_key:[],_keyr:[2666018,15689165,5061423,9034684,4764984,380953,1658779,7176472,197186,7368638,14987916,16757986,8096111,1480369,13046325,6891156,15813330,5187043,9229749,11312229,2818677,10937475,4324308,1135541,6741931,11809296,16458047,15666916,11046850,698149,229999,945776,13774844,2541862,12856045,9810911,11494366,7844520,15576806,8533307,15795044,4337665,16291729,5553712,15684120,6662416,7413802,12308920,13816008,4303699,9366425,10176680,13195875,4295371,6546291,11712675,15708924,1519456,15772530,6568428,6495784,8568297,13007125,7492395,2515356,12632583,14740254,7262584,1535930,13146278,16321966,1853211,294276,13051027,13221564,1051980,4080310,6651434,14088940,4675607],_precompute:function(){function t(t){return 4294967296*(t-Math.floor(t))|0}function e(t){return 1099511627776*(t-Math.floor(t))&255}var r,i=0,n=2;t:for(;80>i;n++){for(r=2;n>=r*r;r++)if(n%r===0)continue t;8>i&&(this._init[2*i]=t(Math.pow(n,.5)),this._init[2*i+1]=e(Math.pow(n,.5))<<24|this._initr[i]),this._key[2*i]=t(Math.pow(n,1/3)),this._key[2*i+1]=e(Math.pow(n,1/3))<<24|this._keyr[i],i++}},_block:function(t){var e,r,i,n=t.slice(0),s=this._h,o=this._key,a=s[0],c=s[1],h=s[2],l=s[3],u=s[4],f=s[5],p=s[6],d=s[7],g=s[8],m=s[9],b=s[10],v=s[11],y=s[12],_=s[13],B=s[14],w=s[15],j=a,A=c,S=h,C=l,x=u,I=f,T=p,E=d,D=g,M=m,R=b,k=v,P=y,q=_,F=B,L=w;for(e=0;80>e;e++){if(16>e)r=n[2*e],i=n[2*e+1];else{var O=n[2*(e-15)],z=n[2*(e-15)+1],N=(z<<31|O>>>1)^(z<<24|O>>>8)^O>>>7,K=(O<<31|z>>>1)^(O<<24|z>>>8)^(O<<25|z>>>7),V=n[2*(e-2)],U=n[2*(e-2)+1],G=(U<<13|V>>>19)^(V<<3|U>>>29)^V>>>6,J=(V<<13|U>>>19)^(U<<3|V>>>29)^(V<<26|U>>>6),H=n[2*(e-7)],W=n[2*(e-7)+1],Y=n[2*(e-16)],Z=n[2*(e-16)+1];i=K+W,r=N+H+(K>>>0>i>>>0?1:0),i+=J,r+=G+(J>>>0>i>>>0?1:0),i+=Z,r+=Y+(Z>>>0>i>>>0?1:0)}n[2*e]=r|=0,n[2*e+1]=i|=0;var X=D&R^~D&P,$=M&k^~M&q,Q=j&S^j&x^S&x,tt=A&C^A&I^C&I,et=(A<<4|j>>>28)^(j<<30|A>>>2)^(j<<25|A>>>7),rt=(j<<4|A>>>28)^(A<<30|j>>>2)^(A<<25|j>>>7),it=(M<<18|D>>>14)^(M<<14|D>>>18)^(D<<23|M>>>9),nt=(D<<18|M>>>14)^(D<<14|M>>>18)^(M<<23|D>>>9),st=o[2*e],ot=o[2*e+1],at=L+nt,ct=F+it+(L>>>0>at>>>0?1:0);at+=$,ct+=X+($>>>0>at>>>0?1:0),at+=ot,ct+=st+(ot>>>0>at>>>0?1:0),at+=i,ct+=r+(i>>>0>at>>>0?1:0);var ht=rt+tt,lt=et+Q+(rt>>>0>ht>>>0?1:0);F=P,L=q,P=R,q=k,R=D,k=M,M=E+at|0,D=T+ct+(E>>>0>M>>>0?1:0)|0,T=x,E=I,x=S,I=C,S=j,C=A,A=at+ht|0,j=ct+lt+(at>>>0>A>>>0?1:0)|0}c=s[1]=c+A|0,s[0]=a+j+(A>>>0>c>>>0?1:0)|0,l=s[3]=l+C|0,s[2]=h+S+(C>>>0>l>>>0?1:0)|0,f=s[5]=f+I|0,s[4]=u+x+(I>>>0>f>>>0?1:0)|0,d=s[7]=d+E|0,s[6]=p+T+(E>>>0>d>>>0?1:0)|0,m=s[9]=m+M|0,s[8]=g+D+(M>>>0>m>>>0?1:0)|0,v=s[11]=v+k|0,s[10]=b+R+(k>>>0>v>>>0?1:0)|0,_=s[13]=_+q|0,s[12]=y+P+(q>>>0>_>>>0?1:0)|0,w=s[15]=w+L|0,s[14]=B+F+(L>>>0>w>>>0?1:0)|0}},sjcl.hash.sha1=function(t){t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},sjcl.hash.sha1.hash=function(t){return(new sjcl.hash.sha1).update(t).finalize()},sjcl.hash.sha1.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(t){"string"==typeof t&&(t=sjcl.codec.utf8String.toBits(t));var e,r=this._buffer=sjcl.bitArray.concat(this._buffer,t),i=this._length,n=this._length=i+sjcl.bitArray.bitLength(t);for(e=this.blockSize+i&-this.blockSize;n>=e;e+=this.blockSize)this._block(r.splice(0,16));return this},finalize:function(){var t,e=this._buffer,r=this._h;for(e=sjcl.bitArray.concat(e,[sjcl.bitArray.partial(1,1)]),t=e.length+2;15&t;t++)e.push(0);for(e.push(Math.floor(this._length/4294967296)),e.push(0|this._length);e.length;)this._block(e.splice(0,16));return this.reset(),r},_init:[1732584193,4023233417,2562383102,271733878,3285377520],_key:[1518500249,1859775393,2400959708,3395469782],_f:function(t,e,r,i){return 19>=t?e&r|~e&i:39>=t?e^r^i:59>=t?e&r|e&i|r&i:79>=t?e^r^i:null},_S:function(t,e){return e<<t|e>>>32-t},_block:function(t){{var e,r,i,n,s,o,a,c=t.slice(0),h=this._h;this._key}for(i=h[0],n=h[1],s=h[2],o=h[3],a=h[4],e=0;79>=e;e++)e>=16&&(c[e]=this._S(1,c[e-3]^c[e-8]^c[e-14]^c[e-16])),r=this._S(5,i)+this._f(e,n,s,o)+a+c[e]+this._key[Math.floor(e/20)]|0,a=o,o=s,s=this._S(30,n),n=i,i=r;h[0]=h[0]+i|0,h[1]=h[1]+n|0,h[2]=h[2]+s|0,h[3]=h[3]+o|0,h[4]=h[4]+a|0}},sjcl.mode.ccm={name:"ccm",encrypt:function(t,e,r,i,n){var s,o,a=e.slice(0),c=sjcl.bitArray,h=c.bitLength(r)/8,l=c.bitLength(a)/8;if(n=n||64,i=i||[],7>h)throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes");for(s=2;4>s&&l>>>8*s;s++);return 15-h>s&&(s=15-h),r=c.clamp(r,8*(15-s)),o=sjcl.mode.ccm._computeTag(t,e,r,i,n,s),a=sjcl.mode.ccm._ctrMode(t,a,r,o,n,s),c.concat(a.data,a.tag)},decrypt:function(t,e,r,i,n){n=n||64,i=i||[];var s,o,a=sjcl.bitArray,c=a.bitLength(r)/8,h=a.bitLength(e),l=a.clamp(e,h-n),u=a.bitSlice(e,h-n);if(h=(h-n)/8,7>c)throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes");for(s=2;4>s&&h>>>8*s;s++);if(15-c>s&&(s=15-c),r=a.clamp(r,8*(15-s)),l=sjcl.mode.ccm._ctrMode(t,l,r,u,n,s),o=sjcl.mode.ccm._computeTag(t,l.data,r,i,n,s),!a.equal(l.tag,o))throw new sjcl.exception.corrupt("ccm: tag doesn't match");return l.data},_computeTag:function(t,e,r,i,n,s){var o,a,c,h=[],l=sjcl.bitArray,u=l._xor4;if(n/=8,n%2||4>n||n>16)throw new sjcl.exception.invalid("ccm: invalid tag length");if(i.length>4294967295||e.length>4294967295)throw new sjcl.exception.bug("ccm: can't deal with 4GiB or more data");if(o=[l.partial(8,(i.length?64:0)|n-2<<2|s-1)],o=l.concat(o,r),o[3]|=l.bitLength(e)/8,o=t.encrypt(o),i.length)for(a=l.bitLength(i)/8,65279>=a?h=[l.partial(16,a)]:4294967295>=a&&(h=l.concat([l.partial(16,65534)],[a])),h=l.concat(h,i),c=0;c<h.length;c+=4)o=t.encrypt(u(o,h.slice(c,c+4).concat([0,0,0])));for(c=0;c<e.length;c+=4)o=t.encrypt(u(o,e.slice(c,c+4).concat([0,0,0])));return l.clamp(o,8*n)},_ctrMode:function(t,e,r,i,n,s){var o,a,c,h=sjcl.bitArray,l=h._xor4,u=e.length,f=h.bitLength(e);if(c=h.concat([h.partial(8,s-1)],r).concat([0,0,0]).slice(0,4),i=h.bitSlice(l(i,t.encrypt(c)),0,n),!u)return{tag:i,data:[]};for(a=0;u>a;a+=4)c[3]++,o=t.encrypt(c),e[a]^=o[0],e[a+1]^=o[1],e[a+2]^=o[2],e[a+3]^=o[3];return{tag:i,data:h.clamp(e,f)}}},sjcl.mode.ctr={name:"ctr",encrypt:function(t,e,r,i){{var n=e.slice(0),s=sjcl.bitArray,o=s.bitLength(r)/8;s.bitLength(n)/8}if(i&&i.length)throw new sjcl.exception.invalid("ctr: can't authenticate data");if(8>o)throw new sjcl.exception.invalid("ctr: iv must be at least 64-bits (was "+o+")");return r=s.clamp(r,64),n=sjcl.mode.ctr._ctrMode(t,n,r),n.data},decrypt:function(t,e,r,i){var n=sjcl.bitArray,s=n.bitLength(r)/8,o=n.bitLength(e),a=n.clamp(e,o);if(i&&i.length)throw new sjcl.exception.invalid("ctr: can't authenticate data");if(o/=8,8!=s)throw new sjcl.exception.invalid("ctr: iv must be 64-bits");return r=n.clamp(r,64),a=sjcl.mode.ctr._ctrMode(t,a,r),a.data},_ctrMode:function(t,e,r){var i,n,s,o=sjcl.bitArray,a=(o._xor4,e.length),c=o.bitLength(e);if(s=o.concat(r,[0,0]),!a)return{data:[]};for(n=0;a>n;n+=4)i=t.encrypt(s),e[n]^=i[0],e[n+1]^=i[1],e[n+2]^=i[2],e[n+3]^=i[3],s[3]++;return{data:o.clamp(e,c)}}},sjcl.mode.cbc={name:"cbc",encrypt:function(t,e,r,i){if(i&&i.length)throw new sjcl.exception.invalid("cbc can't authenticate data");if(128!==sjcl.bitArray.bitLength(r))throw new sjcl.exception.invalid("cbc iv must be 128 bits");var n,s=sjcl.bitArray,o=s._xor4,a=s.bitLength(e),c=0,h=[];if(7&a)throw new sjcl.exception.invalid("pkcs#5 padding only works for multiples of a byte");for(n=0;a>=c+128;n+=4,c+=128)r=t.encrypt(o(r,e.slice(n,n+4))),h.splice(n,0,r[0],r[1],r[2],r[3]);return a=16843009*(16-(a>>3&15)),r=t.encrypt(o(r,s.concat(e,[a,a,a,a]).slice(n,n+4))),h.splice(n,0,r[0],r[1],r[2],r[3]),h},decrypt:function(t,e,r,i){if(i&&i.length)throw new sjcl.exception.invalid("cbc can't authenticate data");if(128!==sjcl.bitArray.bitLength(r))throw new sjcl.exception.invalid("cbc iv must be 128 bits");if(127&sjcl.bitArray.bitLength(e)||!e.length)throw new sjcl.exception.corrupt("cbc ciphertext must be a positive multiple of the block size");var n,s,o,a=sjcl.bitArray,c=a._xor4,h=[];for(i=i||[],n=0;n<e.length;n+=4)s=e.slice(n,n+4),o=c(r,t.decrypt(s)),h.splice(n,0,o[0],o[1],o[2],o[3]),r=s;if(s=255&h[n-1],0==s||s>16)throw new sjcl.exception.corrupt("pkcs#5 padding corrupt");if(o=16843009*s,!a.equal(a.bitSlice([o,o,o,o],0,8*s),a.bitSlice(h,32*h.length-8*s,32*h.length)))throw new sjcl.exception.corrupt("pkcs#5 padding corrupt");return a.bitSlice(h,0,32*h.length-8*s)}},sjcl.mode.ocb2={name:"ocb2",encrypt:function(t,e,r,i,n,s){if(128!==sjcl.bitArray.bitLength(r))throw new sjcl.exception.invalid("ocb iv must be 128 bits");var o,a,c,h,l=sjcl.mode.ocb2._times2,u=sjcl.bitArray,f=u._xor4,p=[0,0,0,0],d=l(t.encrypt(r)),g=[];for(i=i||[],n=n||64,o=0;o+4<e.length;o+=4)a=e.slice(o,o+4),p=f(p,a),g=g.concat(f(d,t.encrypt(f(d,a)))),d=l(d);return a=e.slice(o),c=u.bitLength(a),h=t.encrypt(f(d,[0,0,0,c])),a=u.clamp(f(a.concat([0,0,0]),h),c),p=f(p,f(a.concat([0,0,0]),h)),p=t.encrypt(f(p,f(d,l(d)))),i.length&&(p=f(p,s?i:sjcl.mode.ocb2.pmac(t,i))),g.concat(u.concat(a,u.clamp(p,n)))},decrypt:function(t,e,r,i,n,s){if(128!==sjcl.bitArray.bitLength(r))throw new sjcl.exception.invalid("ocb iv must be 128 bits");n=n||64;var o,a,c,h,l=sjcl.mode.ocb2._times2,u=sjcl.bitArray,f=u._xor4,p=[0,0,0,0],d=l(t.encrypt(r)),g=sjcl.bitArray.bitLength(e)-n,m=[];for(i=i||[],o=0;g/32>o+4;o+=4)a=f(d,t.decrypt(f(d,e.slice(o,o+4)))),p=f(p,a),m=m.concat(a),d=l(d);if(c=g-32*o,h=t.encrypt(f(d,[0,0,0,c])),a=f(h,u.clamp(e.slice(o),c).concat([0,0,0])),p=f(p,a),p=t.encrypt(f(p,f(d,l(d)))),i.length&&(p=f(p,s?i:sjcl.mode.ocb2.pmac(t,i))),!u.equal(u.clamp(p,n),u.bitSlice(e,g)))throw new sjcl.exception.corrupt("ocb: tag doesn't match");return m.concat(u.clamp(a,c))},pmac:function(t,e){var r,i,n=sjcl.mode.ocb2._times2,s=sjcl.bitArray,o=s._xor4,a=[0,0,0,0],c=t.encrypt([0,0,0,0]);for(c=o(c,n(n(c))),r=0;r+4<e.length;r+=4)c=n(c),a=o(a,t.encrypt(o(c,e.slice(r,r+4))));return i=e.slice(r),s.bitLength(i)<128&&(c=o(c,n(c)),i=s.concat(i,[-2147483648,0,0,0])),a=o(a,i),t.encrypt(o(n(o(c,n(c))),a))},_times2:function(t){return[t[0]<<1^t[1]>>>31,t[1]<<1^t[2]>>>31,t[2]<<1^t[3]>>>31,t[3]<<1^135*(t[0]>>>31)]}},sjcl.mode.gcm={name:"gcm",encrypt:function(t,e,r,i,n){var s,o=e.slice(0),a=sjcl.bitArray;return n=n||128,i=i||[],s=sjcl.mode.gcm._ctrMode(!0,t,o,i,r,n),a.concat(s.data,s.tag)},decrypt:function(t,e,r,i,n){var s,o,a=e.slice(0),c=sjcl.bitArray,h=c.bitLength(a);if(n=n||128,i=i||[],h>=n?(o=c.bitSlice(a,h-n),a=c.bitSlice(a,0,h-n)):(o=a,a=[]),s=sjcl.mode.gcm._ctrMode(!1,t,a,i,r,n),!c.equal(s.tag,o))throw new sjcl.exception.corrupt("gcm: tag doesn't match");return s.data},_galoisMultiply:function(t,e){var r,i,n,s,o,a,c=sjcl.bitArray,h=c._xor4;for(s=[0,0,0,0],o=e.slice(0),r=0;128>r;r++){for(n=0!==(t[Math.floor(r/32)]&1<<31-r%32),n&&(s=h(s,o)),a=0!==(1&o[3]),i=3;i>0;i--)o[i]=o[i]>>>1|(1&o[i-1])<<31;o[0]=o[0]>>>1,a&&(o[0]=o[0]^225<<24)}return s},_ghash:function(t,e,r){var i,n,s=r.length;for(i=e.slice(0),n=0;s>n;n+=4)i[0]^=4294967295&r[n],i[1]^=4294967295&r[n+1],i[2]^=4294967295&r[n+2],i[3]^=4294967295&r[n+3],i=sjcl.mode.gcm._galoisMultiply(i,t);return i},_ctrMode:function(t,e,r,i,n,s){{var o,a,c,h,l,u,f,p,d,g,m,b,v=sjcl.bitArray;v._xor4}for(d=r.length,g=v.bitLength(r),m=v.bitLength(i),b=v.bitLength(n),o=e.encrypt([0,0,0,0]),96===b?(a=n.slice(0),a=v.concat(a,[1])):(a=sjcl.mode.gcm._ghash(o,[0,0,0,0],n),a=sjcl.mode.gcm._ghash(o,a,[0,0,Math.floor(b/4294967296),4294967295&b])),c=sjcl.mode.gcm._ghash(o,[0,0,0,0],i),u=a.slice(0),f=c.slice(0),t||(f=sjcl.mode.gcm._ghash(o,c,r)),l=0;d>l;l+=4)u[3]++,h=e.encrypt(u),r[l]^=h[0],r[l+1]^=h[1],r[l+2]^=h[2],r[l+3]^=h[3];return r=v.clamp(r,g),t&&(f=sjcl.mode.gcm._ghash(o,c,r)),p=[Math.floor(m/4294967296),4294967295&m,Math.floor(g/4294967296),4294967295&g],f=sjcl.mode.gcm._ghash(o,f,p),h=e.encrypt(a),f[0]^=h[0],f[1]^=h[1],f[2]^=h[2],f[3]^=h[3],{tag:v.bitSlice(f,0,s),data:r}}},sjcl.misc.hmac=function(t,e){this._hash=e=e||sjcl.hash.sha256;var r,i=[[],[]],n=e.prototype.blockSize/32;for(this._baseHash=[new e,new e],t.length>n&&(t=e.hash(t)),r=0;n>r;r++)t[r]||(t[r]=0),i[0][r]=909522486^t[r],i[1][r]=1549556828^t[r];this._baseHash[0].update(i[0]),this._baseHash[1].update(i[1])},sjcl.misc.hmac.prototype.encrypt=sjcl.misc.hmac.prototype.mac=function(t){var e=new this._hash(this._baseHash[0]).update(t).finalize();return new this._hash(this._baseHash[1]).update(e).finalize()},sjcl.misc.pbkdf2=function(t,e,r,i,n,s){if(r=r||1e3,s=s||sjcl.hash.sha256,0>i||0>r)throw sjcl.exception.invalid("invalid params to pbkdf2");"string"==typeof t&&(t=sjcl.codec.utf8String.toBits(t)),n=n||sjcl.misc.hmac;var o,a,c,h,l,u=new n(t,s),f=[],p=sjcl.bitArray;for(l=1;32*f.length<(i||1);l++)try{for(o=a=u.encrypt(p.concat(e,[l])),c=1;r>c;c++)for(a=u.encrypt(a),h=0;h<a.length;h++)o[h]^=a[h]}finally{f=f.concat(o)}return i&&(f=p.clamp(f,i)),f},sjcl.prng=function(t){this._pools=[new sjcl.hash.sha256],this._poolEntropy=[0],this._reseedCount=0,this._robins={},this._eventId=0,this._collectorIds={},this._collectorIdNext=0,this._strength=0,this._poolStrength=0,this._nextReseed=0,this._key=[0,0,0,0,0,0,0,0],this._counter=[0,0,0,0],this._cipher=void 0,this._defaultParanoia=t,this._collectorsStarted=!1,this._callbacks={progress:{},seeded:{}},this._callbackI=0,this._NOT_READY=0,this._READY=1,this._REQUIRES_RESEED=2,this._MAX_WORDS_PER_BURST=65536,this._PARANOIA_LEVELS=[0,48,64,96,128,192,256,384,512,768,1024],this._MILLISECONDS_PER_RESEED=3e4,this._BITS_PER_RESEED=80},sjcl.prng.prototype={randomWords:function(t,e){var r,i,n=[],s=this.isReady(e);if(s===this._NOT_READY)throw new sjcl.exception.notReady("generator isn't seeded");for(s&this._REQUIRES_RESEED&&this._reseedFromPools(!(s&this._READY)),r=0;t>r;r+=4)(r+1)%this._MAX_WORDS_PER_BURST===0&&this._gate(),i=this._gen4words(),n.push(i[0],i[1],i[2],i[3]);return this._gate(),n.slice(0,t)},setDefaultParanoia:function(t){this._defaultParanoia=t},addEntropy:function(t,e,r){r=r||"user";var i,n,s,o=(new Date).valueOf(),a=this._robins[r],c=this.isReady(),h=0;switch(i=this._collectorIds[r],void 0===i&&(i=this._collectorIds[r]=this._collectorIdNext++),void 0===a&&(a=this._robins[r]=0),this._robins[r]=(this._robins[r]+1)%this._pools.length,typeof t){case"number":void 0===e&&(e=1),this._pools[a].update([i,this._eventId++,1,e,o,1,0|t]);break;case"object":var l=Object.prototype.toString.call(t);if("[object Uint32Array]"===l){for(s=[],n=0;n<t.length;n++)s.push(t[n]);t=s}else for("[object Array]"!==l&&(h=1),n=0;n<t.length&&!h;n++)"number"!=typeof t[n]&&(h=1);if(!h){if(void 0===e)for(e=0,n=0;n<t.length;n++)for(s=t[n];s>0;)e++,s>>>=1;this._pools[a].update([i,this._eventId++,2,e,o,t.length].concat(t))}break;case"string":void 0===e&&(e=t.length),this._pools[a].update([i,this._eventId++,3,e,o,t.length]),this._pools[a].update(t);break;default:h=1}if(h)throw new sjcl.exception.bug("random: addEntropy only supports number, array of numbers or string");this._poolEntropy[a]+=e,this._poolStrength+=e,c===this._NOT_READY&&(this.isReady()!==this._NOT_READY&&this._fireEvent("seeded",Math.max(this._strength,this._poolStrength)),this._fireEvent("progress",this.getProgress()))},isReady:function(t){var e=this._PARANOIA_LEVELS[void 0!==t?t:this._defaultParanoia];return this._strength&&this._strength>=e?this._poolEntropy[0]>this._BITS_PER_RESEED&&(new Date).valueOf()>this._nextReseed?this._REQUIRES_RESEED|this._READY:this._READY:this._poolStrength>=e?this._REQUIRES_RESEED|this._NOT_READY:this._NOT_READY},getProgress:function(t){var e=this._PARANOIA_LEVELS[t?t:this._defaultParanoia];return this._strength>=e?1:this._poolStrength>e?1:this._poolStrength/e},startCollectors:function(){if(!this._collectorsStarted){if(window.addEventListener)window.addEventListener("load",this._loadTimeCollector,!1),window.addEventListener("mousemove",this._mouseCollector,!1);else{if(!document.attachEvent)throw new sjcl.exception.bug("can't attach event");document.attachEvent("onload",this._loadTimeCollector),document.attachEvent("onmousemove",this._mouseCollector)}this._collectorsStarted=!0}},stopCollectors:function(){this._collectorsStarted&&(window.removeEventListener?(window.removeEventListener("load",this._loadTimeCollector,!1),window.removeEventListener("mousemove",this._mouseCollector,!1)):window.detachEvent&&(window.detachEvent("onload",this._loadTimeCollector),window.detachEvent("onmousemove",this._mouseCollector)),this._collectorsStarted=!1)},addEventListener:function(t,e){this._callbacks[t][this._callbackI++]=e},removeEventListener:function(t,e){var r,i,n=this._callbacks[t],s=[];for(i in n)n.hasOwnProperty(i)&&n[i]===e&&s.push(i);for(r=0;r<s.length;r++)i=s[r],delete n[i]},_gen4words:function(){for(var t=0;4>t&&(this._counter[t]=this._counter[t]+1|0,!this._counter[t]);t++);return this._cipher.encrypt(this._counter)},_gate:function(){this._key=this._gen4words().concat(this._gen4words()),this._cipher=new sjcl.cipher.aes(this._key)},_reseed:function(t){this._key=sjcl.hash.sha256.hash(this._key.concat(t)),this._cipher=new sjcl.cipher.aes(this._key);for(var e=0;4>e&&(this._counter[e]=this._counter[e]+1|0,!this._counter[e]);e++);},_reseedFromPools:function(t){var e,r=[],i=0;for(this._nextReseed=r[0]=(new Date).valueOf()+this._MILLISECONDS_PER_RESEED,e=0;16>e;e++)r.push(4294967296*Math.random()|0);for(e=0;e<this._pools.length&&(r=r.concat(this._pools[e].finalize()),i+=this._poolEntropy[e],this._poolEntropy[e]=0,t||!(this._reseedCount&1<<e));e++);this._reseedCount>=1<<this._pools.length&&(this._pools.push(new sjcl.hash.sha256),this._poolEntropy.push(0)),this._poolStrength-=i,i>this._strength&&(this._strength=i),this._reseedCount++,this._reseed(r)},_mouseCollector:function(t){var e=t.x||t.clientX||t.offsetX||0,r=t.y||t.clientY||t.offsetY||0;sjcl.random.addEntropy([e,r],2,"mouse")},_loadTimeCollector:function(t){sjcl.random.addEntropy((new Date).valueOf(),2,"loadtime")},_fireEvent:function(t,e){var r,i=sjcl.random._callbacks[t],n=[];for(r in i)i.hasOwnProperty(r)&&n.push(i[r]);for(r=0;r<n.length;r++)n[r](e)}},sjcl.random=new sjcl.prng(6),function(){try{var t=new Uint32Array(32);crypto.getRandomValues(t),sjcl.random.addEntropy(t,1024,"crypto.getRandomValues")}catch(e){}}(),sjcl.json={defaults:{v:1,iter:1e3,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},encrypt:function(t,e,r,i){r=r||{},i=i||{};var n,s,o,a=sjcl.json,c=a._add({iv:sjcl.random.randomWords(4,0)},a.defaults);if(a._add(c,r),o=c.adata,
"string"==typeof c.salt&&(c.salt=sjcl.codec.base64.toBits(c.salt)),"string"==typeof c.iv&&(c.iv=sjcl.codec.base64.toBits(c.iv)),!sjcl.mode[c.mode]||!sjcl.cipher[c.cipher]||"string"==typeof t&&c.iter<=100||64!==c.ts&&96!==c.ts&&128!==c.ts||128!==c.ks&&192!==c.ks&&256!==c.ks||c.iv.length<2||c.iv.length>4)throw new sjcl.exception.invalid("json encrypt: invalid parameters");return"string"==typeof t?r.compat&&"veness"==r.compat?t=sjcl.misc.venessCompatKDF(t,c):(n=sjcl.misc.cachedPbkdf2(t,c),t=n.key.slice(0,c.ks/32),c.salt=n.salt):sjcl.ecc&&t instanceof sjcl.ecc.elGamal.publicKey&&(n=t.kem(),c.kemtag=n.tag,t=n.key.slice(0,c.ks/32)),"string"==typeof e&&(e=sjcl.codec.utf8String.toBits(e)),"string"==typeof o&&(o=sjcl.codec.utf8String.toBits(o)),s=new sjcl.cipher[c.cipher](t),a._add(i,c),i.key=t,c.ct=sjcl.mode[c.mode].encrypt(s,e,c.iv,o,c.ts),a.encode(c)},decrypt:function(t,e,r,i){r=r||{},i=i||{};var n,s,o,a=sjcl.json,c=a._add(a._add(a._add({},a.defaults),a.decode(e)),r,!0),h=c.adata;if("string"==typeof c.salt&&(c.salt=sjcl.codec.base64.toBits(c.salt)),"string"==typeof c.iv&&(c.iv=sjcl.codec.base64.toBits(c.iv)),!sjcl.mode[c.mode]||!sjcl.cipher[c.cipher]||"string"==typeof t&&c.iter<=100||64!==c.ts&&96!==c.ts&&128!==c.ts||128!==c.ks&&192!==c.ks&&256!==c.ks||!c.iv||c.iv.length<2||c.iv.length>4)throw new sjcl.exception.invalid("json decrypt: invalid parameters");return"string"==typeof t?r.compat&&"veness"==r.compat?t=sjcl.misc.venessCompatKDF(t,c):(s=sjcl.misc.cachedPbkdf2(t,c),t=s.key.slice(0,c.ks/32),c.salt=s.salt):sjcl.ecc&&t instanceof sjcl.ecc.elGamal.secretKey&&(t=t.unkem(sjcl.codec.base64.toBits(c.kemtag)).slice(0,c.ks/32)),"string"==typeof h&&(h=sjcl.codec.utf8String.toBits(h)),o=new sjcl.cipher[c.cipher](t),n=sjcl.mode[c.mode].decrypt(o,c.ct,c.iv,h,c.ts),a._add(i,c),i.key=t,sjcl.codec.utf8String.fromBits(n)},encode:function(t){var e,r="{",i="";for(e in t)if(t.hasOwnProperty(e)){if(!e.match(/^[a-z0-9]+$/i))throw new sjcl.exception.invalid("json encode: invalid property name");switch(r+=i+'"'+e+'":',i=",",typeof t[e]){case"number":case"boolean":r+=t[e];break;case"string":r+='"'+escape(t[e])+'"';break;case"object":r+='"'+sjcl.codec.base64.fromBits(t[e],0)+'"';break;default:throw new sjcl.exception.bug("json encode: unsupported type")}}return r+"}"},decode:function(t){if(t=t.replace(/\s/g,""),!t.match(/^\{.*\}$/))throw new sjcl.exception.invalid("json decode: this isn't json!");var e,r,i=t.replace(/^\{|\}$/g,"").split(/,/),n={};for(e=0;e<i.length;e++){if(!(r=i[e].match(/^(?:(["']?)([a-z][a-z0-9]*)\1):(?:(\d+)|"([a-z0-9+\/%*_.@=\-]*)")$/i)))throw new sjcl.exception.invalid("json decode: this isn't json!");r[3]?n[r[2]]=parseInt(r[3],10):n[r[2]]=r[2].match(/^(ct|salt|iv)$/)?sjcl.codec.base64.toBits(r[4]):unescape(r[4])}return n},_add:function(t,e,r){if(void 0===t&&(t={}),void 0===e)return t;var i;for(i in e)if(e.hasOwnProperty(i)){if(r&&void 0!==t[i]&&t[i]!==e[i])throw new sjcl.exception.invalid("required parameter overridden");t[i]=e[i]}return t},_subtract:function(t,e){var r,i={};for(r in t)t.hasOwnProperty(r)&&t[r]!==e[r]&&(i[r]=t[r]);return i},_filter:function(t,e){var r,i={};for(r=0;r<e.length;r++)void 0!==t[e[r]]&&(i[e[r]]=t[e[r]]);return i}},sjcl.encrypt=sjcl.json.encrypt,sjcl.decrypt=sjcl.json.decrypt,sjcl.misc._pbkdf2Cache={},sjcl.misc.cachedPbkdf2=function(t,e){var r,i,n,s,o=sjcl.misc._pbkdf2Cache;return e=e||{},s=e.iter||1e3,i=o[t]=o[t]||{},r=i[s]=i[s]||{firstSalt:e.salt&&e.salt.length?e.salt.slice(0):sjcl.random.randomWords(2,0)},n=void 0===e.salt?r.firstSalt:e.salt,r[n]=r[n]||sjcl.misc.pbkdf2(t,n,e.iter),{key:r[n].slice(0),salt:n.slice(0)}},sjcl.misc.venessCompatKDF=function(t,e){var r,i=sjcl.bitArray;if("ctr"!=e.mode||"aes"!=e.cipher)throw new sjcl.exception.invalid("veness compat: only for aes in ctr mode");return t=i.concat(sjcl.codec.utf8String.toBits(t),[0,0,0,0,0,0,0,0]).slice(0,8),r=new sjcl.cipher[e.cipher](t),t=i.clamp(t,128),t=r.encrypt(t),t.concat(t)},sjcl.bn=function(t){this.initWith(t)},sjcl.bn.prototype={radix:24,maxMul:8,_class:sjcl.bn,copy:function(){return new this._class(this)},initWith:function(t){var e,r=0;switch(typeof t){case"object":this.limbs=t.limbs.slice(0);break;case"number":this.limbs=[t],this.normalize();break;case"string":for(t=t.replace(/^0x/,""),this.limbs=[],e=this.radix/4,r=0;r<t.length;r+=e)this.limbs.push(parseInt(t.substring(Math.max(t.length-r-e,0),t.length-r),16));break;default:this.limbs=[0]}return this},equals:function(t){"number"==typeof t&&(t=new this._class(t));var e,r=0;for(this.fullReduce(),t.fullReduce(),e=0;e<this.limbs.length||e<t.limbs.length;e++)r|=this.getLimb(e)^t.getLimb(e);return 0===r},getLimb:function(t){return t>=this.limbs.length?0:this.limbs[t]},greaterEquals:function(t){"number"==typeof t&&(t=new this._class(t));var e,r,i,n=0,s=0;for(e=Math.max(this.limbs.length,t.limbs.length)-1;e>=0;e--)r=this.getLimb(e),i=t.getLimb(e),s|=i-r&~n,n|=r-i&~s;return(s|~n)>>>31},toString:function(){this.fullReduce();var t,e,r="",i=this.limbs;for(t=0;t<this.limbs.length;t++){for(e=i[t].toString(16);t<this.limbs.length-1&&e.length<6;)e="0"+e;r=e+r}return"0x"+r},addM:function(t){"object"!=typeof t&&(t=new this._class(t));var e,r=this.limbs,i=t.limbs;for(e=r.length;e<i.length;e++)r[e]=0;for(e=0;e<i.length;e++)r[e]+=i[e];return this},doubleM:function(){var t,e,r=0,i=this.radix,n=this.radixMask,s=this.limbs;for(t=0;t<s.length;t++)e=s[t],e=e+e+r,s[t]=e&n,r=e>>i;return r&&s.push(r),this},halveM:function(){var t,e,r=0,i=this.radix,n=this.limbs;for(t=n.length-1;t>=0;t--)e=n[t],n[t]=e+r>>1,r=(1&e)<<i;return n[n.length-1]||n.pop(),this},subM:function(t){"object"!=typeof t&&(t=new this._class(t));var e,r=this.limbs,i=t.limbs;for(e=r.length;e<i.length;e++)r[e]=0;for(e=0;e<i.length;e++)r[e]-=i[e];return this},mod:function(t){var e=!this.greaterEquals(new sjcl.bn(0));t=new sjcl.bn(t).normalize();var r=new sjcl.bn(this).normalize(),i=0;for(e&&(r=new sjcl.bn(0).subM(r).normalize());r.greaterEquals(t);i++)t.doubleM();for(e&&(r=t.sub(r).normalize());i>0;i--)t.halveM(),r.greaterEquals(t)&&r.subM(t).normalize();return r.trim()},inverseMod:function(t){var e,r,i=new sjcl.bn(1),n=new sjcl.bn(0),s=new sjcl.bn(this),o=new sjcl.bn(t),a=1;if(!(1&t.limbs[0]))throw new sjcl.exception.invalid("inverseMod: p must be odd");do for(1&s.limbs[0]&&(s.greaterEquals(o)||(e=s,s=o,o=e,e=i,i=n,n=e),s.subM(o),s.normalize(),i.greaterEquals(n)||i.addM(t),i.subM(n)),s.halveM(),1&i.limbs[0]&&i.addM(t),i.normalize(),i.halveM(),r=a=0;r<s.limbs.length;r++)a|=s.limbs[r];while(a);if(!o.equals(1))throw new sjcl.exception.invalid("inverseMod: p and x must be relatively prime");return n},add:function(t){return this.copy().addM(t)},sub:function(t){return this.copy().subM(t)},mul:function(t){"number"==typeof t&&(t=new this._class(t));var e,r,i,n=this.limbs,s=t.limbs,o=n.length,a=s.length,c=new this._class,h=c.limbs,l=this.maxMul;for(e=0;e<this.limbs.length+t.limbs.length+1;e++)h[e]=0;for(e=0;o>e;e++){for(i=n[e],r=0;a>r;r++)h[e+r]+=i*s[r];--l||(l=this.maxMul,c.cnormalize())}return c.cnormalize().reduce()},square:function(){return this.mul(this)},power:function(t){"number"==typeof t?t=[t]:void 0!==t.limbs&&(t=t.normalize().limbs);var e,r,i=new this._class(1),n=this;for(e=0;e<t.length;e++)for(r=0;r<this.radix;r++)t[e]&1<<r&&(i=i.mul(n)),n=n.square();return i},mulmod:function(t,e){return this.mod(e).mul(t.mod(e)).mod(e)},powermod:function(t,e){for(var r=new sjcl.bn(1),i=new sjcl.bn(this),n=new sjcl.bn(t);;){if(1&n.limbs[0]&&(r=r.mulmod(i,e)),n.halveM(),n.equals(0))break;i=i.mulmod(i,e)}return r.normalize().reduce()},trim:function(){var t,e=this.limbs;do t=e.pop();while(e.length&&0===t);return e.push(t),this},reduce:function(){return this},fullReduce:function(){return this.normalize()},normalize:function(){var t,e,r,i=0,n=(this.placeVal,this.ipv),s=this.limbs,o=s.length,a=this.radixMask;for(t=0;o>t||0!==i&&-1!==i;t++)e=(s[t]||0)+i,r=s[t]=e&a,i=(e-r)*n;return-1===i&&(s[t-1]-=this.placeVal),this},cnormalize:function(){var t,e,r,i=0,n=this.ipv,s=this.limbs,o=s.length,a=this.radixMask;for(t=0;o-1>t;t++)e=s[t]+i,r=s[t]=e&a,i=(e-r)*n;return s[t]+=i,this},toBits:function(t){this.fullReduce(),t=t||this.exponent||this.bitLength();var e=Math.floor((t-1)/24),r=sjcl.bitArray,i=(t+7&-8)%this.radix||this.radix,n=[r.partial(i,this.getLimb(e))];for(e--;e>=0;e--)n=r.concat(n,[r.partial(Math.min(this.radix,t),this.getLimb(e))]),t-=this.radix;return n},bitLength:function(){this.fullReduce();for(var t=this.radix*(this.limbs.length-1),e=this.limbs[this.limbs.length-1];e;e>>>=1)t++;return t+7&-8}},sjcl.bn.fromBits=function(t){var e=this,r=new e,i=[],n=sjcl.bitArray,s=this.prototype,o=Math.min(this.bitLength||4294967296,n.bitLength(t)),a=o%s.radix||s.radix;for(i[0]=n.extract(t,0,a);o>a;a+=s.radix)i.unshift(n.extract(t,a,s.radix));return r.limbs=i,r},sjcl.bn.prototype.ipv=1/(sjcl.bn.prototype.placeVal=Math.pow(2,sjcl.bn.prototype.radix)),sjcl.bn.prototype.radixMask=(1<<sjcl.bn.prototype.radix)-1,sjcl.bn.pseudoMersennePrime=function(t,e){function r(t){this.initWith(t)}var i,n,s,o=r.prototype=new sjcl.bn;for(s=o.modOffset=Math.ceil(n=t/o.radix),o.exponent=t,o.offset=[],o.factor=[],o.minOffset=s,o.fullMask=0,o.fullOffset=[],o.fullFactor=[],o.modulus=r.modulus=new sjcl.bn(Math.pow(2,t)),o.fullMask=0|-Math.pow(2,t%o.radix),i=0;i<e.length;i++)o.offset[i]=Math.floor(e[i][0]/o.radix-n),o.fullOffset[i]=Math.ceil(e[i][0]/o.radix-n),o.factor[i]=e[i][1]*Math.pow(.5,t-e[i][0]+o.offset[i]*o.radix),o.fullFactor[i]=e[i][1]*Math.pow(.5,t-e[i][0]+o.fullOffset[i]*o.radix),o.modulus.addM(new sjcl.bn(Math.pow(2,e[i][0])*e[i][1])),o.minOffset=Math.min(o.minOffset,-o.offset[i]);return o._class=r,o.modulus.cnormalize(),o.reduce=function(){var t,e,r,i,n=this.modOffset,s=this.limbs,o=this.offset,a=this.offset.length,c=this.factor;for(t=this.minOffset;s.length>n;){for(r=s.pop(),i=s.length,e=0;a>e;e++)s[i+o[e]]-=c[e]*r;t--,t||(s.push(0),this.cnormalize(),t=this.minOffset)}return this.cnormalize(),this},o._strongReduce=-1===o.fullMask?o.reduce:function(){var t,e,r=this.limbs,i=r.length-1;if(this.reduce(),i===this.modOffset-1){for(e=r[i]&this.fullMask,r[i]-=e,t=0;t<this.fullOffset.length;t++)r[i+this.fullOffset[t]]-=this.fullFactor[t]*e;this.normalize()}},o.fullReduce=function(){var t,e;for(this._strongReduce(),this.addM(this.modulus),this.addM(this.modulus),this.normalize(),this._strongReduce(),e=this.limbs.length;e<this.modOffset;e++)this.limbs[e]=0;for(t=this.greaterEquals(this.modulus),e=0;e<this.limbs.length;e++)this.limbs[e]-=this.modulus.limbs[e]*t;return this.cnormalize(),this},o.inverse=function(){return this.power(this.modulus.sub(2))},r.fromBits=sjcl.bn.fromBits,r},sjcl.bn.prime={p127:sjcl.bn.pseudoMersennePrime(127,[[0,-1]]),p25519:sjcl.bn.pseudoMersennePrime(255,[[0,-19]]),p192:sjcl.bn.pseudoMersennePrime(192,[[0,-1],[64,-1]]),p224:sjcl.bn.pseudoMersennePrime(224,[[0,1],[96,-1]]),p256:sjcl.bn.pseudoMersennePrime(256,[[0,-1],[96,1],[192,1],[224,-1]]),p384:sjcl.bn.pseudoMersennePrime(384,[[0,-1],[32,1],[96,-1],[128,-1]]),p521:sjcl.bn.pseudoMersennePrime(521,[[0,-1]])},sjcl.bn.random=function(t,e){"object"!=typeof t&&(t=new sjcl.bn(t));for(var r,i,n=t.limbs.length,s=t.limbs[n-1]+1,o=new sjcl.bn;;){do r=sjcl.random.randomWords(n,e),r[n-1]<0&&(r[n-1]+=4294967296);while(Math.floor(r[n-1]/s)===Math.floor(4294967296/s));for(r[n-1]%=s,i=0;n-1>i;i++)r[i]&=t.radixMask;if(o.limbs=r,!o.greaterEquals(t))return o}},sjcl.ecc={},sjcl.ecc.point=function(t,e,r){void 0===e?this.isIdentity=!0:(this.x=e,this.y=r,this.isIdentity=!1),this.curve=t},sjcl.ecc.point.prototype={toJac:function(){return new sjcl.ecc.pointJac(this.curve,this.x,this.y,new this.curve.field(1))},mult:function(t){return this.toJac().mult(t,this).toAffine()},mult2:function(t,e,r){return this.toJac().mult2(t,this,e,r).toAffine()},multiples:function(){var t,e,r;if(void 0===this._multiples)for(r=this.toJac().doubl(),t=this._multiples=[new sjcl.ecc.point(this.curve),this,r.toAffine()],e=3;16>e;e++)r=r.add(this),t.push(r.toAffine());return this._multiples},isValid:function(){return this.y.square().equals(this.curve.b.add(this.x.mul(this.curve.a.add(this.x.square()))))},toBits:function(){return sjcl.bitArray.concat(this.x.toBits(),this.y.toBits())}},sjcl.ecc.pointJac=function(t,e,r,i){void 0===e?this.isIdentity=!0:(this.x=e,this.y=r,this.z=i,this.isIdentity=!1),this.curve=t},sjcl.ecc.pointJac.prototype={add:function(t){var e,r,i,n,s,o,a,c,h,l,u,f=this;if(f.curve!==t.curve)throw"sjcl.ecc.add(): Points must be on the same curve to add them!";return f.isIdentity?t.toJac():t.isIdentity?f:(e=f.z.square(),r=t.x.mul(e).subM(f.x),r.equals(0)?f.y.equals(t.y.mul(e.mul(f.z)))?f.doubl():new sjcl.ecc.pointJac(f.curve):(i=t.y.mul(e.mul(f.z)).subM(f.y),n=r.square(),s=i.square(),o=r.square().mul(r).addM(f.x.add(f.x).mul(n)),a=s.subM(o),c=f.x.mul(n).subM(a).mul(i),h=f.y.mul(r.square().mul(r)),l=c.subM(h),u=f.z.mul(r),new sjcl.ecc.pointJac(this.curve,a,l,u)))},doubl:function(){if(this.isIdentity)return this;var t=this.y.square(),e=t.mul(this.x.mul(4)),r=t.square().mul(8),i=this.z.square(),n=this.x.sub(i).mul(3).mul(this.x.add(i)),s=n.square().subM(e).subM(e),o=e.sub(s).mul(n).subM(r),a=this.y.add(this.y).mul(this.z);return new sjcl.ecc.pointJac(this.curve,s,o,a)},toAffine:function(){if(this.isIdentity||this.z.equals(0))return new sjcl.ecc.point(this.curve);var t=this.z.inverse(),e=t.square();return new sjcl.ecc.point(this.curve,this.x.mul(e).fullReduce(),this.y.mul(e.mul(t)).fullReduce())},mult:function(t,e){"number"==typeof t?t=[t]:void 0!==t.limbs&&(t=t.normalize().limbs);var r,i,n=new sjcl.ecc.point(this.curve).toJac(),s=e.multiples();for(r=t.length-1;r>=0;r--)for(i=sjcl.bn.prototype.radix-4;i>=0;i-=4)n=n.doubl().doubl().doubl().doubl().add(s[t[r]>>i&15]);return n},mult2:function(t,e,r,i){"number"==typeof t?t=[t]:void 0!==t.limbs&&(t=t.normalize().limbs),"number"==typeof r?r=[r]:void 0!==r.limbs&&(r=r.normalize().limbs);var n,s,o,a,c=new sjcl.ecc.point(this.curve).toJac(),h=e.multiples(),l=i.multiples();for(n=Math.max(t.length,r.length)-1;n>=0;n--)for(o=0|t[n],a=0|r[n],s=sjcl.bn.prototype.radix-4;s>=0;s-=4)c=c.doubl().doubl().doubl().doubl().add(h[o>>s&15]).add(l[a>>s&15]);return c},isValid:function(){var t=this.z.square(),e=t.square(),r=e.mul(t);return this.y.square().equals(this.curve.b.mul(r).add(this.x.mul(this.curve.a.mul(e).add(this.x.square()))))}},sjcl.ecc.curve=function(t,e,r,i,n,s){this.field=t,this.r=t.prototype.modulus.sub(e),this.a=new t(r),this.b=new t(i),this.G=new sjcl.ecc.point(this,new t(n),new t(s))},sjcl.ecc.curve.prototype.fromBits=function(t){var e=sjcl.bitArray,r=this.field.prototype.exponent+7&-8,i=new sjcl.ecc.point(this,this.field.fromBits(e.bitSlice(t,0,r)),this.field.fromBits(e.bitSlice(t,r,2*r)));if(!i.isValid())throw new sjcl.exception.corrupt("not on the curve!");return i},sjcl.ecc.curves={c192:new sjcl.ecc.curve(sjcl.bn.prime.p192,"0x662107c8eb94364e4b2dd7ce",-3,"0x64210519e59c80e70fa7e9ab72243049feb8deecc146b9b1","0x188da80eb03090f67cbf20eb43a18800f4ff0afd82ff1012","0x07192b95ffc8da78631011ed6b24cdd573f977a11e794811"),c224:new sjcl.ecc.curve(sjcl.bn.prime.p224,"0xe95c1f470fc1ec22d6baa3a3d5c4",-3,"0xb4050a850c04b3abf54132565044b0b7d7bfd8ba270b39432355ffb4","0xb70e0cbd6bb4bf7f321390b94a03c1d356c21122343280d6115c1d21","0xbd376388b5f723fb4c22dfe6cd4375a05a07476444d5819985007e34"),c256:new sjcl.ecc.curve(sjcl.bn.prime.p256,"0x4319055358e8617b0c46353d039cdaae",-3,"0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b","0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296","0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),c384:new sjcl.ecc.curve(sjcl.bn.prime.p384,"0x389cb27e0bc8d21fa7e5f24cb74f58851313e696333ad68c",-3,"0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef","0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7","0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},sjcl.ecc._dh=function(t){sjcl.ecc[t]={publicKey:function(t,e){this._curve=t,this._curveBitLength=t.r.bitLength(),e instanceof Array?this._point=t.fromBits(e):this._point=e,this.get=function(){var t=this._point.toBits(),e=sjcl.bitArray.bitLength(t),r=sjcl.bitArray.bitSlice(t,0,e/2),i=sjcl.bitArray.bitSlice(t,e/2);return{x:r,y:i}}},secretKey:function(t,e){this._curve=t,this._curveBitLength=t.r.bitLength(),this._exponent=e,this.get=function(){return this._exponent.toBits()}},generateKeys:function(e,r,i){if(void 0===e&&(e=256),"number"==typeof e&&(e=sjcl.ecc.curves["c"+e],void 0===e))throw new sjcl.exception.invalid("no such curve");void 0===i&&(i=sjcl.bn.random(e.r,r));var n=e.G.mult(i);return{pub:new sjcl.ecc[t].publicKey(e,n),sec:new sjcl.ecc[t].secretKey(e,i)}}}},sjcl.ecc._dh("elGamal"),sjcl.ecc.elGamal.publicKey.prototype={kem:function(t){var e=sjcl.bn.random(this._curve.r,t),r=this._curve.G.mult(e).toBits(),i=sjcl.hash.sha256.hash(this._point.mult(e).toBits());return{key:i,tag:r}}},sjcl.ecc.elGamal.secretKey.prototype={unkem:function(t){return sjcl.hash.sha256.hash(this._curve.fromBits(t).mult(this._exponent).toBits())},dh:function(t){return sjcl.hash.sha256.hash(t._point.mult(this._exponent).toBits())}},sjcl.ecc._dh("ecdsa"),sjcl.ecc.ecdsa.secretKey.prototype={sign:function(t,e,r,i){sjcl.bitArray.bitLength(t)>this._curveBitLength&&(t=sjcl.bitArray.clamp(t,this._curveBitLength));var n=this._curve.r,s=n.bitLength(),o=i||sjcl.bn.random(n.sub(1),e).add(1),a=this._curve.G.mult(o).x.mod(n),c=sjcl.bn.fromBits(t).add(a.mul(this._exponent)),h=r?c.inverseMod(n).mul(o).mod(n):c.mul(o.inverseMod(n)).mod(n);return sjcl.bitArray.concat(a.toBits(s),h.toBits(s))}},sjcl.ecc.ecdsa.publicKey.prototype={verify:function(t,e,r){sjcl.bitArray.bitLength(t)>this._curveBitLength&&(t=sjcl.bitArray.clamp(t,this._curveBitLength));var i=sjcl.bitArray,n=this._curve.r,s=this._curveBitLength,o=sjcl.bn.fromBits(i.bitSlice(e,0,s)),a=sjcl.bn.fromBits(i.bitSlice(e,s,2*s)),c=r?a:a.inverseMod(n),h=sjcl.bn.fromBits(t).mul(c).mod(n),l=o.mul(c).mod(n),u=this._curve.G.mult2(h,l,this._point).x;if(o.equals(0)||a.equals(0)||o.greaterEquals(n)||a.greaterEquals(n)||!u.equals(o)){if(void 0===r)return this.verify(t,e,!0);throw new sjcl.exception.corrupt("signature didn't check out")}return!0}},sjcl.keyexchange.srp={makeVerifier:function(t,e,r,i){var n;return n=sjcl.keyexchange.srp.makeX(t,e,r),n=sjcl.bn.fromBits(n),i.g.powermod(n,i.N)},makeX:function(t,e,r){var i=sjcl.hash.sha1.hash(t+":"+e);return sjcl.hash.sha1.hash(sjcl.bitArray.concat(r,i))},knownGroup:function(t){return"string"!=typeof t&&(t=t.toString()),sjcl.keyexchange.srp._didInitKnownGroups||sjcl.keyexchange.srp._initKnownGroups(),sjcl.keyexchange.srp._knownGroups[t]},_didInitKnownGroups:!1,_initKnownGroups:function(){var t,e,r;for(t=0;t<sjcl.keyexchange.srp._knownGroupSizes.length;t++)e=sjcl.keyexchange.srp._knownGroupSizes[t].toString(),r=sjcl.keyexchange.srp._knownGroups[e],r.N=new sjcl.bn(r.N),r.g=new sjcl.bn(r.g);sjcl.keyexchange.srp._didInitKnownGroups=!0},_knownGroupSizes:[1024,1536,2048],_knownGroups:{1024:{N:"EEAF0AB9ADB38DD69C33F80AFA8FC5E86072618775FF3C0B9EA2314C9C256576D674DF7496EA81D3383B4813D692C6E0E0D5D8E250B98BE48E495C1D6089DAD15DC7D7B46154D6B6CE8EF4AD69B15D4982559B297BCF1885C529F566660E57EC68EDBC3C05726CC02FD4CBF4976EAA9AFD5138FE8376435B9FC61D2FC0EB06E3",g:2},1536:{N:"9DEF3CAFB939277AB1F12A8617A47BBBDBA51DF499AC4C80BEEEA9614B19CC4D5F4F5F556E27CBDE51C6A94BE4607A291558903BA0D0F84380B655BB9A22E8DCDF028A7CEC67F0D08134B1C8B97989149B609E0BE3BAB63D47548381DBC5B1FC764E3F4B53DD9DA1158BFD3E2B9C8CF56EDF019539349627DB2FD53D24B7C48665772E437D6C7F8CE442734AF7CCB7AE837C264AE3A9BEB87F8A2FE9B8B5292E5A021FFF5E91479E8CE7A28C2442C6F315180F93499A234DCF76E3FED135F9BB",g:2},2048:{N:"AC6BDB41324A9A9BF166DE5E1389582FAF72B6651987EE07FC3192943DB56050A37329CBB4A099ED8193E0757767A13DD52312AB4B03310DCD7F48A9DA04FD50E8083969EDB767B0CF6095179A163AB3661A05FBD5FAAAE82918A9962F0B93B855F97993EC975EEAA80D740ADBF4FF747359D041D5C33EA71D281E446B14773BCA97B43A23FB801676BD207A436C6481F1D2B9078717461A5B9D32E688F87748544523B524B0D57D5EA77A2775D2ECFA032CFBDBF52FB3786160279004E57AE6AF874E7303CE53299CCC041C7BC308D82A5698F3A8D0C38271AE35F8E9DBFBB694B5C803D89F7AE435DE236D525F54759B65E372FCD68EF20FA7111F9E4AFF73",g:2}}},function(){try{var t,e,r;if("undefined"!=typeof module&&module.exports&&(e=getCryptoModule())&&e.randomBytes)t=e.randomBytes(128),t=new Uint32Array(new Uint8Array(t).buffer),sjcl.random.addEntropy(t,1024,"crypto.randomBytes");else if(window&&window.Uint32Array){if(r=new Uint32Array(32),window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(r);else{if(!window.msCrypto||!window.msCrypto.getRandomValues)return;window.msCrypto.getRandomValues(r)}if("[object Uint32Array]"!==Object.prototype.toString.call(r)){var i=[];for(var n in r)i.push(r[n]);r=i}sjcl.random.addEntropy(r,1024,"crypto.getRandomValues")}}catch(s){"undefined"!=typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(s))}}(),PB="undefined"==typeof PB?{}:PB,PB.crypto={settings:{aes_version:"CCM"},RSA:{generate:function(t){var e=new RSAKey;e.generate(parseInt(t),"3");var r=new Object;return r.n=e.n.toString(16),r.e=e.e.toString(16),r.d=e.d.toString(16),r.p=e.p.toString(16),r.q=e.q.toString(16),r.dmp1=e.dmp1.toString(16),r.dmq1=e.dmq1.toString(16),r.coeff=e.coeff.toString(16),r},makeKeys:function(t){var e={};e.n=t.n.toString(16),e.e=t.e.toString(16);var r={};r.n=t.n.toString(16),r.e=t.e.toString(16),r.d=t.d.toString(16),r.p=t.p.toString(16),r.q=t.q.toString(16),r.dmp1=t.dmp1.toString(16),r.dmq1=t.dmq1.toString(16),t.iqmp?r.coeff=t.iqmp.toString(16):t.coeff&&(r.coeff=t.coeff.toString(16));var i={jsonPublicKey:e,jsonPrivateKey:r};return i},encrypt:function(t,e){var r=new RSAKey;return r.setPublic(e.n,e.e),r.encrypt(t)},decrypt:function(t,e){var r=new RSAKey;return r.setPrivateEx(e.n,e.e,e.d,e.p,e.q,e.dmp1,e.dmq1,e.coeff),r.decrypt(t)}},AES:{encrypt:function(t,e,r){return"number"==typeof t&&(t=t.toString()),"CTR"==PB.crypto.settings.aes_version?PB.crypto.COMPAT.encryptVeness(t,e,256):"CCM"==PB.crypto.settings.aes_version?PB.crypto.COMPAT.encrypt(t,e,256):void 0},decrypt:function(t,e,r){return PB.crypto.COMPAT.decrypt(t,e,256)}},PBKDF2:{derive:function(t,e,r){return CryptoJS.PBKDF2(t,e,r)}},SALT:{generate:function(){if("desktop-extension-firefox"==PB.config.target)return CryptoJS.lib.WordArray.random(16).toString();var t=sjcl.random.randomWords(8),e=sjcl.codec.hex.fromBits(t);return e}},COMPAT:{encrypt:function(t,e,r){var i=sjcl.bitArray,n=sjcl.json,s=i.partial(16,4);params={mode:"ccm",ks:r?r:256},rp={},"string"==typeof e&&(e=sjcl.codec.hex.toBits(e)),i.bitLength(e)>256&&(e=i.clamp(e,256));var o=sjcl.encrypt(e,t,params,rp),a=n.decode(o);return sjcl.codec.base64.fromBits(i.concat([s],i.concat(a.iv,a.ct)))},decrypt:function(t,e,r){var i,n,s,o=sjcl.bitArray,a=sjcl.json,c={};i=sjcl.codec.base64.toBits(t);var h=o.extract(i,8,8);if(4>h)s={iv:o.clamp(i,64),compat:"veness"},ctxt=i.slice(2),mode="ctr";else{if(h>4)throw"invalid cipher format version";"string"==typeof e&&(e=sjcl.codec.hex.toBits(e)),o.bitLength(e)>256&&(e=o.clamp(e,256)),i=o.bitSlice(i,16),s={iv:o.clamp(i,128)},ctxt=i.slice(4),mode="ccm"}return n=a.encode({mode:mode,ks:r?r:256,ct:ctxt}),sjcl.decrypt(e,n,s,c)},version:function(t){return sjcl.bitArray.extract(sjcl.codec.base64.toBits(t),8,8)},encryptVeness:function(t,e,r){var i=sjcl.bitArray,n=sjcl.json,s=sjcl.random.randomWords(2,0);s[0]&=4278452223;var o={mode:"ctr",ks:r?r:256,compat:"veness",iv:s};rp={};var a=sjcl.encrypt(e,t,o,rp),c=n.decode(a);return sjcl.codec.base64.fromBits(i.concat(c.iv,c.ct))},decryptVeness:function(t,e,r){var i,n,s,o=sjcl.bitArray,a=sjcl.json,c={};return i=sjcl.codec.base64.toBits(t),s={iv:o.clamp(i,64),compat:"veness"},n=a.encode({mode:"ctr",ks:r?r:256,ct:i.slice(2)}),sjcl.decrypt(e,n,s,c)}}},PB.crypto.SHA1=function(t){var e,r,i,n,s,o,a,c,h,l=function(t,e){return t<<e|t>>>32-e},u=function(t){var e,r,i="";for(e=7;e>=0;e--)r=t>>>4*e&15,i+=r.toString(16);return i},f=function(t){t=t.replace(/\x0d\x0a/g,"\n");for(var e="",r=0;r<t.length;r++){var i=t.charCodeAt(r);128>i?e+=String.fromCharCode(i):i>127&&2048>i?(e+=String.fromCharCode(i>>6|192),e+=String.fromCharCode(63&i|128)):(e+=String.fromCharCode(i>>12|224),e+=String.fromCharCode(i>>6&63|128),e+=String.fromCharCode(63&i|128))}return e},p=new Array(80),d=1732584193,g=4023233417,m=2562383102,b=271733878,v=3285377520;t=f(t);var y=t.length,_=new Array;for(r=0;y-3>r;r+=4)i=t.charCodeAt(r)<<24|t.charCodeAt(r+1)<<16|t.charCodeAt(r+2)<<8|t.charCodeAt(r+3),_.push(i);switch(y%4){case 0:r=2147483648;break;case 1:r=t.charCodeAt(y-1)<<24|8388608;break;case 2:r=t.charCodeAt(y-2)<<24|t.charCodeAt(y-1)<<16|32768;break;case 3:r=t.charCodeAt(y-3)<<24|t.charCodeAt(y-2)<<16|t.charCodeAt(y-1)<<8|128}for(_.push(r);_.length%16!=14;)_.push(0);for(_.push(y>>>29),_.push(y<<3&4294967295),e=0;e<_.length;e+=16){for(r=0;16>r;r++)p[r]=_[e+r];for(r=16;79>=r;r++)p[r]=l(p[r-3]^p[r-8]^p[r-14]^p[r-16],1);for(n=d,s=g,o=m,a=b,c=v,r=0;19>=r;r++)h=l(n,5)+(s&o|~s&a)+c+p[r]+1518500249&4294967295,c=a,a=o,o=l(s,30),s=n,n=h;for(r=20;39>=r;r++)h=l(n,5)+(s^o^a)+c+p[r]+1859775393&4294967295,c=a,a=o,o=l(s,30),s=n,n=h;for(r=40;59>=r;r++)h=l(n,5)+(s&o|s&a|o&a)+c+p[r]+2400959708&4294967295,c=a,a=o,o=l(s,30),s=n,n=h;for(r=60;79>=r;r++)h=l(n,5)+(s^o^a)+c+p[r]+3395469782&4294967295,c=a,a=o,o=l(s,30),s=n,n=h;d=d+n&4294967295,g=g+s&4294967295,m=m+o&4294967295,b=b+a&4294967295,v=v+c&4294967295}var h=u(d)+u(g)+u(m)+u(b)+u(v);return h.toLowerCase()},PB.Crypto={},PB.Crypto.RSA={generate:function(t,e){if(!t||"object"!=typeof t)throw"Invalid parameter object";if(!e||"function"!=typeof e)throw"Invalid callback function";if(!t.length)throw"Required parameter 'length'";var r=new RSAKey;r.generate(parseInt(t.length),"3");var i=new Object;i.n=r.n.toString(16),i.e=r.e.toString(16),i.d=r.d.toString(16),i.p=r.p.toString(16),i.q=r.q.toString(16),i.dmp1=r.dmp1.toString(16),i.dmq1=r.dmq1.toString(16),i.coeff=r.coeff.toString(16),e(i)},makeKeys:function(t,e){if(!t||"object"!=typeof t)throw"Invalid parameter object";if(!e||"function"!=typeof e)throw"Invalid callback function";if(!t.rsa)throw"Required parameter 'rsa'";var r=t.rsa,i={};i.n=r.n.toString(16),i.e=r.e.toString(16);var n={};n.n=r.n.toString(16),n.e=r.e.toString(16),n.d=r.d.toString(16),n.p=r.p.toString(16),n.q=r.q.toString(16),n.dmp1=r.dmp1.toString(16),n.dmq1=r.dmq1.toString(16),n.coeff=r.iqmp.toString(16);var s={jsonPublicKey:i,jsonPrivateKey:n};e(s)},encrypt:function(t,e){if(!t||"object"!=typeof t)throw"Invalid parameter object";if(!e||"function"!=typeof e)throw"Invalid callback function";if(!t.secret)throw"Required parameter 'secret'";if(!t.key)throw"Required parameter 'key'";var r=t.secret,i=t.key,n=new RSAKey;n.setPublic(i.n,i.e);var s=n.encrypt(r);e(s)},decrypt:function(t,e){if(!t||"object"!=typeof t)throw"Invalid parameter object";if(!e||"function"!=typeof e)throw"Invalid callback function";if(!t.cipher)throw"Required parameter 'cipher'";if(!t.key)throw"Required parameter 'key'";var r=t.cipher,i=t.key,n=new RSAKey;n.setPrivateEx(i.n,i.e,i.d,i.p,i.q,i.dmp1,i.dmq1,i.coeff);var s=n.decrypt(r);e(s)}},PB.Crypto.AES={encrypt:function(t,e){if(!t||"object"!=typeof t)throw"Invalid parameter object";if(!e||"function"!=typeof e)throw"Invalid callback function";if(!t.plain)throw"Required parameter 'plain'";if(!t.passphrase)throw"Required parameter 'passphrase'";var r=t.plain,i=t.passphrase,i=("undefined"==typeof t.length?256:t.length,t.plaintext,t.passphrase);"CTR"==PB.crypto.settings.aes_version?e(PB.crypto.COMPAT.encryptVeness(r,i,256)):"CCM"==PB.crypto.settings.aes_version&&e(PB.crypto.COMPAT.encrypt(r,i,256))},decrypt:function(t,e){if(!t||"object"!=typeof t)throw"Invalid parameter object";if(!e||"function"!=typeof e)throw"Invalid callback function";if(!t.cipher)throw"Required parameter 'cipher'";if(!t.passphrase)throw"Required parameter 'passphrase'";var r=t.cipher,i=t.passphrase,r=("undefined"==typeof t.length?256:t.length,t.cipher),i=t.passphrase;e(PB.crypto.COMPAT.decrypt(r,i,256))}},PB.Crypto.PBKDF2={derive:function(t,e){if(!t||"object"!=typeof t)throw"Invalid parameter object";if(!e||"function"!=typeof e)throw"Invalid callback function";if(!t.plain)throw"Required parameter 'plain'";if(!t.salt)throw"Required parameter 'salt'";if(!t.length)throw"Required parameter 'length'";if(!t.iterations)throw"Required parameter 'iterations'";var r=t.plain,i=t.salt,n=t.length,s=t.iterations,o=t.sha256?sjcl.hash.sha256:sjcl.hash.sha1,a=sjcl.codec.hex.fromBits(sjcl.misc.pbkdf2(r,sjcl.codec.utf8String.toBits(i),s,n,sjcl.misc.hmac,o));e(a)}},PB.Crypto.SHA1=function(t,e){if(!t||"object"!=typeof t)throw"Invalid parameter object";if(!e||"function"!=typeof e)throw"Invalid callback function";var r,i,n,s,o,a,c,h,l,u=function(t,e){return t<<e|t>>>32-e},f=function(t){var e,r,i="";for(e=7;e>=0;e--)r=t>>>4*e&15,i+=r.toString(16);return i},p=function(t){t=t.replace(/\x0d\x0a/g,"\n");for(var e="",r=0;r<t.length;r++){var i=t.charCodeAt(r);128>i?e+=String.fromCharCode(i):i>127&&2048>i?(e+=String.fromCharCode(i>>6|192),e+=String.fromCharCode(63&i|128)):(e+=String.fromCharCode(i>>12|224),e+=String.fromCharCode(i>>6&63|128),e+=String.fromCharCode(63&i|128))}return e},d=new Array(80),g=1732584193,m=4023233417,b=2562383102,v=271733878,y=3285377520,_=p(t.string),B=_.length,w=new Array;for(i=0;B-3>i;i+=4)n=_.charCodeAt(i)<<24|_.charCodeAt(i+1)<<16|_.charCodeAt(i+2)<<8|_.charCodeAt(i+3),w.push(n);switch(B%4){case 0:i=2147483648;break;case 1:i=_.charCodeAt(B-1)<<24|8388608;break;case 2:i=_.charCodeAt(B-2)<<24|_.charCodeAt(B-1)<<16|32768;break;case 3:i=_.charCodeAt(B-3)<<24|_.charCodeAt(B-2)<<16|_.charCodeAt(B-1)<<8|128}for(w.push(i);w.length%16!=14;)w.push(0);for(w.push(B>>>29),w.push(B<<3&4294967295),r=0;r<w.length;r+=16){for(i=0;16>i;i++)d[i]=w[r+i];for(i=16;79>=i;i++)d[i]=u(d[i-3]^d[i-8]^d[i-14]^d[i-16],1);for(s=g,o=m,a=b,c=v,h=y,i=0;19>=i;i++)l=u(s,5)+(o&a|~o&c)+h+d[i]+1518500249&4294967295,h=c,c=a,a=u(o,30),o=s,s=l;for(i=20;39>=i;i++)l=u(s,5)+(o^a^c)+h+d[i]+1859775393&4294967295,h=c,c=a,a=u(o,30),o=s,s=l;for(i=40;59>=i;i++)l=u(s,5)+(o&a|o&c|a&c)+h+d[i]+2400959708&4294967295,h=c,c=a,a=u(o,30),o=s,s=l;for(i=60;79>=i;i++)l=u(s,5)+(o^a^c)+h+d[i]+3395469782&4294967295,h=c,c=a,a=u(o,30),o=s,s=l;g=g+s&4294967295,m=m+o&4294967295,b=b+a&4294967295,v=v+c&4294967295,y=y+h&4294967295}var l=f(g)+f(m)+f(b)+f(v)+f(y);e(l.toLowerCase())},PB.Crypto.computeDerivedKey=function(t,e){function r(e){return t.client_iterations?void PB.Crypto.PBKDF2.derive({plain:e,salt:t.salt,iterations:parseInt(s),length:512,sha256:!0},i):i(e)}function i(e){PB.Crypto.PBKDF2.derive({plain:e,salt:t.salt,iterations:parseInt(o),length:256,sha256:!0},n)}function n(t){e(t)}if(!t||"object"!=typeof t)throw"Invalid parameter object";if(!e||"function"!=typeof e)throw"Invalid callback function";if(!t.plain)throw"Required parameter 'plain'";if(!t.salt)throw"Required parameter 'salt'";var s=t.client_iterations||0,o=t.server_iterations||1;PB.Crypto.PBKDF2.derive({plain:t.plain,salt:t.salt,iterations:1,length:512},r)},PB.Crypto.computeKey=PB.Crypto.computeKek=function(t,e){function r(e){PB.Crypto.PBKDF2.derive({plain:e+""+t.password,salt:t.salt,iterations:1,length:512},i)}function i(r){return t.encryptedKey?void PB.Crypto.AES.decrypt({cipher:t.encryptedKey,passphrase:r},n):e(r)}function n(t){e(t)}if(!t||"object"!=typeof t)throw"Invalid parameter object";if(!e||"function"!=typeof e)throw"Invalid callback function";if(!t.password)throw"Required parameter 'password'";if(!t.salt)throw"Required parameter 'salt'";if(!t.rules)throw"Required parameter 'rules'";if("object"!=typeof t.rules)throw"Invalid 'rules' parameter";PB.Crypto.computeDerivedKey({plain:t.password,salt:t.salt,server_iterations:t.rules.iterations,client_iterations:t.rules.client_iterations},r)},PB.Crypto.computeDerivedPassword=function(t,e){function r(t){e(t)}if(!t||"object"!=typeof t)throw"Invalid parameter object";if(!e||"function"!=typeof e)throw"Invalid callback function";

if(!t.email)throw"Required parameter 'email'";if(!t.password)throw"Required parameter 'password'";var i=PB.crypto.SHA1(t.email);PB.Crypto.PBKDF2.derive({plain:t.password,salt:i,iterations:1e4,length:256,sha256:!0},r)},PB.Crypto.computeLocalDataKey=function(t,e){function r(t){e(t)}if(!t||"object"!=typeof t)throw"Invalid parameter object";if(!e||"function"!=typeof e)throw"Invalid callback function";if(!t.base)throw"Required parameter 'base'";if(!t.salt)throw"Required parameter 'salt'";PB.Crypto.PBKDF2.derive({plain:t.base,salt:t.salt,iterations:1e4,length:512},r)},onmessage=function(t){function e(t){n.output=t,n.timeTaken=i-new Date,postMessage(JSON.stringify(n))}var r=t.data,i=+new Date,n={status:0,message:"Success",input:r};if("undefined"==typeof PB)return n.status=1,n.message="Namespace PB is not defined",void postMessage(JSON.stringify(n));try{r=JSON.parse(r)}catch(s){return n.status=2,n.message="Parameter is invalid JSON: "+s.message,void postMessage(JSON.stringify(n))}if(!r.fn)return n.status=3,n.message="Parameter fn is required",void postMessage(JSON.stringify(n));for(var o=r.fn,a=o.split("."),c=PB,h=0;h<a.length;++h){var l=a[h];if(c=c[l],!c)return n.status=4,n.message="Function PB."+r.fn+" is not found",void postMessage(JSON.stringify(n))}var u=r.params||[];try{c.call(null,u,e)}catch(s){return n.status=5,n.message="Execution failure: ",n.message+="object"==typeof s&&s.message?s.message:s,void postMessage(JSON.stringify(n))}};