"use strict";PKT_EXT=PKT_EXT||{},PKT_EXT.SAVERECS=function(e){var n=void 0,t=void 0,o=void 0,i=void 0,r=void 0,a=function(e,n){"undefined"!=typeof window.chrome.extension&&(window.chrome.extension.sendMessage?window.chrome.extension.sendMessage(e,n):window.chrome.extension.sendRequest(e,n))},s=function(i){if(n=document.getElementById(i.recContainerName),o=i.recLoaded,!n)throw new Error("Invalid ID Parameters");n.innerHTML=e.TEMPLATES.recommend(),n.classList.add("active"),t=document.getElementById(i.recListName)},c=function(e){return console.log("Loading Recs"),i=Date.now()+1e3,window.PKT_RECS?r?f():u(window.PKT_RECS):void a({action:"getRecommendation",item_id:e},function(e){"success"==e.status?u(e):v()})},u=function(n){return n.data.list.length?(n.data.list=n.data.list.slice(0,3),t.innerHTML=e.TEMPLATES.recommendList(n.data),window.PKT_RECS=n,l(),void f()):d()},d=function(){var n=["Oh snap!  No recs for this page.","We couldn't find anything.","Oh No!  You broke the Interwebs!","You have reached the end of the internet.","You have died of dysentary.","These are not the rec's you are looking for.","Wake up Neo.  The Matrix has you.","Leeeeeroooooooy Jennnnnnnkins!"],o=n[Math.floor(Math.random()*n.length)];t.innerHTML=e.TEMPLATES.recommendNoResults({noresponse:o}),f()},l=function(){$(".pkt_ext_rec_save").click(function(e){e.preventDefault();var n=$(this),t=n.closest(".pkt_ext_recommendation");a({action:"addRecURL",url:t.attr("rec_url"),title:t.attr("rec_title")},function(e){"success"==e.status?n.addClass("saved"):"error"==e.status})})},f=function(){var e=Date.now();e<self.loadThrottle?v():setTimeout(v,i-e),r=!0},v=function(){n.children[0].classList.add("loaded"),o()};return{init:s,loadRecs:c}}(PKT_EXT||{}),PKT_EXT=PKT_EXT||{},PKT_EXT.TAGGING=function(e,n){var t=void 0,o=void 0,i=void 0,r=void 0,a=void 0,s=void 0,c=void 0,u=void 0,d=[],l=[],f=[],v={},g=function(e,n){"undefined"!=typeof window.chrome.extension&&(window.chrome.extension.sendMessage?window.chrome.extension.sendMessage(e,n):window.chrome.extension.sendRequest(e,n))},m=function(e){return e.addEventListener("click",function(n){return a.add(e.textContent)})},T=function(e){return e.removeEventListener("click",function(n){return a.add(e.textContent)})},h=function(){var e=Promise.defer();return g({action:"getSuggestedTags",url:window.location.toString()},function(n){"success"==n.status?e.resolve(n.value.suggestedTags):"error"==n.status&&e.resolve([])}),e.promise},w=function(){var e=Promise.defer();return g({action:"getTags"},function(n){return e.resolve(n)}),e.promise},E=function(){g({action:"addTags",url:window.location.toString(),tags:a.getTagValues(),analytics:{cxt_suggested_available:0,cxt_entered:0,cxt_suggested:0,cxt_removed:0}},function(e){"success"==e.status?x():"error"==e.status&&p()})},_=function(){g({action:"editTags",url:window.location.toString(),tags:a.getTagValues(),analytics:{cxt_suggested_available:0,cxt_entered:0,cxt_suggested:0,cxt_removed:0}},function(e){"success"==e.status?x():"error"==e.status&&p()})},p=function(){setTimeout(function(){return r.classList.remove("saving")},500),s.innerHTML="Tags Save Error"},x=function(){setTimeout(function(){return r.classList.remove("saving")},500),s.innerHTML="Tags Saved"},L=function(e){var n=document.createElement("li");n.innerText=e,m(n),v[e]=n,o.appendChild(n)},y=function(e){if(void 0!==v[e]){var n=v[e];T(n),n.parentNode.removeChild(n),delete v[e]}},P=function(e){d=e.map(function(e){return e.tag}).sort(function(e,n){return n.length-e.length});var n=!0,t=!1,o=void 0;try{for(var i,r=d[Symbol.iterator]();!(n=(i=r.next()).done);n=!0){var a=i.value;L(a)}}catch(s){t=!0,o=s}finally{try{!n&&r["return"]&&r["return"]()}finally{if(t)throw o}}},S=function(e){if(u=e.premiumStatus||!1,t=document.getElementById(e.containerName),o=document.getElementById(e.listContainerName),s=document.querySelector(".pkt_ext_logo_action_copy"),!t||!o)throw new Error("Invalid ID Parameters");C(e.placeholder,t),M(),e.saveButtonName.length&&K(e.saveButtonName)},C=function(e,t){a=new n(t,{placeholder:e,preserveCase:!0,onTagRemove:function(e,n){d.indexOf(n)>=0&&L(n),f=a.getTags().values,_(),r.classList.add("saving")},onBeforeTagAdd:function(e,n){return d.indexOf(n)>=0&&y(n),n},onTagAdd:function(e,n){f=a.getTags().values,E(),r.classList.add("saving")}}),r=a.getInput().parentNode.parentNode,I(t)},M=function(){u&&h().then(function(e){return P(e)})},I=function(e){w().then(function(n){var t=a.getInput();c=new autoComplete({container:e,selector:t,minChars:1,source:function(e,t){e=e.toLowerCase(),l=n.value.tags;var o=l.filter(function(n){return n.charAt(0)===e.charAt(0)}),i=o.filter(function(n){return~n.toLowerCase().indexOf(e)});t(i)},onSelect:function(e,n,t){"mousedown"==e.type&&a.add(n)}})})},K=function(e){i=document.getElementById(e),i.addEventListener("click",function(e){e.preventDefault(),E()})},N=function(){return a.getInput()};return{init:S,getInput:N}}(PKT_EXT||{},window.Taggle),PKT_EXT=PKT_EXT||{},PKT_EXT.ICONS=function(e){var n=!1,t=document.body,o=function(o){if(!n&&t){var i=document.createElement("div");i.innerHTML=e.TEMPLATES.icons(),t.appendChild(i),n=!0}};return{inject:o}}(PKT_EXT||{});