// ( function () {
// 	window.addEventListener( 'tizenhwkey', function( ev ) {
// 		if( ev.keyName === "back" ) {
// 			var page = document.getElementsByClassName( 'ui-page-active' )[0],
// 				pageid = page ? page.id : "";
// 			if( pageid === "main" ) {
// 				try {
// 					tizen.application.getCurrentApplication().exit();
// 				} catch (ignore) {
// 				}
// 			} else {
// 				window.history.back();
// 			}
// 		}
// 	} );
// } () );


var bluetoothSwitchAppControl = new tizen.ApplicationControl("http://tizen.org/appcontrol/operation/edit", null, "application/x-bluetooth-on-off");
var adapter = tizen.bluetooth.getDefaultAdapter();


function launchSuccess()
{
   console.log("Bluetooth Settings application is successfully launched.");
}
function launchError(error)
{
   alert("An error occurred: " + error.name + ". Please enable Bluetooth through the Settings application.");
}

var serviceReply =
{
   /* Called when the launched application reports success */
   onsuccess: function(data)
   {
      if (adapter.powered)
      {
         console.log("Bluetooth is successfully turned on.");
      }
      else
      {
		  console.log("Try to launch the Bluetooth Settings application.");
   			tizen.application.launchAppControl(bluetoothSwitchAppControl, null, launchSuccess, launchError, serviceReply);
      }
   },
   /* Called when launched application reports failure */
   onfailure: function()
   {
      alert("Bluetooth Settings application reported failure.");
   }
};
var bluetoothVisibilityAppControl = new tizen.ApplicationControl("http://tizen.org/appcontrol/operation/edit", null, "application/x-bluetooth-visibility");
function launchVisibilityError(error)
{
   alert("An error occurred: " + error.name + ". Please enable Bluetooth visibility through the Settings application.");
}
var serviceVisibilityReply =
{
   /* Called when the launched application reports success */
   onsuccess: function(data)
   {
      console.log("Bluetooth is " + (adapter.visible ? "now discoverable." : "still not visible."));
   },
   /* Called when launched application reports failure */
   onfailure: function()
   {
      alert("Bluetooth Settings application reported failure.");
   }
};
tizen.application.launchAppControl(bluetoothVisibilityAppControl, null, null, launchVisibilityError, serviceVisibilityReply);
